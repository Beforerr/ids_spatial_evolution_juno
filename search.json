[
  {
    "objectID": "presentations/AGU23_poster.html#main-findings",
    "href": "presentations/AGU23_poster.html#main-findings",
    "title": "Solar wind discontinuities spatial evolution and energetic ion scattering",
    "section": "Main findings",
    "text": "Main findings\n\nSolar wind discontinuities evolve in space with occurrence rate decreasing, thickness increasing and current density decreasing with distance from the Sun. And they are probably generated locally beyond 1 AU.\nBackground sheared magnetic field plays an important role in determining the efficiency of ion pitch angle scattering, and characterize three ion populations: transient, trapped, regular.",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar wind discontinuities spatial evolution and energetic ion scattering"
    ]
  },
  {
    "objectID": "presentations/AGU23_poster.html#introduction-motivation",
    "href": "presentations/AGU23_poster.html#introduction-motivation",
    "title": "Solar wind discontinuities spatial evolution and energetic ion scattering",
    "section": "Introduction & Motivation",
    "text": "Introduction & Motivation\n‘Discontinuities’ are discontinuous spatial changes in plasma parameters/characteristics and magnetic fields (colburn1966?).\n\n\n(söding2001?) studied the radial distribution of discontinuities in the solar wind.\n\n\nJoint observations of JUNO & ARTEMIS & Other missions really provides a unique opportunity!!!",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar wind discontinuities spatial evolution and energetic ion scattering"
    ]
  },
  {
    "objectID": "presentations/AGU23_poster.html#method",
    "href": "presentations/AGU23_poster.html#method",
    "title": "Solar wind discontinuities spatial evolution and energetic ion scattering",
    "section": "Method",
    "text": "Method\n\nWe use (liu2022a?) method to identify IDs, which has better compatibility for the IDs with minor field changes.\nThen the minimum variance analysis is applied to each ID event to obtain the boundary normal (LMN) coordinate and extract IDs’ features.\nHamiltonian model is applied for investigation of ion dynamics in the solar wind discontinuity configuration.\n\nThe most generalized form of dimensionless hamiltonian equation for ions in force-free rotational magnetic discontinuities configuration is\n\\[\nH=\\frac{1}{2}\\left(\\frac{1}{6} \\alpha^2 c_2 z^3-c_1 z+p_x\\right)^2+\\frac{p_z^2}{2}+\\frac{1}{2}\\left(\\kappa x-\\frac{\\alpha z^2}{2}\\right)^2\n\\]\nWith \\(B_l^2+B_m^2=\\text { const }\\), we have\n\\[\nH=\\frac{1}{2}\\left(\\frac{\\alpha^2 z^3}{6 \\sqrt{\\kappa_m^2+1}}-z \\sqrt{\\kappa_m^2+1}+p_x\\right)^2+\\frac{p_z^2}{2}+\\frac{1}{2}\\left(\\kappa_n x-\\frac{\\alpha z^2}{2}\\right)^2\n\\]\nThe system has three parameters\n\\[\n\\kappa_n=\\frac{B_n}{B_{l, \\max }}\n\\quad\n\\kappa_m=\\frac{B_{m, 0}}{B_{l, \\max }}\n\\quad\n\\alpha=\\frac{l_0}{L}=\\frac{\\text { gyro radius }}{\\text { system length }}\n\\]",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar wind discontinuities spatial evolution and energetic ion scattering"
    ]
  },
  {
    "objectID": "presentations/AGU23_poster.html#results",
    "href": "presentations/AGU23_poster.html#results",
    "title": "Solar wind discontinuities spatial evolution and energetic ion scattering",
    "section": "Results",
    "text": "Results\n\nNormalized occurrence rate of IDs drops with the radial distance from the Sun, following 1/r law.\n\n\n\n\n\n\nHigh energy particle has higher chance to cross uncertainty curve\nHigh shear magnetic field will make separatrix vanishes and the geometrical jumps of the quasiadiabatic invariant disappear",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar wind discontinuities spatial evolution and energetic ion scattering"
    ]
  },
  {
    "objectID": "article.html",
    "href": "article.html",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "",
    "text": "What I did: I studied the solar wind discontinuities in the outer heliosphere using data from the Juno spacecraft during its cruise phase. I identified and analyzed the properties of the discontinuities at different radial distances from the Sun. I differentiated the temporal effect (correlated with solar activity) and spatial variations (correlated with radial distance).\nWhat I found: The normalized occurrence rate of IDs drops with the radial distance from the Sun, following a \\(1/r\\) law. The thickness of IDs increases with the radial distance from the Sun, but after normalization to the ion inertial length, the thickness of IDs decreases. The current intensity of IDs decreases with the radial distance from the Sun, but after normalization to the Alfven current, the current intensity of IDs increases.\nWhat it means: The results of this study provide a better understanding of the solar wind discontinuities in the outer heliosphere and their spatial evolution. This information is important for understanding the dynamics of the solar wind and testing the local generation mechanism of discontinuities.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#dataset",
    "href": "article.html#dataset",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Dataset",
    "text": "Dataset\nIn this study we use datasets of four missions measuring solar wind magnetic field and plasma. Synergistic observations of these missions should advance our understanding of the solar wind discontinuities, their radial distribution and evolution (Velli et al. 2020).\n\nThe solar wind plasma state, as evidenced by the sunspot number (referenced in Figure 1), plays a crucial role in understanding the dynamics of discontinuities. During the initial phase of the JUNO mission, the sunspot number reached its peak, indicating a period of heightened solar activity. However, by the end of the mission’s cruise phase, there was a significant decline in solar activity. This variation underscores the importance of calibrating the discontinuity properties in relation to solar activity levels to account for temporal fluctuations.\nFurthermore, an analysis of Figure 1 reveals the significance of the heliographic longitudinal difference between the Juno mission and Near-Earth missions (such as Wind and ARTEMIS) as well as STEREO-A missions. This longitudinal discrepancy ensures comprehensive coverage of the plasma en route to Juno. Specifically, when there is a substantial longitudinal difference between Juno and Earth, the difference between Juno and STEREO-A tends to be minimal, and vice versa. This relationship facilitates an extensive observation network for the plasma traveling towards Juno.\nThe time resolution of the magnetic field and plasma data for Juno, Wind, ARTEMIS, STEREO is summarized in the table below.\n\n\n\n\n\nTable 1: Missions info\n\n\n\n\n\n\nMission\n\\(\\delta t_B\\)\n\\(\\delta t_{plasma}\\)\nRadial coverage\nLaunch date\nwebsite\n\n\n\n\nJuno\n1 Hz\n\n1 - 5.5 AU\n2011-08-05 00:00:00\n[‘NASA’]\n\n\nARTEMIS\n5 Hz, …\n\n\n2007-02-17 00:00:00\n\n\n\nSTEREO-A\n8 Hz\n\n\n2006-10-26 00:00:00\n\n\n\nWIND\n11 Hz\n\n\n1994-11-01 00:00:00\n[‘NASA’]\n\n\nSolar Orbiter\n\n\n0.28 - 0.9 AU\n2020-02-10 00:00:00\n[‘ESA’]\n\n\nParker Solar Probe\n\n\n0.05 - 1 AU\n2018-08-12 00:00:00\n[‘NASA’]\n\n\n\n\n\n\n\n\nSource: Notes",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#model",
    "href": "article.html#model",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Model",
    "text": "Model\nJune measurements do not include plasma characteristics, and to estimate discontinuity spatial scale (thicknesses) we will use solar wind speed obtained from the model of solar wind propagation. The hourly solar wind model data from the Two-Dimensional Outer Heliosphere Solar Wind Modeling (MSWIM2D) (Keebler et al. 2022) will be employed to determine the ion bulk velocity \\(v\\) and plasma density \\(n\\) at the location of the Juno mission. Utilizing the BATSRUS MHD solver, this model is capable of simulating the propagation of the solar wind from 1 to 75 astronomical units (AU) in the ecliptic plane, effectively encompassing the region of interest for our study. Figure 2 shows comparison of magnetic field magnitudes obtained from MSWIM2D and measured by Juno.\nThe model time resolution is hourly. After averaging Juno data to the same time resolution, we see that the model data is consistent with the Juno magnetic field data.\n\n\n\n\n\n\nFigure 2: a, Magnetic field magnitude from MSWIM2D and Juno. b-c, Plasma speed and density from MSWIM2D model. d, Juno radial distance from the Sun.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#methods",
    "href": "article.html#methods",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Methods",
    "text": "Methods\nWe use Liu’s (Liu, Fu, Cao, Wang, et al. 2022) method to identify discontinuities in the solar wind. This method has better compatibility for the discontinuities with minor field changes, and is more robust to the situation encountered in the outer heliosphere. For each sampling instant \\(t\\), we define three intervals: the pre-interval \\([-1,-1/2]\\cdot T+t\\), the middle interval \\([-1/,1/2]\\cdot T+t\\), and the post-interval \\([1/2,1]\\cdot T+t\\), in which \\(T\\) are time lags. Let time series of the magnetic field data in these three intervals are labeled \\({\\mathbf B}_-\\), \\({\\mathbf B}_0\\), \\({\\mathbf B}_+\\), respectively. Then for an discontinuity, the following three conditions should be satisfied: (1) \\(\\sigma({\\mathbf B}_0) &gt; 2\\max\\left(\\sigma({\\mathbf B}_-), \\sigma({\\mathbf B}_+)\\right)\\), (2) \\(\\sigma\\left({\\mathbf B}_-+{\\mathbf B}_+\\right)&gt;\\sigma({\\mathbf B}_-)+\\sigma({\\mathbf B}_+)\\), and (3) \\(|\\Delta {\\mathbf B}|&gt;|{\\mathbf B}_{bg}|/10\\), in which \\(\\sigma\\) and \\({\\mathbf B}_{bg}\\) represent the standard deviation and the background magnetic field magnitude, and \\(\\Delta {\\mathbf B}={\\mathbf B}(t+T/2)-{\\mathbf B}(t-T/2)\\). The first two conditions guarantee that the field changes of the discontinuity identified are large enough to be distinguished from the stochastic fluctuations or Alfven waves on magnetic fields, while the third is a supplementary condition to reduce the uncertainty of recognition.\nThen for each discontinuity identified, we calculate the distance matrix of the time series sequence (distance between each pair of magnetic field vectors) to determine the leading edge and trailing edge of the discontinuity. After that, we use the minimum or maximum variance analysis (MVA) analysis (Bengt U. Ö. Sonnerup and Scheible 1998; B. U. Ö. Sonnerup and Cahill Jr. 1967) to get the main (most varying) magnetic field component, \\(B_l\\), and medium variation component, \\(B_m\\). The maxium variance direction is then fitted by a step-like functions to extract the parameters to properly describe the discontinuity (we used logistic function here). Then we combine the magnetic field data and plasma data to obtain the thickness and the current density of the discontinuity.\n\\[\nB(t; A, \\mu, \\sigma, {\\mathrm{form=logistic}}) = A \\left[1 - \\frac{1}{1 + e^{\\alpha}} \\right]\n\\]\nwhere \\(\\alpha = (t - \\mu)/{\\sigma}\\).\nFigure 3 shows several examples of solar wind discontinuities detected by different spacecraft.\n\n\n\n\n\n\n\nFigure 3: Examples of IDs from ARTEMIS, STEREO, and Wind",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#occurrence-rate",
    "href": "article.html#occurrence-rate",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Occurrence rate",
    "text": "Occurrence rate\nThe occurrence rate of IDs is investigated with regards of the radial distance from the Sun.\nNote the quantity of IDs per day is corrected with respect to data gap and the time the mission spent in the pristine solar wind.\nARTEMIS spacecrafts will only be exposed in the solar wind for a relative short time during its orbits around the Moon and the Moon would be in the magnetosphere for a long time as it orbits the earth. (The data is obtained from OMNIWEB, link: omniweb.gsfc.nasa.gov/ftpbrowser/themis_b_sw.txt)\nThe rate of occurrence depends linearly on the solar wind velocity (Söding et al. 2001), however the plasma velocity data in Juno mission is not available during its cruise phase. Therefore, we do not normalize the occurrence rate with respect to the solar wind speed. This influence of the solar wind speed on the occurrence rate might be mitigated by the fact all the spacecrafts are in the ecliptic plane, and the solar wind speed is not expected to change significantly with the radial distance from the Sun beyond \\(1\\) AU. So the decrease of the occurrence rate with the radial distance from the Sun is expected to be a real effect of the radial distance from the Sun.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 4: The number of discontinuities measured by Juno per day coincides with the discontinuity number measured by STEREO, WIND, and ARTEMIS, when Juno is around \\(1\\) AU. This number (occurrence rate) decreases with distance (with time after \\(\\sim 2013\\)), as Juno moves from \\(1\\) AU to \\(5\\) AU. We will use the similar comparison for discontinuity characteristics and occurrence rate derived for PSP and Juno. The radial distance of Juno for 2011-2016 is shown in Figure 2.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#thickness",
    "href": "article.html#thickness",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Thickness",
    "text": "Thickness\nThe thickness \\(d\\) of a discontinuity is determined by\n\\[\nd = (v \\cdot n) \\Delta T\n\\]\nwith \\(v = v_{sw} - v_{s/c} + U\\) , where \\(\\Delta T\\) is the transition time (a factor of the \\(sigma\\) used in fitting) , \\(v_{sw}\\) is the solar wind velocity. The velocity of the spacecraft \\(v_{s/c}\\) and the propagation speed of the discontinuities \\(U\\) are negligible in our case.\nIn Vasko et al. (2022) paper, CS thickness is estimated by the formula \\(d = \\frac{\\Delta B_l}{2 \\mu_0 &lt; J_m&gt; }\\). Because of Equation 1, \\(d = \\frac{\\Delta B_l}{2 \\mu_0 &lt; J_m&gt; } = \\frac{\\Delta B_l V_n }{2 &lt;\\frac{d B_m}{ d t} &gt;}\\)\nThe transition time \\(\\Delta T\\) is determined in one second resolution data for all our missions to reduce the system error. (Note that highest time resolution of the data is not needed for the transition time determination by fitting method, see discussion in the appendix).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5: a, Thickness of IDs as a function of the radial distance from the Sun. b, Thickness of IDs normalized to the ion inertial length as a function of the radial distance from the Sun.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#current-density",
    "href": "article.html#current-density",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Current density",
    "text": "Current density\nThe peak current density \\(J_m\\) of a discontinuity is determined by\n\\[\nJ_m = - \\frac{1}{\\mu_0 V_n} \\frac{d B_m}{d t},\n\\tag{1}\\]\nwhere \\(\\mu_0\\) is the vacuum permeability and \\(V_n\\) is the normal component of the proton flow velocity.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 6: a, Current density of IDs as a function of the radial distance from the Sun. b, Current density of IDs normalized to the Alfven current as a function of the radial distance from the Sun.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#occurrence-rate-1",
    "href": "article.html#occurrence-rate-1",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Occurrence rate",
    "text": "Occurrence rate\nThe normalized occurrence rate of IDs drops with the radial distance from the Sun, following \\(1/r\\) law.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#thickness-1",
    "href": "article.html#thickness-1",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Thickness",
    "text": "Thickness\nThe thickness of IDs increases with the radial distance from the Sun, but after normalization to ion inertial length, the thickness of IDs decreases.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "article.html#current-density-1",
    "href": "article.html#current-density-1",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Current density",
    "text": "Current density\nThe current density of IDs decrease with the radial distance from the Sun, but after normalization to the Alfven current , the current density of IDs increases.",
    "crumbs": [
      "Home",
      "Solar wind discontinuities spatial evolution in the outer heliosphere"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "",
    "text": "manuscript please see here\nAGU poster here"
  },
  {
    "objectID": "index.html#publications",
    "href": "index.html#publications",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "",
    "text": "manuscript please see here\nAGU poster here"
  },
  {
    "objectID": "index.html#updates",
    "href": "index.html#updates",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Updates",
    "text": "Updates\n\n02/27/2024\n\n\n\n\n\n\n\n\n\nEvolution of plamsa property using fitting method\n\n\n\n\n\n\n\nEvolution of plamsa property using derivative method\n\n\n\n\n\n\nFigure 1: From top to bottom is Juno observation in 1,2,3,4,5 AU\n\n\n\n\n\n\n02/26/2024\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\nSource: 06_corr_julia.ipynb\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3\n\n\n\n\nSource: 06_corr_julia.ipynb\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 4\n\n\n\n\nSource: 06_corr_julia.ipynb\n\n\n\n\n\n\n\n\nFigure 5\n\n\n\n\nSource: 06_corr_julia.ipynb\n\n\n\n\n02/25/2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 6\n\n\n\n\n\nSource: Superposed epoch analysis\n\n\n\n\n\n\n\n\n\nFigure 7\n\n\n\n\n\nSource: Superposed epoch analysis\n\n\n\n\n02/22/2024\n\n\n\n\n\n\n\n\n\nFirst Year\n\n\n\n\n\n\n\nLast Year\n\n\n\n\n\n\n\n02/20/2024\n\n\n02/19/2024\n\n\n\n\n\n\n\n\n\nFigure 8\n\n\n\n\n\nSource: SWD Properties\n\n\n02/18/2024\n\n\nThickness\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCurrent Density\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n02/17/2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNew Fit Width\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNew\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOld\n\n\n\n\n\n\n\n\n\n\n\n\nWind\n\n\n\n\n\n\n\nJuno\n\n\n\n\n\n\n\nDerivative method\n\n\n\n\n\n\n\nFit method"
  },
  {
    "objectID": "index.html#related-works",
    "href": "index.html#related-works",
    "title": "Solar wind discontinuities spatial evolution in the outer heliosphere",
    "section": "Related works",
    "text": "Related works\n\nSöding et al. (2001) studied the radial distribution of discontinuities in the solar wind between 0.3 and 19 AU during solar activity minimum.\nLiu et al. (2021) studied the spatial evolution of the discontinuities from 0.13-0.9 AU, using measurements from the Parker Solar Probe.\n\nTypical rate of occurrence is about 50 per day at 1AU\n\n\n\n\n\n\n\n\nDiscontinuities between 0.3 and 19 AU\n\n\n\n\n\n\n\nDiscontinuities between 0.13–0.9 AU\n\n\n\n\n\n\nFigure 9: Spatial distribution of the discontinuities\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\n\n\n\n\n\n\n\n\nCurrent sheets in the heliosheath: Voyager 1, 2009\n\n\n\n\n\n\n\nA rotational discontinuity (RD) detected at 0.126 AU\n\n\n\n\n\n\nFigure 10: Discontinuities examples across the heliosphere\n\n\n\n\n\n\n\n\n\nEvolution of plamsa property using fitting method\nEvolution of plamsa property using derivative method\nFigure 6: \nFigure 7: \nFirst Year\nLast Year\nFigure 8: \nWind\nJuno\nDerivative method\nFit method\nDiscontinuities between 0.3 and 19 AU\nDiscontinuities between 0.13–0.9 AU\nCurrent sheets in the heliosheath: Voyager 1, 2009\nA rotational discontinuity (RD) detected at 0.126 AU"
  },
  {
    "objectID": "notebooks/missions/index.html",
    "href": "notebooks/missions/index.html",
    "title": "Missions",
    "section": "",
    "text": "This module includes helpful functions for working with mission (magnetic field and plasma) data. We currently support the following missions:\n\nParker Solar Probe\nJuno\nWind\nTHEMIS/ARTEMIS\nSTEREO\n\nNote: speasy and pyspedas are not suitable for processing large datasets, although they are useful for downloading and processing small datasets.\n\nspeasy cache file and data are not persistent\npyspedas loads the entire dataset into memory",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions"
    ]
  },
  {
    "objectID": "notebooks/missions/wind/index.html",
    "href": "notebooks/missions/wind/index.html",
    "title": "Wind",
    "section": "",
    "text": "See following notebooks for details:\nReferences:\nNotes:",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "Wind"
    ]
  },
  {
    "objectID": "notebooks/missions/wind/index.html#setup",
    "href": "notebooks/missions/wind/index.html#setup",
    "title": "Wind",
    "section": "Setup",
    "text": "Setup\n\nfrom kedro.pipeline.modular_pipeline import pipeline\n\nfrom discontinuitypy import PARAMS\nfrom discontinuitypy.pipelines.wind.mag import create_pipeline as create_mag_data_pipeline\nfrom discontinuitypy.pipelines.default.mission import create_combined_data_pipeline\n\nfrom typing import Optional\n\n\ndef create_pipeline(\n    sat_id=\"Wind\",\n    params: Optional[dict] = None,\n):\n    if params is None:\n        params = PARAMS\n    ts_state = params[sat_id][\"STATE\"].get(\"time_resolution\", 0)\n    ts_state_str = f\"ts_{ts_state}s\"\n    \n    input_combined_data = {\n        f\"{sat_id}.STATE.primary_data_{ts_state_str}\": f\"OMNI.LowRes.primary_data_{ts_state_str}\"\n    }\n\n    node_combined_data = pipeline(\n        create_combined_data_pipeline(sat_id),\n        inputs=input_combined_data,\n    )\n    \n    return (\n        create_mag_data_pipeline(sat_id)\n        + node_combined_data\n    )",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "Wind"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html",
    "href": "notebooks/missions/juno/index.html",
    "title": "IDs from Juno",
    "section": "",
    "text": "See following notebooks for details:",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#background",
    "href": "notebooks/missions/juno/index.html#background",
    "title": "IDs from Juno",
    "section": "Background",
    "text": "Background\nSpacecraft-Solar equatorial\nhttps://pds-ppi.igpp.ucla.edu/data/JNO-SS-3-FGM-CAL-V1.0/INDEX/INDEX.TAB\n------------------------------------------------------------------------------\nJuno Mission Phases                                                           \n------------------------------------------------------------------------------\nStart       Mission                                                           \nDate        Phase                                                             \n==============================================================================\n2011-08-05  Launch                                                            \n2011-08-08  Inner Cruise 1                                                    \n2011-10-10  Inner Cruise 2                                                    \n2013-05-28  Inner Cruise 3                                                    \n2013-11-05  Quiet Cruise                                                      \n2016-01-05  Jupiter Approach                                                  \n2016-06-30  Jupiter Orbital Insertion                                         \n2016-07-05  Capture Orbit                                                     \n2016-10-19  Period Reduction Maneuver                                         \n2016-10-20  Orbits 1-2                                                        \n2016-11-09  Science Orbits                                                    \n2017-10-11  Deorbit\n\nCoordinate System of Data\n\nSE (Solar Equatorial)\n\nCode: se\nResampling options:\n\nNumber of seconds (1 or 60): se_rN[N]s\nResampled 1 hour: se_r1h\n\n\nPC (Planetocentric)\n\nCode: pc\nResampling options:\n\nNumber of seconds (1 or 60): pc_rN[N]s\n\n\nSS (Sun-State)\n\nCode: ss\nResampling options:\n\nNumber of seconds (1 or 60): ss_rN[N]s\n\n\nPL (Payload)\n\nCode: pl\nResampling options:\n\nNumber of seconds (1 or 60): pl_rN[N]s\n\n\n\nThere are three principal coordinate systems used to represent the data in this archive.\n\nThe SE coordinate system is a Spacecraft- Solar equatorial system and it will be used for cruise data only.\nThe sun-state (ss) and planetocentric (pc) will be used for Earth Fly By (EFB) and Jupiter orbital data.\nCartesian representations are used for all three coordinate systems. These coordinate systems are specified relative to a “target body” which may be any solar system object (but for this orbital operations will Jupiter). In what follows we will reference Jupiter as the target body, but, for example, if observations near a satellite (such as Io) are desired in Io-centric coordinates, the satellite Io may be specified as the target body.\n\nThe SE coordinate system is defined using the sun-spacecraft vector as the primary reference vector; sun’s rotation axis as the secondary reference vector (z). The x axis lies along the sun-spacecraft vector, the z axis is in the plane defined by the Sun’s rotation axis and the spacecraft-sun vector. The y axis completes the system.\nThe ss coordinate system is defined using the instantaneous Jupiter-Sun vector as the primary reference vector (x direction). The X-axis lies along this vector and is taken to be positive toward the Sun. The Jupiter orbital velocity vector is the second vector used to define the coordinate system; the y axis lies in the plane determined by the Jupiter-Sun vector and the velocity vector and is orthogonal to the x axis (very nearly the negative of the velocity vector). The vector cross product of x and y yields a vector z parallel to the northward (upward) normal of the orbit plane of Jupiter. This system is sometimes called a sun-state (ss) coordinate system since its principal vectors are the Sun vector and the Jupiter state vector.",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#setup",
    "href": "notebooks/missions/juno/index.html#setup",
    "title": "IDs from Juno",
    "section": "Setup",
    "text": "Setup\n::: {#cell-2 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’}\n%load_ext autoreload\n%autoreload 2\n:::\n\nfrom discontinuitypy.datasets import IDsDataset\nimport polars as pl\nfrom fastcore.utils import walk\n\nfrom loguru import logger\n\nfrom datetime import timedelta\n\n\nmission = \"JNO\"\nts = timedelta(seconds=1)\ntau = timedelta(seconds=60)\n\n\ndata_dir = '../../../data'\ndir_path = f'{data_dir}/03_primary/JNO_MAG_ts_{ts.seconds}s'\njuno_state_path = f'{data_dir}/03_primary/JNO_STATE_ts_3600s.parquet'\nvec_cols = ['v_x', 'v_y', 'v_z']\n\nformat = 'arrow'\nfname = f'events.{mission}.ts_{ts.total_seconds():.2f}s_tau_{tau.seconds}s.{format}'\noutput_path = f'{data_dir}/05_reporting/{fname}'\n\n\nplasma_data = pl.scan_parquet(juno_state_path).sort('time')\nlogger.info(plasma_data.columns)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#check-the-discontinuity-in-the-last-year-of-juno-cruise-phase",
    "href": "notebooks/missions/juno/index.html#check-the-discontinuity-in-the-last-year-of-juno-cruise-phase",
    "title": "IDs from Juno",
    "section": "Check the discontinuity in the last year of Juno cruise phase",
    "text": "Check the discontinuity in the last year of Juno cruise phase\n\nFirst year\n\nmag_path = sorted(list(walk(dir_path)))[0]\ntau = timedelta(seconds=60)\njuno_mag_data = pl.scan_parquet(mag_path).drop('X', 'Y', 'Z').sort('time')\n\nids_ds = (\n    IDsDataset(\n        mag_data=juno_mag_data,\n        plasma_data=plasma_data,\n        tau=tau,\n        ts=ts,\n        vec_cols=vec_cols,\n        density_col=\"plasma_density\",\n        speed_col=\"plasma_speed\",\n        temperature_col=\"plasma_temperature\",\n    )\n    .find_events(return_best_fit=True)\n    .update_candidates_with_plasma_data()\n)\n\n17-Feb-24 15:09:08: DeprecationWarning: `pl.count()` is deprecated. Please use `pl.len()` instead.\n\n17-Feb-24 15:09:08: DeprecationWarning: `map_alias` is deprecated. It has been moved to `name.map`.\n\n17-Feb-24 15:09:08: DeprecationWarning: `map_alias` is deprecated. It has been moved to `name.map`.\n\n17-Feb-24 15:09:10: UserWarning: Distributing &lt;class 'pandas.core.frame.DataFrame'&gt; object. This may take some time.\n\n17-Feb-24 15:09:39: DeprecationWarning: np.find_common_type is deprecated.  Please use `np.result_type` or `np.promote_types`.\nSee https://numpy.org/devdocs/release/1.25.0-notes.html and the docs for more information.  (Deprecated NumPy 1.25)\n\n17-Feb-24 15:09:39: DeprecationWarning: `nanoseconds` is deprecated. It has been renamed to `total_nanoseconds`.\n\n17-Feb-24 15:09:39: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:09:39: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:09:39: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:09:39: DeprecationWarning: `suffix` is deprecated. It has been moved to `name.suffix`.\n\n17-Feb-24 15:09:39: DeprecationWarning: `suffix` is deprecated. It has been moved to `name.suffix`.\n\n17-Feb-24 15:09:39: DeprecationWarning: `suffix` is deprecated. It has been moved to `name.suffix`.\n\n17-Feb-24 15:09:39: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:09:39: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n\n\n\n\n\n\n\n\nids_ds.plot_candidates(num=20, plot_fit_data=True, predicates=(pl.col('fit.stat.rsquared') &gt; 0.95))\n\n2024-02-17 15:09:51.206 | INFO     | discontinuitypy.datasets:plot_candidates:215 - Candidates indices: [10436  8841 13616  9794   120 11659  3392  3969  8190  2869 13639 11070\n  4853 13902  8554  9970 11430  8080   723  8650]\n\n\n\n\n[(&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.06, $R^2$: 0.96, $\\\\chi^2$: 0.13'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.17, $R^2$: 0.98, $\\\\chi^2$: 0.05'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.98, $R^2$: 0.99, $\\\\chi^2$: 0.15'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.73, $R^2$: 0.97, $\\\\chi^2$: 1.86'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.23, $R^2$: 0.99, $\\\\chi^2$: 0.06'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.02, $R^2$: 0.99, $\\\\chi^2$: 0.01'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.15, $R^2$: 0.97, $\\\\chi^2$: 1.10'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.29, $R^2$: 0.95, $\\\\chi^2$: 1.15'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.30, $R^2$: 0.97, $\\\\chi^2$: 0.82'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 1.49, $R^2$: 0.98, $\\\\chi^2$: 1.03'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.28, $R^2$: 0.99, $\\\\chi^2$: 0.02'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.13, $R^2$: 0.99, $\\\\chi^2$: 0.01'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.20, $R^2$: 0.98, $\\\\chi^2$: 0.03'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.04, $R^2$: 0.95, $\\\\chi^2$: 0.24'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.22, $R^2$: 0.96, $\\\\chi^2$: 0.06'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.03, $R^2$: 0.95, $\\\\chi^2$: 0.33'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.17, $R^2$: 0.96, $\\\\chi^2$: 11.09'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.21, $R^2$: 0.99, $\\\\chi^2$: 0.01'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.23, $R^2$: 0.98, $\\\\chi^2$: 0.04'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.11, $R^2$: 0.98, $\\\\chi^2$: 0.06'}, ylabel='$B$\\n[nT LMN]'&gt;)]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLast year\n\n# mag_path = sorted(list(walk(dir_path)))[-1]\ntau = timedelta(seconds=300)\nmag_path = sorted(list(walk(dir_path)))[-1]\njuno_mag_data = pl.scan_parquet(mag_path).drop('X', 'Y', 'Z').sort('time')\n\nids_ds = (\n    IDsDataset(\n        mag_data=juno_mag_data,\n        plasma_data=plasma_data,\n        tau=tau,\n        ts=ts,\n        vec_cols=vec_cols,\n        density_col=\"plasma_density\",\n        speed_col=\"plasma_speed\",\n        temperature_col=\"plasma_temperature\",\n    )\n    .find_events(return_best_fit=True)\n    .update_candidates_with_plasma_data()\n)\n\n17-Feb-24 15:07:29: DeprecationWarning: `pl.count()` is deprecated. Please use `pl.len()` instead.\n\n17-Feb-24 15:07:29: DeprecationWarning: `map_alias` is deprecated. It has been moved to `name.map`.\n\n17-Feb-24 15:07:29: DeprecationWarning: `map_alias` is deprecated. It has been moved to `name.map`.\n\n17-Feb-24 15:07:31: UserWarning: Distributing &lt;class 'pandas.core.frame.DataFrame'&gt; object. This may take some time.\n\n17-Feb-24 15:07:36: DeprecationWarning: `nanoseconds` is deprecated. It has been renamed to `total_nanoseconds`.\n\n17-Feb-24 15:07:36: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:07:36: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:07:36: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:07:36: DeprecationWarning: `suffix` is deprecated. It has been moved to `name.suffix`.\n\n17-Feb-24 15:07:36: DeprecationWarning: `suffix` is deprecated. It has been moved to `name.suffix`.\n\n17-Feb-24 15:07:36: DeprecationWarning: `suffix` is deprecated. It has been moved to `name.suffix`.\n\n17-Feb-24 15:07:36: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n17-Feb-24 15:07:36: PendingDeprecationWarning: The `dims` argument has been renamed to `dim`, and will be removed in the future. This renaming is taking place throughout xarray over the next few releases.\n\n\n\n\n\n\n\n\n\nids_ds.plot_candidates(num=20, plot_fit_data=True, predicates=(pl.col('fit.stat.rsquared') &gt; 0.95))\n\n2024-02-17 15:07:37.771 | INFO     | discontinuitypy.datasets:plot_candidates:215 - Candidates indices: [1104  694 1238 1324  313  331 1240  790  689 1233   34  670  674 1045\n 1439  411 1043  793    5  436]\n\n\n\n\n[(&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.02, $R^2$: 0.98, $\\\\chi^2$: 2.03'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.17, $R^2$: 0.98, $\\\\chi^2$: 0.21'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.07, $R^2$: 0.98, $\\\\chi^2$: 0.33'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.02, $R^2$: 0.97, $\\\\chi^2$: 0.32'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.11, $R^2$: 0.95, $\\\\chi^2$: 0.22'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.02, $R^2$: 0.96, $\\\\chi^2$: 0.81'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.07, $R^2$: 0.98, $\\\\chi^2$: 0.33'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.02, $R^2$: 0.98, $\\\\chi^2$: 0.12'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.22, $R^2$: 0.97, $\\\\chi^2$: 0.09'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.40, $R^2$: 0.98, $\\\\chi^2$: 0.30'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.04, $R^2$: 0.96, $\\\\chi^2$: 0.89'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.02, $R^2$: 0.97, $\\\\chi^2$: 1.42'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.25, $R^2$: 0.98, $\\\\chi^2$: 0.08'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.03, $R^2$: 0.98, $\\\\chi^2$: 0.14'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.15, $R^2$: 1.00, $\\\\chi^2$: 5.87'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.26, $R^2$: 0.99, $\\\\chi^2$: 0.37'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.03, $R^2$: 0.98, $\\\\chi^2$: 0.14'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: -0.06, $R^2$: 0.97, $\\\\chi^2$: 0.67'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.02, $R^2$: 0.97, $\\\\chi^2$: 0.47'}, ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  &lt;Axes: title={'center': '\\n#Fit# $\\\\max dB/dt$: 0.03, $R^2$: 0.95, $\\\\chi^2$: 0.73'}, ylabel='$B$\\n[nT LMN]'&gt;)]",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#processing-the-whole-data",
    "href": "notebooks/missions/juno/index.html#processing-the-whole-data",
    "title": "IDs from Juno",
    "section": "Processing the whole data",
    "text": "Processing the whole data",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#obsolete",
    "href": "notebooks/missions/juno/index.html#obsolete",
    "title": "IDs from Juno",
    "section": "Obsolete",
    "text": "Obsolete\n\nEstimate\n1 day of data resampled by 1 sec is about 12 MB.\nSo 1 year of data is about 4 GB, and 6 years of JUNO Cruise data is about 24 GB.\nDownloading rate is about 250 KB/s, so it will take about 3 days to download all the data.\n\nnum_of_files = 6*365\njno_file_size = 12e3\nthm_file_size = 40e3\nfiles_size = jno_file_size + thm_file_size\ndownloading_rate = 250\nprocessing_rate = 1/60\n\ntime_to_download = num_of_files * files_size / downloading_rate / 60 / 60\nspace_required = num_of_files * files_size / 1e6\ntime_to_process = num_of_files / processing_rate / 60 / 60\n\nprint(f\"Time to download: {time_to_download:.2f} hours\")\nprint(f\"Disk space required: {space_required:.2f} GB\")\nprint(f\"Time to process: {time_to_process:.2f} hours\")",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/04_properties.html",
    "href": "notebooks/04_properties.html",
    "title": "SWD Properties",
    "section": "",
    "text": "::: {#cell-2 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=36}\nimport polars as pl\nfrom loguru import logger\n:::\n::: {#cell-3 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=37}\n%load_ext autoreload\n%autoreload 2\n\nThe autoreload extension is already loaded. To reload it, use:\n  %reload_ext autoreload\n\n:::\nConnect python with R kernel\n\nfrom beforerr.r import py2rpy_polars\nimport rpy2.robjects as robjects\n\n%load_ext rpy2.ipython\n\nr = robjects.r\nr.source('utils.R')\n\nconv_pl = py2rpy_polars()\n\nThe rpy2.ipython extension is already loaded. To reload it, use:\n  %reload_ext rpy2.ipython",
    "crumbs": [
      "Home",
      "Notebooks",
      "SWD Properties"
    ]
  },
  {
    "objectID": "notebooks/04_properties.html#setup",
    "href": "notebooks/04_properties.html#setup",
    "title": "SWD Properties",
    "section": "",
    "text": "::: {#cell-2 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=36}\nimport polars as pl\nfrom loguru import logger\n:::\n::: {#cell-3 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=37}\n%load_ext autoreload\n%autoreload 2\n\nThe autoreload extension is already loaded. To reload it, use:\n  %reload_ext autoreload\n\n:::\nConnect python with R kernel\n\nfrom beforerr.r import py2rpy_polars\nimport rpy2.robjects as robjects\n\n%load_ext rpy2.ipython\n\nr = robjects.r\nr.source('utils.R')\n\nconv_pl = py2rpy_polars()\n\nThe rpy2.ipython extension is already loaded. To reload it, use:\n  %reload_ext rpy2.ipython",
    "crumbs": [
      "Home",
      "Notebooks",
      "SWD Properties"
    ]
  },
  {
    "objectID": "notebooks/04_properties.html#processing-datasets",
    "href": "notebooks/04_properties.html#processing-datasets",
    "title": "SWD Properties",
    "section": "Processing datasets",
    "text": "Processing datasets\n\nts = 1 # unit: seconds\ntau = 60 # unit: seconds\ndata_dir = \"../data\"\nformat = \"arrow\"\n\n\nfrom utils import load_events, PARAMETERS\n\nwind_df = load_events('Wind', 1, 60, 'fit')\nsta_df = load_events('STA', 1, 60, 'fit')\njno_df = load_events('JNO', 1, 60, 'fit')\njno_df_tau_300 = load_events('JNO', 1, 300, 'fit')\njno_df_8hz = load_events('JNO', 0.125, 60, 'fit')\njno_df_8hz_tau_20 = load_events('JNO', 0.125, 20, 'fit')\njno_df_8hz_tau_20_der = load_events('JNO', 0.125, 20, 'derivative')\n\nother_events = pl.concat([wind_df, sta_df], how='diagonal')\n\nlogger.info(f\"Columns: {jno_df.columns}\")\n\n2024-02-18 21:55:57.510 | INFO     | __main__:&lt;module&gt;:13 - Columns: ['time', 'tstart', 'tstop', 'd_tstart', 'd_tstop', 'd_time', 'time_before', 'time_after', 'count', 'B_std', 'B_mean', 'dB_vec', 'index_diff', 'index_std', 'index_fluctuation', 'B.after', 'B.before', 'b_mag', 'b_n', 'bn_over_b', 'd_star', 'db_mag', 'db_over_b', 'db_over_b_max', 'fit.stat.chisqr', 'fit.stat.rsquared', 'fit.vars.amplitude', 'fit.vars.c', 'fit.vars.sigma', 'rotation_angle', 'dB_x', 'dB_y', 'dB_z', 'dB_lmn_x', 'dB_lmn_y', 'dB_lmn_z', 'k_x', 'k_y', 'k_z', 'Vl_x', 'Vl_y', 'Vl_z', 'Vn_x', 'Vn_y', 'Vn_z', 'duration', 'radial_distance', 'plasma_density', 'plasma_temperature', 'model_b_r', 'model_b_t', 'model_b_n', 'v_x', 'v_y', 'v_z', 'plasma_speed', 'B_background_x', 'B_background_y', 'B_background_z', 'v_x_before', 'v_y_before', 'v_z_before', 'n.before', 'v.ion.before', 'plasma_temperature_before', 'v_x_after', 'v_y_after', 'v_z_after', 'n.after', 'v.ion.after', 'plasma_temperature_after', 'v_l', 'v_n', 'v_k', 'v_mn', 'L_k', 'j0_k', 'ion_inertial_length', 'Alfven_speed', 'j_Alfven', 'L_k_norm', 'j0_k_norm', 'v.ion.before.l', 'v.ion.after.l', 'B.vec.before.l', 'B.vec.before.m', 'B.vec.before.n', 'B.vec.after.l', 'B.vec.after.m', 'B.vec.after.n', 'v.Alfven.before', 'v.Alfven.after', 'v.Alfven.before.l', 'v.Alfven.after.l', 'n.change', 'v.ion.change', 'v.ion.change.l', 'B.change', 'v.Alfven.change', 'v.Alfven.change.l', 'sat', 'ts', 'method', 'ts_method', 'label', 'index_d_diff']\n\n\nSome extreme values are present in the data. We will remove them.\n\nDISPLAY_VARS = ['time', 'sat'] + PARAMETERS\n\ndef check_candidates(df):\n    if isinstance(df, pl.LazyFrame):\n        df = df.collect()\n    logger.info(df.columns)\n    return df.select(DISPLAY_VARS).describe()\n\ncheck_candidates(jno_df)\n\n2024-02-18 21:55:57.523 | INFO     | __main__:check_candidates:6 - ['time', 'tstart', 'tstop', 'd_tstart', 'd_tstop', 'd_time', 'time_before', 'time_after', 'count', 'B_std', 'B_mean', 'dB_vec', 'index_diff', 'index_std', 'index_fluctuation', 'B.after', 'B.before', 'b_mag', 'b_n', 'bn_over_b', 'd_star', 'db_mag', 'db_over_b', 'db_over_b_max', 'fit.stat.chisqr', 'fit.stat.rsquared', 'fit.vars.amplitude', 'fit.vars.c', 'fit.vars.sigma', 'rotation_angle', 'dB_x', 'dB_y', 'dB_z', 'dB_lmn_x', 'dB_lmn_y', 'dB_lmn_z', 'k_x', 'k_y', 'k_z', 'Vl_x', 'Vl_y', 'Vl_z', 'Vn_x', 'Vn_y', 'Vn_z', 'duration', 'radial_distance', 'plasma_density', 'plasma_temperature', 'model_b_r', 'model_b_t', 'model_b_n', 'v_x', 'v_y', 'v_z', 'plasma_speed', 'B_background_x', 'B_background_y', 'B_background_z', 'v_x_before', 'v_y_before', 'v_z_before', 'n.before', 'v.ion.before', 'plasma_temperature_before', 'v_x_after', 'v_y_after', 'v_z_after', 'n.after', 'v.ion.after', 'plasma_temperature_after', 'v_l', 'v_n', 'v_k', 'v_mn', 'L_k', 'j0_k', 'ion_inertial_length', 'Alfven_speed', 'j_Alfven', 'L_k_norm', 'j0_k_norm', 'v.ion.before.l', 'v.ion.after.l', 'B.vec.before.l', 'B.vec.before.m', 'B.vec.before.n', 'B.vec.after.l', 'B.vec.after.m', 'B.vec.after.n', 'v.Alfven.before', 'v.Alfven.after', 'v.Alfven.before.l', 'v.Alfven.after.l', 'n.change', 'v.ion.change', 'v.ion.change.l', 'B.change', 'v.Alfven.change', 'v.Alfven.change.l', 'sat', 'ts', 'method', 'ts_method', 'label', 'index_d_diff']\n\n\n\nshape: (9, 7)\n\n\n\nstatistic\ntime\nsat\nj0_k\nj0_k_norm\nL_k\nL_k_norm\n\n\nstr\nstr\nstr\nf64\nf64\nf64\nf64\n\n\n\n\n\"count\"\n\"63143\"\n\"63143\"\n63143.0\n63143.0\n63143.0\n63143.0\n\n\n\"null_count\"\n\"0\"\n\"0\"\n0.0\n0.0\n0.0\n0.0\n\n\n\"mean\"\n\"2013-05-14 11:…\nnull\n125.040783\n12.398706\n9410.339035\n45.121054\n\n\n\"std\"\nnull\nnull\n12236.23217\n1077.446348\n5438.269571\n34.72957\n\n\n\"min\"\n\"2011-08-25 16:…\n\"JNO\"\n0.000018\n0.000036\n1.187819\n0.001187\n\n\n\"25%\"\n\"2012-03-08 20:…\nnull\n0.124872\n0.018557\n5123.132655\n20.526554\n\n\n\"50%\"\n\"2013-03-05 15:…\nnull\n0.2963\n0.046239\n8643.437318\n36.506577\n\n\n\"75%\"\n\"2014-03-11 18:…\nnull\n0.748768\n0.108717\n12991.083881\n59.95483\n\n\n\"max\"\n\"2016-06-29 23:…\n\"JNO\"\n2.4550e6\n187435.626378\n42775.89897\n382.018872\n\n\n\n\n\n\n\ndef remove_extreme(df, cols = ['j0_k', 'L_k'], q = 0.96):\n    filter_conditions = [\n        pl.col(col) &lt; pl.col(col).quantile(q) for col in cols\n    ] + [\n        pl.col(col) &gt; pl.col(col).quantile(1-q) for col in cols\n    ]\n    \n    return df.filter(filter_conditions)\n\ndef keep_good_fit(df: pl.DataFrame, rsquared = 0.95):\n    return df.filter(pl.col('fit.stat.rsquared') &gt; rsquared)\n\n# jno_df = jno_df.pipe(remove_extreme).pipe(keep_good_fit)\n# other_events = other_events.pipe(remove_extreme).pipe(keep_good_fit)\n# jno_df_tau_300 = jno_df_tau_300.pipe(remove_extreme).pipe(keep_good_fit)\n\njno_df = jno_df.pipe(keep_good_fit)\nother_events = other_events.pipe(keep_good_fit)\njno_df_tau_300 = jno_df_tau_300.pipe(keep_good_fit)\njno_df_8hz = jno_df_8hz.pipe(keep_good_fit)\njno_df_8hz_tau_20 = jno_df_8hz_tau_20.pipe(keep_good_fit)\njno_df_8hz_tau_20_der = jno_df_8hz_tau_20_der.filter(pl.col('len')==160, pl.col('index_d_diff')&gt;0.8)\n\n\nlogger.info(f\"Number of events &gt; 5AU: {jno_df.filter(pl.col('radial_distance') &gt; 4).height}\")\nlogger.info(f\"Number of events &gt; 5AU: {jno_df.filter(pl.col('radial_distance') &gt; 3, pl.col('radial_distance') &lt; 4).height}\")\nlogger.info(f\"Number of events &gt; 5AU: {jno_df_tau_300.filter(pl.col('radial_distance') &gt; 4).height}\")\n\n2024-02-18 21:56:00.091 | INFO     | __main__:&lt;module&gt;:1 - Number of events &gt; 5AU: 4207\n2024-02-18 21:56:00.093 | INFO     | __main__:&lt;module&gt;:2 - Number of events &gt; 5AU: 2033\n2024-02-18 21:56:00.094 | INFO     | __main__:&lt;module&gt;:3 - Number of events &gt; 5AU: 1035",
    "crumbs": [
      "Home",
      "Notebooks",
      "SWD Properties"
    ]
  },
  {
    "objectID": "notes.html",
    "href": "notes.html",
    "title": "Notes",
    "section": "",
    "text": "image.png\n\n\n\nNormalization of the daily rates to 400 km/s ?",
    "crumbs": [
      "Home",
      "Notes"
    ]
  },
  {
    "objectID": "notes.html#solar-wind-model",
    "href": "notes.html#solar-wind-model",
    "title": "Notes",
    "section": "Solar Wind Model",
    "text": "Solar Wind Model\nSadly, JUNO does not provide plasma data during the cruise phase, so to estimate the plasma state we will use MHD model.\nWe are using Michigan Solar WInd Model 2D (MSWIM2D), which models the solar wind propagation in 2D using the BATSRUS MHD solver. Keebler et al. (2022)\nSome key points about the model\n\nRepresenting the solar wind in the ecliptic plane from 1 to 75 AU\n2D MHD model, using the BATSRUS MHD solver\nInclusion of neutral hydrogen (important for the outer heliosphere)\nInner boundary is filled by time-shifting in situ data from multiple spacecraft\n\nFor model validation part, please see JUNO Model Report.",
    "crumbs": [
      "Home",
      "Notes"
    ]
  },
  {
    "objectID": "notes.html#section",
    "href": "notes.html#section",
    "title": "Notes",
    "section": "",
    "text": "image.png\n\n\n\nNormalization of the daily rates to 400 km/s ?",
    "crumbs": [
      "Home",
      "Notes"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/mag.html",
    "href": "notebooks/missions/juno/mag.html",
    "title": "JUNO Magnetic field data pipeline",
    "section": "",
    "text": "JUNO Magnetic field data can be downloaded from PDS website.\nfrom datetime import datetime\n\nimport polars as pl\nimport pandas as pd\n\nfrom discontinuitypy import ROOT_DIR\nfrom discontinuitypy.utils.pds import pds_download\nfrom discontinuitypy.utils.lbl import load_lbl\nfrom discontinuitypy.utils.basic import partition_data_by_year\nfrom discontinuitypy.utils.polars import create_partitions\nfrom discontinuitypy.pipelines.default.data_mag import create_pipeline_template\n\n\nfrom pipe import select, filter\n\nfrom typing import Literal\n\n[11/29/23 21:10:53] WARNING  TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook    warnings.py:109\n                             mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter                  \n                             console)\n%load_ext autoreload\n%autoreload 2",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO Magnetic field data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/mag.html#downloading-data",
    "href": "notebooks/missions/juno/mag.html#downloading-data",
    "title": "JUNO Magnetic field data pipeline",
    "section": "Downloading data",
    "text": "Downloading data\n\nJunoPhases = Literal[\"CRUISE\", \"JUPITER\"]\nJunoFGMCoords = Literal['SE', 'SS', 'PL']\nJunoFGMTimeResolutions = Literal[\"1SEC\", \"1MIN\"]\n\n\ndef download_data(\n    start=None,\n    end=None,\n    phase: JunoPhases = \"CRUISE\",\n    coord: JunoFGMCoords = \"SE\",\n    datatype: JunoFGMTimeResolutions = \"1SEC\",  # time resolution\n) -&gt; list[str]:\n    files = pds_download(\n        mission=\"Juno\",\n        instrument=\"FGM\",\n        dataset=phase,\n        coord=coord,\n        datatype=datatype,\n        path=ROOT_DIR / \"data/01_raw/\",\n    )\n\n    return list(files | filter(lambda x: x.endswith(\".lbl\")))\n\n\ndef _load_func(file):\n    df = pl.from_dataframe(load_lbl(file))\n    return (\n        df.lazy()\n        .with_columns(time=pl.col(\"SAMPLE UTC\").str.to_datetime(\"%Y %j %H %M %S %f\"))\n        .drop([\"SAMPLE UTC\", \"DECIMAL DAY\", \"INSTRUMENT RANGE\", \"X\", \"Y\", \"Z\"])\n        .sort(\"time\")\n    )\n\ndef parse_fp(fp):\n    fn = fp.split('/')[-1]\n    dt_str = fn.split('_')[3][0:7]\n    format = \"%Y%j\"\n    return datetime.strptime(dt_str, format)\n\n\ndef load_data(\n    start,\n    end,\n    datatype: str = \"1SEC\",  # time resolution\n) -&gt; pl.DataFrame:\n    start = pd.Timestamp(start)\n    end = pd.Timestamp(end)\n    files = download_data(start, end, datatype=datatype)\n    files_dict = {\n        file: parse_fp(file) for file in files\n    }\n    files = [k for k, v in files_dict.items() if start &lt;= v &lt; end]\n    return pl.concat(files | select(_load_func))",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO Magnetic field data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/mag.html#preprocessing-data",
    "href": "notebooks/missions/juno/mag.html#preprocessing-data",
    "title": "JUNO Magnetic field data pipeline",
    "section": "Preprocessing data",
    "text": "Preprocessing data\nConvert all files from lbl format to parquet format for faster processing\n::: {#cell-9 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’ execution_count=8}\ndef preprocess_data(raw_data: pl.DataFrame) -&gt; pl.DataFrame:\n    \"\"\"\n    Preprocess the raw dataset (only minor transformations)\n\n    - Applying naming conventions for columns\n    - Parsing and typing data\n    - Changing storing format (from `lbl` to `parquet`)\n    - Dropping useless columns\n    \"\"\"\n    return create_partitions(raw_data, _load_func)\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO Magnetic field data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/mag.html#processing-data",
    "href": "notebooks/missions/juno/mag.html#processing-data",
    "title": "JUNO Magnetic field data pipeline",
    "section": "Processing data",
    "text": "Processing data\n::: {#cell-11 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’ execution_count=9}\ndef process_data(\n    raw_data: pl.DataFrame,\n    ts: str = None,  # time resolution\n) -&gt; pl.DataFrame | dict[str, pl.DataFrame]:\n    \"\"\"\n    Partitioning data, for the sake of memory\n    \"\"\"\n    data: pl.LazyFrame = pl.concat(func() for func in raw_data.values())\n    return (\n        data.with_columns(pl.col(\"time\").dt.cast_time_unit(\"us\"))  # issue: https://github.com/pola-rs/polars/issues/12023\n        .unique(\"time\")\n        .sort(\"time\")\n        .pipe(partition_data_by_year)\n    )\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO Magnetic field data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/mag.html#pipeline",
    "href": "notebooks/missions/juno/mag.html#pipeline",
    "title": "JUNO Magnetic field data pipeline",
    "section": "Pipeline",
    "text": "Pipeline\n::: {#cell-13 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef create_pipeline(sat_id=\"JNO\", source=\"MAG\"):\n    return create_pipeline_template(\n        sat_id=sat_id,\n        source=source,\n        load_data_fn=download_data,\n        preprocess_data_fn=preprocess_data,\n        process_data_fn=process_data,\n    )\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO Magnetic field data pipeline"
    ]
  },
  {
    "objectID": "notebooks/20_model.html",
    "href": "notebooks/20_model.html",
    "title": "Models",
    "section": "",
    "text": "::: {#cell-2 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=1}\n%load_ext autoreload\n%autoreload 2\n:::\n\nfrom loguru import logger\nfrom typing import Dict\n\nimport hvplot.polars\n\nfrom datetime import timedelta\nimport numpy as np\nimport polars as pl\nimport polars.selectors as cs\nfrom discontinuitypy.utils.polars import pl_norm\n\n\nfrom beforerr.r import py2rpy_polars\nimport rpy2.robjects as robjects\n\n%load_ext rpy2.ipython\n\nr = robjects.r\nr.source('utils.R')\n\nconv_pl = py2rpy_polars()\n\nThe rpy2.ipython extension is already loaded. To reload it, use:\n  %reload_ext rpy2.ipython",
    "crumbs": [
      "Home",
      "Notebooks",
      "Models"
    ]
  },
  {
    "objectID": "notebooks/20_model.html#setup",
    "href": "notebooks/20_model.html#setup",
    "title": "Models",
    "section": "",
    "text": "::: {#cell-2 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=1}\n%load_ext autoreload\n%autoreload 2\n:::\n\nfrom loguru import logger\nfrom typing import Dict\n\nimport hvplot.polars\n\nfrom datetime import timedelta\nimport numpy as np\nimport polars as pl\nimport polars.selectors as cs\nfrom discontinuitypy.utils.polars import pl_norm\n\n\nfrom beforerr.r import py2rpy_polars\nimport rpy2.robjects as robjects\n\n%load_ext rpy2.ipython\n\nr = robjects.r\nr.source('utils.R')\n\nconv_pl = py2rpy_polars()\n\nThe rpy2.ipython extension is already loaded. To reload it, use:\n  %reload_ext rpy2.ipython",
    "crumbs": [
      "Home",
      "Notebooks",
      "Models"
    ]
  },
  {
    "objectID": "notebooks/20_model.html#process-model-data",
    "href": "notebooks/20_model.html#process-model-data",
    "title": "Models",
    "section": "Process model data",
    "text": "Process model data\n\ndef overview(df: pl.DataFrame, bcols, vcols):\n    \"\"\"Overview of the data\"\"\"\n    df_pd = df.to_pandas()\n    df_pd.hvplot(x=\"time\", y=bcols)\n    \n    b_fig = df_pd.hvplot.line(x=\"time\", y=bcols)\n    v_fig = df_pd.hvplot.line(x=\"time\", y=vcols)\n    rho_fig = df_pd.hvplot.line(x=\"time\", y=\"rho\", logy=True)\n    Ti_fig = df_pd.hvplot.line(x=\"time\", y=\"Ti\", logy=True)\n    return (b_fig + v_fig + rho_fig + Ti_fig).cols(1).opts(shared_axes=False)\n\n\njno_state_data : pl.DataFrame = pl.read_parquet('../data/03_primary/JNO_STATE_ts_3600s.parquet')\njno_state_data.columns\n\n['radial_distance',\n 'plasma_density',\n 'plasma_temperature',\n 'time',\n 'model_b_r',\n 'model_b_t',\n 'model_b_n',\n 'v_x',\n 'v_y',\n 'v_z',\n 'plasma_speed',\n 'B_background_x',\n 'B_background_y',\n 'B_background_z']",
    "crumbs": [
      "Home",
      "Notebooks",
      "Models"
    ]
  },
  {
    "objectID": "notebooks/20_model.html#hvplot",
    "href": "notebooks/20_model.html#hvplot",
    "title": "Models",
    "section": "Hvplot",
    "text": "Hvplot\n\n\ntime_column = \"time\"\nts = timedelta(seconds=3600)\nevery = timedelta(days=3)\n###\nwidth = 1600\nheight = 600\n\nlogy = True\nalpha = 0.618\n###\n\nmodel_b_col = \"MSWIM2D\"\njuno_b_col = \"Juno\"\n\ndf = (\n    jno_state_data.with_columns(\n        model_b=pl_norm(\"model_b_r\", \"model_b_t\", \"model_b_n\"),\n        B_background=pl_norm(\"B_background_x\", \"B_background_y\", \"B_background_z\"),\n    )\n    .sort(time_column)\n    .upsample(time_column, every=ts)\n    .rename({\"model_b\": model_b_col, \"B_background\": juno_b_col})\n)\n\ndf_avg = df.group_by_dynamic(time_column, every=every).agg(cs.numeric().mean())\n\npanel01 = df_avg.hvplot(\n    x=time_column,\n    y=[model_b_col, juno_b_col],\n    logy=logy,\n    color=[\"red\", \"black\"],\n    ylabel=\"Magnetic Field (nT)\",\n    width=width,\n    height=height,\n    xaxis=None,\n) * df.hvplot(\n    x=time_column,\n    y=juno_b_col,\n    color=\"gray\",\n    alpha=alpha,\n    label=\"Juno (high res)\",\n    xaxis=None,\n)\n\npanel02 = df.hvplot(\n    x=time_column, y=\"radial_distance\", width=width, ylabel=\"Radial Distance (AU)\"\n)\n\n\n(panel01.opts(legend_position=\"top_right\") + panel02).cols(1)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Models"
    ]
  },
  {
    "objectID": "notebooks/20_model.html#r-plot-publication-quality",
    "href": "notebooks/20_model.html#r-plot-publication-quality",
    "title": "Models",
    "section": "R plot (Publication quality)",
    "text": "R plot (Publication quality)\n\n%R -i df_avg -c conv_pl\n%R -i df -c conv_pl\n\n\n%%R -w 1200\ntime_column &lt;- \"time\"\nmodel_b_col &lt;- \"MSWIM2D\"\njuno_b_col &lt;- \"Juno\"\n\nalpha &lt;- 0.3\n\nfilename &lt;- \"model/juno_model_validation\"\n\n\nmagnetic_field_plot &lt;- ggplot(data = df_avg, aes(x = .data[[time_column]])) +\n  geom_line(aes(y = .data[[model_b_col]], color = \"MSWIM2D\")) +\n  geom_line(aes(y = .data[[juno_b_col]], color = \"Juno\")) +\n  geom_line(data = df, aes(y = .data[[juno_b_col]], color = \"Juno (high res)\"), alpha = alpha) +\n  scale_y_log10() +\n  labs(y = \"Magnetic Field (nT)\", x=\"Time\", color=NULL) +\n  theme_pubr(base_size = 16, ) +\n  scale_color_okabeito(palette = \"black_first\")\n\nxmin &lt;- as.POSIXct(\"2015-01-01\")\nxmax &lt;- as.POSIXct(\"2015-12-31\")\n\np2 &lt;- magnetic_field_plot + coord_cartesian(xlim = c(xmin, xmax)) + theme_transparent() + theme(legend.position = \"none\")\nmagnetic_field_plot + inset_element(p2, 0.2, 0, 0.8, 0.4) \n\n\n\n\n\n\n\n\n\n%%R -w 1200 -h 1000\nlibrary(ggmagnify)\n\nfilename &lt;- \"model/juno_model_validation_full\"\n\nhide_x = theme(\n  axis.title.x = element_blank(),\n  axis.text.x = element_blank(),\n  axis.ticks.x = element_blank(),\n)\n\nmagnetic_field_plot &lt;- ggplot(data = df_avg, aes(x = as.numeric(.data[[time_column]]))) +\n  geom_line(aes(y = .data[[model_b_col]], color = \"MSWIM2D\")) +\n  geom_line(aes(y = .data[[juno_b_col]], color = \"Juno\")) +\n  geom_line(data = df, aes(y = .data[[juno_b_col]], color = \"Juno (high res)\"), alpha = alpha) +\n  scale_y_log10() +\n  labs(y = \"Magnetic Field (nT)\", color=NULL) +\n  theme_pubr(base_size = 16) +\n  scale_color_okabeito(palette = \"black_first\")\n\n# Computation failed in `stat_magnify()`                                              \n# ! no applicable method for 'find_bounds' applied to an object of class \"c('POSIXct', 'POSIXt')\"\n\nfrom &lt;- c(xmin = as.numeric(as.POSIXct(\"2013-10-20\")), xmax = as.numeric(as.POSIXct(\"2014-03-15\")), ymin = 0.3, ymax = 10)\nto &lt;- c(xmin = as.numeric(as.POSIXct(\"2013-01-01\")), xmax = as.numeric(as.POSIXct(\"2015-01-01\")), ymin = 0.015, ymax = 0.1)\n\np1 &lt;- magnetic_field_plot + geom_magnify(from = from, to = to, recompute = TRUE, axes=\"y\")  + \n  guides(color = guide_legend(nrow = 1)) +\n  hide_x + \n  theme(\n    legend.position = c(0.5, 1),   # Center top inside the plot\n    legend.text = element_text(size = 16)\n  )\n\n# Create the radial distance plot (similar to panel02)\np2 &lt;- ggplot(df, aes(x = .data[[time_column]], y = radial_distance)) +\n  geom_line(linewidth=1) +\n  labs(x=\"Time\", y = \"Radial Distance (AU)\") +\n  theme_pubr(base_size = 16)\n\np_n &lt;- ggplot(df, aes(x = .data[[time_column]], y = plasma_density)) +\n  geom_line() +\n  scale_y_log10() +\n  labs(y = \"Ion Density (per cc)\") +\n  theme_pubr(base_size = 16) +\n  hide_x\n  \np_speed &lt;- ggplot(df, aes(x = .data[[time_column]], y = plasma_speed)) +\n  geom_line() +\n  labs(y = \"Ion Speed (km/s)\") +\n  theme_pubr(base_size = 16) +\n  hide_x\n\n# p &lt;- p1 + p_n + p2 \np &lt;- p1 + p_speed + p_n + p2 + plot_layout(heights = c(2, 1, 1, 1)) + plot_annotation(tag_levels = \"a\")\n\n\nsave_plot(filename)\nprint(p)\n\nSaving 16.7 x 13.9 in image\nSaving 16.7 x 13.9 in image\n\n\nWarning: stack imbalance in 'lapply', 112 then 111\nIn addition: There were 33 warnings (use warnings() to see them)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Models"
    ]
  },
  {
    "objectID": "notebooks/01_ids_example.html",
    "href": "notebooks/01_ids_example.html",
    "title": "Examples of discontinuities (publication plot)",
    "section": "",
    "text": "import sys\nimport yaml\n\nfrom space_analysis.ds.tplot import Config, export, process_panel\n\nimport matplotlib.pyplot as plt\nimport scienceplots\n\nplt.style.use([\"science\", \"nature\", \"notebook\"])\nplt.rc(\"savefig\", dpi=300)\nplt.rc('figure.subplot', wspace = 0, hspace = 0)\n\n\nfile_path = sys.argv[1]\n\n\nconfig = yaml.load(open(file_path), Loader=yaml.FullLoader)\nconfig = Config(**config)\ntvars2plot = []\n\n\nfor p_config in config.panels:\n    tvar2plot = process_panel(p_config)\n    tvars2plot.append(tvar2plot)\n\n\nexport(tvars2plot, config)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Examples of discontinuities (publication plot)"
    ]
  },
  {
    "objectID": "notebooks/11_ts_data.html",
    "href": "notebooks/11_ts_data.html",
    "title": "Time resolution effect",
    "section": "",
    "text": "%load_ext autoreload\n%autoreload 2\n\n\nfrom space_analysis.utils.speasy import Variables\nfrom discontinuitypy.datasets import IDsDataset\nfrom discontinuitypy.utils.basic import resample\nfrom beforerr.polars import pl_norm\n\nfrom datetime import timedelta\nfrom space_analysis.plasma.formulary import df_thermal_spd2temp\n\n\nts = timedelta(seconds=1 / 11)\ntau = timedelta(seconds=60)\n\n\ntimerange = ['2016-01-01', '2016-06-29']\nwind_mag_vars = Variables(\n    provider = 'archive/local',\n    dataset=\"WI_H4-RTN_MFI\",\n    parameters=[\"BRTN\"],\n    timerange=timerange\n)\n\nwind_plasma_vars = Variables(\n    dataset=\"WI_K0_SWE\",\n    parameters=[\"Np\", \"V_GSM\", \"THERMAL_SPD\"],\n    timerange=timerange,\n).retrieve_data()\n\n\nwind_density_col = wind_plasma_vars.data[0].columns[0]\nwind_vec_cols = wind_plasma_vars.data[1].columns\nwind_temperature_col = wind_plasma_vars.data[2].columns[0]\n\n\nwind_mag_data = wind_mag_vars.to_polars()\n\nwind_plasma_data = (\n    wind_plasma_vars.to_polars()\n    .with_columns(\n        plasma_speed=pl_norm(wind_vec_cols),\n    )\n    .pipe(df_thermal_spd2temp, wind_temperature_col)\n    .rename(\n        {\n            wind_density_col: \"plasma_density\",\n        }\n    )\n)\n\n\n# for freq in [11, 5 , 2, 1, 0.5]:\nfor freq in [5]:\n    ts = timedelta(seconds=1 / freq)\n\n    wind_ids_dataset = (\n        IDsDataset(\n            mag_data=wind_mag_data.pipe(resample, every=ts),\n            plasma_data=wind_plasma_data,\n            tau=tau,\n            ts=ts,\n            vec_cols=wind_vec_cols,\n            density_col=\"plasma_density\",\n            temperature_col=\"plasma_temperature\",\n        )\n        .find_events(return_best_fit=False)\n        .update_candidates_with_plasma_data()\n        .export(f\"../data/05_reporting/events.Wind.ts_{1/freq:.2f}s_tau_60s.arrow\")\n    )\n\n08-Feb-24 13:47:14: UserWarning: Distributing &lt;class 'pandas.core.frame.DataFrame'&gt; object. This may take some time.",
    "crumbs": [
      "Home",
      "Notebooks",
      "Time resolution effect"
    ]
  },
  {
    "objectID": "notebooks/11_ts_data.html#process-wind-data",
    "href": "notebooks/11_ts_data.html#process-wind-data",
    "title": "Time resolution effect",
    "section": "",
    "text": "%load_ext autoreload\n%autoreload 2\n\n\nfrom space_analysis.utils.speasy import Variables\nfrom discontinuitypy.datasets import IDsDataset\nfrom discontinuitypy.utils.basic import resample\nfrom beforerr.polars import pl_norm\n\nfrom datetime import timedelta\nfrom space_analysis.plasma.formulary import df_thermal_spd2temp\n\n\nts = timedelta(seconds=1 / 11)\ntau = timedelta(seconds=60)\n\n\ntimerange = ['2016-01-01', '2016-06-29']\nwind_mag_vars = Variables(\n    provider = 'archive/local',\n    dataset=\"WI_H4-RTN_MFI\",\n    parameters=[\"BRTN\"],\n    timerange=timerange\n)\n\nwind_plasma_vars = Variables(\n    dataset=\"WI_K0_SWE\",\n    parameters=[\"Np\", \"V_GSM\", \"THERMAL_SPD\"],\n    timerange=timerange,\n).retrieve_data()\n\n\nwind_density_col = wind_plasma_vars.data[0].columns[0]\nwind_vec_cols = wind_plasma_vars.data[1].columns\nwind_temperature_col = wind_plasma_vars.data[2].columns[0]\n\n\nwind_mag_data = wind_mag_vars.to_polars()\n\nwind_plasma_data = (\n    wind_plasma_vars.to_polars()\n    .with_columns(\n        plasma_speed=pl_norm(wind_vec_cols),\n    )\n    .pipe(df_thermal_spd2temp, wind_temperature_col)\n    .rename(\n        {\n            wind_density_col: \"plasma_density\",\n        }\n    )\n)\n\n\n# for freq in [11, 5 , 2, 1, 0.5]:\nfor freq in [5]:\n    ts = timedelta(seconds=1 / freq)\n\n    wind_ids_dataset = (\n        IDsDataset(\n            mag_data=wind_mag_data.pipe(resample, every=ts),\n            plasma_data=wind_plasma_data,\n            tau=tau,\n            ts=ts,\n            vec_cols=wind_vec_cols,\n            density_col=\"plasma_density\",\n            temperature_col=\"plasma_temperature\",\n        )\n        .find_events(return_best_fit=False)\n        .update_candidates_with_plasma_data()\n        .export(f\"../data/05_reporting/events.Wind.ts_{1/freq:.2f}s_tau_60s.arrow\")\n    )\n\n08-Feb-24 13:47:14: UserWarning: Distributing &lt;class 'pandas.core.frame.DataFrame'&gt; object. This may take some time.",
    "crumbs": [
      "Home",
      "Notebooks",
      "Time resolution effect"
    ]
  },
  {
    "objectID": "notebooks/missions/wind.html",
    "href": "notebooks/missions/wind.html",
    "title": "IDs from Wind",
    "section": "",
    "text": "See following notebooks for details:\nReferences:\nNotes:\nimport speasy as spz\n\nimport polars as pl\nimport polars.selectors as cs\nfrom space_analysis.utils.speasy import Variables\nfrom discontinuitypy.datasets import IDsDataset\nfrom discontinuitypy.utils.basic import resample\nfrom beforerr.polars import pl_norm\n\nfrom datetime import timedelta\nfrom sunpy.time import TimeRange\n\nfrom space_analysis.plasma.formulary import df_thermal_spd2temp\n\nfrom tqdm import tqdm\nspz.update_inventories()\ntimerange = [\"2011-08-25\", \"2016-06-30\"]\nmission = \"Wind\"\nts = timedelta(seconds=1)\ntau = timedelta(seconds=60)\n\nprovider = 'archive/local'\nmag_dataset = \"WI_H4-RTN_MFI\"\nmag_parameters = [\"BRTN\"]\nplasma_dataset = \"WI_K0_SWE\"\nplasma_parameters= [\"Np\", \"V_GSM\", \"THERMAL_SPD\"]\n\nfmt = 'arrow'\nfname = f\"../../data/05_reporting/events.{mission}.ts_{ts.total_seconds():.2f}s_tau_60s.{fmt}\"",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Wind"
    ]
  },
  {
    "objectID": "notebooks/missions/wind.html#downloading-data-file-first",
    "href": "notebooks/missions/wind.html#downloading-data-file-first",
    "title": "IDs from Wind",
    "section": "Downloading data file first",
    "text": "Downloading data file first\n\nimport pyspedas\n\ndef download(timerange):\n    pyspedas.wind.swe(timerange, datatype='k0', downloadonly=True)\n    pyspedas.wind.mfi(timerange, datatype=\"h4-rtn\", downloadonly=True)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Wind"
    ]
  },
  {
    "objectID": "notebooks/missions/wind.html#loading",
    "href": "notebooks/missions/wind.html#loading",
    "title": "IDs from Wind",
    "section": "Loading",
    "text": "Loading\n\ndef get_and_process_data(\n    mag_dataset, mag_parameters, plasma_dataset, plasma_parameters, timerange, tau, ts,\n    provider = 'archive/local'\n):\n    # define variables\n    mag_vars = Variables(\n        provider = provider,\n        dataset=mag_dataset,\n        parameters=mag_parameters,\n        timerange=timerange,\n    ).retrieve_data()\n\n    plasma_vars = Variables(\n        provider = provider,\n        dataset=plasma_dataset,\n        parameters=plasma_parameters,\n        timerange=timerange,\n    ).retrieve_data()\n\n    # get column names\n    bcols = mag_vars.data[0].columns\n    density_col = plasma_vars.data[0].columns[0]\n    vec_cols = plasma_vars.data[1].columns\n    temperature_col = plasma_vars.data[2].columns[0]\n\n    # get data\n    mag_data = mag_vars.to_polars()\n    plasma_data = (\n        plasma_vars.to_polars()\n        .with_columns(plasma_speed=pl_norm(vec_cols))\n        .rename({density_col: \"plasma_density\"})\n    )\n    # process temperature data\n    if plasma_vars.data[2].unit == \"km/s\":\n        plasma_data = plasma_data.pipe(df_thermal_spd2temp, temperature_col)\n    else:\n        plasma_data = plasma_data.rename({temperature_col: \"plasma_temperature\"})\n\n    return IDsDataset(\n        mag_data=mag_data.pipe(resample, every=ts),\n        plasma_data=plasma_data,\n        tau=tau,\n        ts=ts,\n        bcols=bcols,\n        vec_cols=vec_cols,\n        density_col=\"plasma_density\",\n        speed_col=\"plasma_speed\",\n        temperature_col=\"plasma_temperature\",\n    ).find_events(return_best_fit=False).update_candidates_with_plasma_data()\n\n\nids : list[pl.DataFrame] = []\nfor _tr in tqdm(TimeRange(timerange).split(8)):\n    \n    _timerange = [_tr.start.value, _tr.end.value]\n    _id = get_and_process_data(\n        mag_dataset, mag_parameters, plasma_dataset, plasma_parameters, _timerange, tau, ts\n    )\n    ids.append(_id.events)\n\n\npl.concat(ids).select(cs.datetime(), cs.duration(), cs.numeric()).write_ipc(fname)\n\n\n# from discontinuitypy.datasets import IDsDataset\n# import polars as pl\n# from fastcore.utils import walk\n\n\n# ts = 1 # unit: seconds\n# tau = 60 # unit: seconds\n\n# mission = \"Wind\"\n# data_dir = '../../data'\n# dir_path = f'{data_dir}/03_primary/{mission}_MAG_ts_{ts}s'\n# state_data_path = f'{data_dir}/03_primary/OMNI_LowRes_ts_3600s.parquet'\n# vec_cols = ['v_x', 'v_y', 'v_z']\n\n# format = 'arrow'\n# fname = f'events.{mission}.ts_{ts}s_tau_{tau}s.{format}'\n# output_path = f'{data_dir}/05_reporting/{fname}'\n\n\n# events = []\n# for mag_path in files[-1:]:\n\n#     mag_data = pl.scan_parquet(mag_path).drop('X', 'Y', 'Z').sort('time')\n#     plasma_data = pl.scan_parquet(state_data_path).sort('time')\n\n#     _events = (\n#         IDsDataset(\n#             mag_data=mag_data,\n#             plasma_data=plasma_data,\n#             tau=tau,\n#             ts=ts,\n#             vec_cols=vec_cols,\n#         )\n#         .find_events(return_best_fit=False)\n#         .update_candidates_with_plasma_data()\n#         .events\n#     )\n    \n#     events.append(_events)\n    \n# ids_dataset = IDsDataset(\n#     events=pl.concat(events),\n#     mag_data= pl.scan_parquet(list(walk(dir_path))).drop('X', 'Y', 'Z').sort('time')\n# ).export(output_path)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Wind"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/mag.html",
    "href": "notebooks/missions/themis/mag.html",
    "title": "THEMIS Magnetic field data pipeline",
    "section": "",
    "text": "For convenience, we choose magnetic field data in GSE coordinate system\nThe fgs data are in 3-4s resolution",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS",
      "THEMIS Magnetic field data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/mag.html#loading-data",
    "href": "notebooks/missions/themis/mag.html#loading-data",
    "title": "THEMIS Magnetic field data pipeline",
    "section": "Loading data",
    "text": "Loading data\n\nfrom space_analysis.utils.speasy import Variables\nfrom datetime import timedelta\n\n\ntimerange = [\"2011-08-25\", \"2016-06-30\"]\n# timerange = [\"2011-08-25\", \"2011-09-01\"]\nmission = \"THB\"\nts = timedelta(seconds=1)\ntau = timedelta(seconds=60)\n\nprovider = 'archive/local'\nmag_dataset = \"THB_L2_FGM\"\nmag_parameters = [\"thb_fgl_gse\"]\n\nmag_vars = Variables(\n    provider = provider,\n    dataset=mag_dataset,\n    parameters=mag_parameters,\n    timerange=timerange,\n).retrieve_data()\n\nKeyboardInterrupt: \n\n\n\nmag_vars.to_polars()\n\nnaive plan: (run LazyFrame.explain(optimized=True) to see the optimized plan)\n    \n    DF [\"Bx FGL-D\", \"By FGL-D\", \"Bz FGL-D\", \"time\"]; PROJECT */4 COLUMNS; SELECTION: \"None\"\n\n\n::: {#cell-5 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef preprocess_data(\n    raw_data: pl.LazyFrame,\n    datatype: str = None,\n) -&gt; pl.LazyFrame:\n    \"\"\"\n    Preprocess the raw dataset (only minor transformations)\n\n    - Applying naming conventions for columns\n    - Dropping duplicate time\n    - Changing storing format to `parquet`\n\n    \"\"\"\n\n    datatype = datatype.upper()\n    name_mapping = {\n        f\"Bx {datatype}-D\": \"B_x\",\n        f\"By {datatype}-D\": \"B_y\",\n        f\"Bz {datatype}-D\": \"B_z\",\n    }\n\n    return raw_data.sort(\"time\").unique(\"time\").rename(name_mapping)\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS",
      "THEMIS Magnetic field data pipeline"
    ]
  },
  {
    "objectID": "notebooks/00_overview.html",
    "href": "notebooks/00_overview.html",
    "title": "Overview",
    "section": "",
    "text": "Snunspot data\nimport matplotlib.pyplot as plt\nimport scienceplots\n\nfrom space_analysis.utils.cdas import Variables\nfrom space_analysis.plot.basic import savefig\nimport pandas as pd\nimport polars as pl\n\nfrom matplotlib.pyplot import Axes\n\nplt.rc(\"savefig\", dpi=300)\nplt.rc('figure.subplot', wspace = 0, hspace = 0)\ntimerange = [\"2011-08-01\", \"2016-07-01\"]\nfname = \"juno-hg-loc_sunspot-number\"\n\ndatasets = ['JUNO_HELIO1DAY_POSITION', 'EARTH_HELIO1DAY_POSITION', 'STA_HELIO1DAY_POSITION']\nnames = ['JUNO', 'EARTH', 'STA']",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview"
    ]
  },
  {
    "objectID": "notebooks/00_overview.html#plotting-juno-and-other-mission-location",
    "href": "notebooks/00_overview.html#plotting-juno-and-other-mission-location",
    "title": "Overview",
    "section": "Plotting Juno and other mission location",
    "text": "Plotting Juno and other mission location\n\ndfs = []\n\nfor dataset, name in zip(datasets, names):\n    ds_variables = Variables(\n        dataset=dataset,\n        timerange=timerange,\n    )\n    df = ds_variables.to_pandas()\n    df = df.rename(columns={c: f\"{name}_{c}\" for c in df.columns})\n    dfs.append(df)\n\n2024-02-08 23:52:27.545 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - RAD_AU\n2024-02-08 23:52:27.546 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - SE_LAT\n2024-02-08 23:52:27.546 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - SE_LON\n2024-02-08 23:52:27.546 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HG_LAT\n2024-02-08 23:52:27.547 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HG_LON\n2024-02-08 23:52:27.547 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HGI_LAT\n2024-02-08 23:52:27.548 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HGI_LON\n2024-02-08 23:52:28.326 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - RAD_AU\n2024-02-08 23:52:28.327 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - SE_LAT\n2024-02-08 23:52:28.327 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - SE_LON\n2024-02-08 23:52:28.328 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HG_LAT\n2024-02-08 23:52:28.328 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HG_LON\n2024-02-08 23:52:28.328 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HGI_LAT\n2024-02-08 23:52:28.329 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HGI_LON\n2024-02-08 23:52:29.032 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - RAD_AU\n2024-02-08 23:52:29.033 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - SE_LAT\n2024-02-08 23:52:29.033 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - SE_LON\n2024-02-08 23:52:29.034 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HG_LAT\n2024-02-08 23:52:29.034 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HG_LON\n2024-02-08 23:52:29.034 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HGI_LAT\n2024-02-08 23:52:29.035 | INFO     | space_analysis.utils.cdas:get_dataset_variables:25 - HGI_LON\n\n\n\ndf_concated = pd.concat(dfs, axis=1)\n\n\ndf = pl.DataFrame(df_concated.reset_index()).with_columns(\n    JUNO_EARTH_HGI_LON_diff = (pl.col(\"JUNO_HGI_LON\") - pl.col(\"EARTH_HGI_LON\")).abs(),\n    JUNO_STA_HGI_LON_diff = (pl.col(\"JUNO_HGI_LON\") - pl.col(\"STA_HGI_LON\")).abs(),\n    JUNO_EARTH_HG_LON_diff = (pl.col(\"JUNO_HG_LON\") - pl.col(\"EARTH_HG_LON\")).abs(),\n    JUNO_STA_HG_LON_diff = (pl.col(\"JUNO_HG_LON\") - pl.col(\"STA_HG_LON\")).abs(),\n).with_columns(\n    JUNO_EARTH_HG_LON_diff = pl.when(pl.col(\"JUNO_EARTH_HG_LON_diff\")&gt;180).then(360-pl.col(\"JUNO_EARTH_HG_LON_diff\")).otherwise(pl.col(\"JUNO_EARTH_HG_LON_diff\")),\n    JUNO_STA_HG_LON_diff = pl.when(pl.col(\"JUNO_STA_HG_LON_diff\")&gt;180).then(360-pl.col(\"JUNO_STA_HG_LON_diff\")).otherwise(pl.col(\"JUNO_STA_HG_LON_diff\")),\n)\n\n\ndef plot_lon_diff(df,ax: Axes):\n    ax.plot(df[\"Epoch\"], df[\"JUNO_EARTH_HG_LON_diff\"], label=\"Earth\")\n    ax.plot(df[\"Epoch\"], df[\"JUNO_STA_HG_LON_diff\"], label=\"STA\")\n    ax.set_ylabel(\"HG Longitude\\nDifference\\n[deg]\")",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview"
    ]
  },
  {
    "objectID": "notebooks/00_overview.html#plotting-a-solar-cycle-index",
    "href": "notebooks/00_overview.html#plotting-a-solar-cycle-index",
    "title": "Overview",
    "section": "Plotting a solar cycle index",
    "text": "Plotting a solar cycle index\nhttps://docs.sunpy.org/en/stable/generated/gallery/plotting/solar_cycle_example.html\n\n%pip install \"sunpy[net, timeseries]\"\n\nRequirement already satisfied: sunpy[net,timeseries] in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (5.1.1)\nRequirement already satisfied: astropy!=5.1.0,&gt;=5.0.6 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (6.0.0)\nRequirement already satisfied: numpy&gt;=1.21.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (1.26.3)\nRequirement already satisfied: packaging&gt;=19.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (23.2)\nRequirement already satisfied: parfive&gt;=2.0.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (2.0.2)\nRequirement already satisfied: cdflib!=0.4.0,!=1.0.0,&gt;=0.3.20 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (0.4.9)\nRequirement already satisfied: h5netcdf&gt;=0.11 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (1.3.0)\nRequirement already satisfied: h5py&gt;=3.1.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (3.10.0)\nRequirement already satisfied: matplotlib&gt;=3.5.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (3.8.2)\nRequirement already satisfied: pandas&gt;=1.2.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (2.1.4)\nRequirement already satisfied: beautifulsoup4&gt;=4.8.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (4.12.3)\nRequirement already satisfied: drms&lt;0.7.0,&gt;=0.6.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (0.6.4)\nRequirement already satisfied: python-dateutil&gt;=2.8.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (2.8.2)\nRequirement already satisfied: tqdm&gt;=4.32.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (4.66.1)\nRequirement already satisfied: zeep&gt;=3.4.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from sunpy[net,timeseries]) (4.2.1)\nRequirement already satisfied: pyerfa&gt;=2.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from astropy!=5.1.0,&gt;=5.0.6-&gt;sunpy[net,timeseries]) (2.0.1.1)\nRequirement already satisfied: astropy-iers-data&gt;=0.2023.10.30.0.29.53 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from astropy!=5.1.0,&gt;=5.0.6-&gt;sunpy[net,timeseries]) (0.2024.1.29.0.30.37)\nRequirement already satisfied: PyYAML&gt;=3.13 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from astropy!=5.1.0,&gt;=5.0.6-&gt;sunpy[net,timeseries]) (6.0.1)\nRequirement already satisfied: soupsieve&gt;1.2 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from beautifulsoup4&gt;=4.8.0-&gt;sunpy[net,timeseries]) (2.5)\nRequirement already satisfied: contourpy&gt;=1.0.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from matplotlib&gt;=3.5.0-&gt;sunpy[net,timeseries]) (1.2.0)\nRequirement already satisfied: cycler&gt;=0.10 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from matplotlib&gt;=3.5.0-&gt;sunpy[net,timeseries]) (0.12.1)\nRequirement already satisfied: fonttools&gt;=4.22.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from matplotlib&gt;=3.5.0-&gt;sunpy[net,timeseries]) (4.47.2)\nRequirement already satisfied: kiwisolver&gt;=1.3.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from matplotlib&gt;=3.5.0-&gt;sunpy[net,timeseries]) (1.4.5)\nRequirement already satisfied: pillow&gt;=8 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from matplotlib&gt;=3.5.0-&gt;sunpy[net,timeseries]) (10.2.0)\nRequirement already satisfied: pyparsing&gt;=2.3.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from matplotlib&gt;=3.5.0-&gt;sunpy[net,timeseries]) (3.1.1)\nRequirement already satisfied: pytz&gt;=2020.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from pandas&gt;=1.2.0-&gt;sunpy[net,timeseries]) (2023.4)\nRequirement already satisfied: tzdata&gt;=2022.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from pandas&gt;=1.2.0-&gt;sunpy[net,timeseries]) (2023.4)\nRequirement already satisfied: aiohttp in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from parfive&gt;=2.0.0-&gt;parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (3.9.3)\nRequirement already satisfied: aioftp&gt;=0.17.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (0.22.3)\nRequirement already satisfied: six&gt;=1.5 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from python-dateutil&gt;=2.8.0-&gt;sunpy[net,timeseries]) (1.16.0)\nRequirement already satisfied: attrs&gt;=17.2.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (23.2.0)\nRequirement already satisfied: isodate&gt;=0.5.4 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (0.6.1)\nRequirement already satisfied: lxml&gt;=4.6.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (5.1.0)\nRequirement already satisfied: platformdirs&gt;=1.4.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (4.1.0)\nRequirement already satisfied: requests&gt;=2.7.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (2.31.0)\nRequirement already satisfied: requests-toolbelt&gt;=0.7.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (1.0.0)\nRequirement already satisfied: requests-file&gt;=1.5.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (2.0.0)\nRequirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from requests&gt;=2.7.0-&gt;zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (3.3.2)\nRequirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from requests&gt;=2.7.0-&gt;zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (3.6)\nRequirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from requests&gt;=2.7.0-&gt;zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (2.1.0)\nRequirement already satisfied: certifi&gt;=2017.4.17 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from requests&gt;=2.7.0-&gt;zeep&gt;=3.4.0-&gt;sunpy[net,timeseries]) (2023.11.17)\nRequirement already satisfied: aiosignal&gt;=1.1.2 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from aiohttp-&gt;parfive&gt;=2.0.0-&gt;parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (1.3.1)\nRequirement already satisfied: frozenlist&gt;=1.1.1 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from aiohttp-&gt;parfive&gt;=2.0.0-&gt;parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (1.4.1)\nRequirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from aiohttp-&gt;parfive&gt;=2.0.0-&gt;parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (6.0.4)\nRequirement already satisfied: yarl&lt;2.0,&gt;=1.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from aiohttp-&gt;parfive&gt;=2.0.0-&gt;parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (1.9.4)\nRequirement already satisfied: async-timeout&lt;5.0,&gt;=4.0 in /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages (from aiohttp-&gt;parfive&gt;=2.0.0-&gt;parfive[ftp]&gt;=2.0.0-&gt;sunpy[net,timeseries]) (4.0.3)\nNote: you may need to restart the kernel to use updated packages.\n\n\n\nfrom astropy.time import Time\n\nimport sunpy.timeseries as ts\nfrom sunpy.net import Fido\nfrom sunpy.net import attrs as a\nfrom sunpy.time import TimeRange\n\n08-Feb-24 23:52:31: /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages/drms/version.py:25: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n  for j, piece in enumerate(LooseVersion(version).version[:3]):\n\n\n\nThe U.S. Dept. of Commerce, NOAA, Space Weather Prediction Center (SWPC)\nprovides recent solar cycle indices which includes different sunspot numbers,\nradio flux, and geomagnetic index. They also provide predictions for how the\nsunspot number and radio flux will evolve. Predicted values are based on the\nconsensus of the Solar Cycle 24 Prediction Panel.\nWe will first search for and then download the data.\n\ntime_range = TimeRange(timerange)\nresult = Fido.search(a.Time(time_range), a.Instrument('noaa-indices'))\nf_noaa_indices = Fido.fetch(result)\n\nnoaa = ts.TimeSeries(f_noaa_indices, source='noaaindices').truncate(time_range)\n\n08-Feb-24 23:52:33: /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages/ipywidgets/widgets/widget.py:528: DeprecationWarning: The `ipykernel.comm.Comm` class has been deprecated. Please use the `comm` module instead.For creating comms, use the function `from comm import create_comm`.\n  self.comm = Comm(**args)\n\n08-Feb-24 23:52:34: /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/site-packages/erfa/core.py:154: ErfaWarning: ERFA function \"dtf2d\" yielded 1 of \"dubious year (Note 6)\"\n  warnings.warn('ERFA function \"{}\" yielded {}'.format(func_name, wmsg),\n\n08-Feb-24 23:52:34: /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/asyncio/base_events.py:688: ResourceWarning: unclosed event loop &lt;_UnixSelectorEventLoop running=False closed=False debug=False&gt;\n  _warn(f\"unclosed event loop {self!r}\", ResourceWarning, source=self)\n\nException ignored in: &lt;function BaseEventLoop.__del__ at 0x101c9b7f0&gt;\nTraceback (most recent call last):\n  File \"/Users/zijin/micromamba/envs/cool_planet/lib/python3.10/asyncio/base_events.py\", line 690, in __del__\n    self.close()\n  File \"/Users/zijin/micromamba/envs/cool_planet/lib/python3.10/asyncio/unix_events.py\", line 71, in close\n    self.remove_signal_handler(sig)\n  File \"/Users/zijin/micromamba/envs/cool_planet/lib/python3.10/asyncio/unix_events.py\", line 160, in remove_signal_handler\n    signal.signal(sig, handler)\n  File \"/Users/zijin/micromamba/envs/cool_planet/lib/python3.10/signal.py\", line 56, in signal\n    handler = _signal.signal(_enum_to_int(signalnum), _enum_to_int(handler))\nValueError: signal only works in main thread of the main interpreter\n08-Feb-24 23:52:34: /Users/zijin/micromamba/envs/cool_planet/lib/python3.10/asyncio/selector_events.py:710: ResourceWarning: unclosed transport &lt;_SelectorSocketTransport fd=87&gt;\n  _warn(f\"unclosed transport {self!r}\", ResourceWarning, source=self)\n\n\n\n\n\n\nWe then load them into individual ~sunpy.timeseries.TimeSeries objects.\nFinally, we plot both noaa and noaa_predict for the sunspot number.\nIn this case we use the S.I.D.C. Brussels International Sunspot Number (RI).\nThe predictions provide both a high and low values, which we plot below as\nranges.\n\n\ndef plot_sunspot_number(noaa_indices_ts, ax):\n    \n    time : Time = noaa_indices_ts.time\n    time = time.to_datetime()\n    \n    ax.scatter(time, noaa_indices_ts.quantity('sunspot RI'))\n    ax.plot(time, noaa_indices_ts.quantity('sunspot RI'), label='Monthly')\n    ax.plot(\n        time, noaa_indices_ts.quantity('sunspot RI smooth'), label='Smoothed'\n    )\n    \n    ax.set_ylim(bottom=0)\n    ax.set_ylabel('Sunspot\\nNumber\\n[#]')",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview"
    ]
  },
  {
    "objectID": "notebooks/00_overview.html#plotting-omni-and-stereo-plasma-data",
    "href": "notebooks/00_overview.html#plotting-omni-and-stereo-plasma-data",
    "title": "Overview",
    "section": "Plotting OMNI and STEREO plasma data",
    "text": "Plotting OMNI and STEREO plasma data\n\nimport sys\nimport yaml\n\nfrom space_analysis.ds.tplot import Config, export, process_panel, plot\n\nfile_path = 'omni_stereo.yml'\nconfig = yaml.load(open(file_path), Loader=yaml.FullLoader)\nconfig = Config(**config)\ntvars2plot = []\n\n\nfor p_config in config.panels:\n    tvar2plot = process_panel(p_config)\n    tvars2plot.append(tvar2plot)\n\n08-Feb-24 23:52:12: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2011/\n08-Feb-24 23:52:13: File is current: /Users/zijin/data/omni/hourly/2011/omni2_h0_mrg1hr_20110701_v01.cdf\n08-Feb-24 23:52:13: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2012/\n08-Feb-24 23:52:13: File is current: /Users/zijin/data/omni/hourly/2012/omni2_h0_mrg1hr_20120101_v01.cdf\n08-Feb-24 23:52:13: File is current: /Users/zijin/data/omni/hourly/2012/omni2_h0_mrg1hr_20120701_v01.cdf\n08-Feb-24 23:52:13: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2013/\n08-Feb-24 23:52:13: File is current: /Users/zijin/data/omni/hourly/2013/omni2_h0_mrg1hr_20130101_v01.cdf\n08-Feb-24 23:52:14: File is current: /Users/zijin/data/omni/hourly/2013/omni2_h0_mrg1hr_20130701_v01.cdf\n08-Feb-24 23:52:14: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2014/\n08-Feb-24 23:52:14: File is current: /Users/zijin/data/omni/hourly/2014/omni2_h0_mrg1hr_20140101_v01.cdf\n08-Feb-24 23:52:14: File is current: /Users/zijin/data/omni/hourly/2014/omni2_h0_mrg1hr_20140701_v01.cdf\n08-Feb-24 23:52:14: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2015/\n08-Feb-24 23:52:15: File is current: /Users/zijin/data/omni/hourly/2015/omni2_h0_mrg1hr_20150101_v01.cdf\n08-Feb-24 23:52:15: File is current: /Users/zijin/data/omni/hourly/2015/omni2_h0_mrg1hr_20150701_v01.cdf\n08-Feb-24 23:52:15: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2016/\n08-Feb-24 23:52:15: File is current: /Users/zijin/data/omni/hourly/2016/omni2_h0_mrg1hr_20160101_v01.cdf\n08-Feb-24 23:52:16: File is current: /Users/zijin/data/omni/hourly/2016/omni2_h0_mrg1hr_20160701_v01.cdf\n08-Feb-24 23:52:16: avg_data was applied to: N-avg\n2024-02-08 23:52:16.820 | DEBUG    | space_analysis.ds.tplot:process_panel:369 - Processed tvar: ['N-avg']\n08-Feb-24 23:52:16: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2011/\n08-Feb-24 23:52:17: File is current: /Users/zijin/data/omni/hourly/2011/omni2_h0_mrg1hr_20110701_v01.cdf\n08-Feb-24 23:52:17: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2012/\n08-Feb-24 23:52:17: File is current: /Users/zijin/data/omni/hourly/2012/omni2_h0_mrg1hr_20120101_v01.cdf\n08-Feb-24 23:52:17: File is current: /Users/zijin/data/omni/hourly/2012/omni2_h0_mrg1hr_20120701_v01.cdf\n08-Feb-24 23:52:17: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2013/\n08-Feb-24 23:52:18: File is current: /Users/zijin/data/omni/hourly/2013/omni2_h0_mrg1hr_20130101_v01.cdf\n08-Feb-24 23:52:18: File is current: /Users/zijin/data/omni/hourly/2013/omni2_h0_mrg1hr_20130701_v01.cdf\n08-Feb-24 23:52:18: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2014/\n08-Feb-24 23:52:18: File is current: /Users/zijin/data/omni/hourly/2014/omni2_h0_mrg1hr_20140101_v01.cdf\n08-Feb-24 23:52:19: File is current: /Users/zijin/data/omni/hourly/2014/omni2_h0_mrg1hr_20140701_v01.cdf\n08-Feb-24 23:52:19: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2015/\n08-Feb-24 23:52:19: File is current: /Users/zijin/data/omni/hourly/2015/omni2_h0_mrg1hr_20150101_v01.cdf\n08-Feb-24 23:52:19: File is current: /Users/zijin/data/omni/hourly/2015/omni2_h0_mrg1hr_20150701_v01.cdf\n08-Feb-24 23:52:19: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2016/\n08-Feb-24 23:52:19: File is current: /Users/zijin/data/omni/hourly/2016/omni2_h0_mrg1hr_20160101_v01.cdf\n08-Feb-24 23:52:20: File is current: /Users/zijin/data/omni/hourly/2016/omni2_h0_mrg1hr_20160701_v01.cdf\n08-Feb-24 23:52:20: avg_data was applied to: V-avg\n2024-02-08 23:52:20.979 | DEBUG    | space_analysis.ds.tplot:process_panel:369 - Processed tvar: ['V-avg']\n08-Feb-24 23:52:24: avg_data was applied to: plasmaDensity-avg\n2024-02-08 23:52:24.183 | DEBUG    | space_analysis.ds.tplot:process_panel:369 - Processed tvar: ['plasmaDensity-avg']\n08-Feb-24 23:52:26: avg_data was applied to: plasmaSpeed-avg\n2024-02-08 23:52:26.524 | DEBUG    | space_analysis.ds.tplot:process_panel:369 - Processed tvar: ['plasmaSpeed-avg']\n\n\n\nfig, axes = plot(tvars2plot, config)\nfig\n\n\n\n\n\n\n\n\n\nfig, axes = plt.subplots(nrows=2, ncols=1, sharex=True, figsize=(10, 6))\n\nplot_lon_diff(df, axes[0])\nplot_sunspot_number(noaa, axes[1])",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview"
    ]
  },
  {
    "objectID": "notebooks/00_overview.html#overview-plot",
    "href": "notebooks/00_overview.html#overview-plot",
    "title": "Overview",
    "section": "Overview plot",
    "text": "Overview plot\n\ndef unify_axes_fontsize(axes, fontsize=8):\n    for ax in axes:\n        for item in ([ax.title, ax.xaxis.label, ax.yaxis.label] +\n                    ax.get_xticklabels() + ax.get_yticklabels()):\n            item.set_fontsize(fontsize)\n\n\nwith plt.style.context(['science', 'nature', 'no-latex']):\n    fig, axes = plt.subplots(nrows=6, ncols=1, sharex=True, figsize=(7.5, 7.5))\n\n    plot_lon_diff(df, axes[0])\n    plot_sunspot_number(noaa, axes[1])\n    plot(tvars2plot=tvars2plot, fig=fig, axes=axes[2:], config=config)\n    \n    for ax in axes:\n        legend = ax.legend(handletextpad=0, handlelength=0)\n    \n        for line, text in zip(legend.get_lines(),legend.get_texts()):\n            text.set_color(line.get_color())\n    \n    unify_axes_fontsize(axes, fontsize=8)\n    # plt.subplots_adjust(wspace=0, hspace=0)\n    \n    savefig(fname)\n\nfig\n\n    \n\n09-Feb-24 00:39:00: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.\n09-Feb-24 00:39:00: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.\n09-Feb-24 00:39:00: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.\n09-Feb-24 00:39:00: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.\n\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n\n\nFigure 1:",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/state.html",
    "href": "notebooks/missions/themis/state.html",
    "title": "THEMIS State data pipeline",
    "section": "",
    "text": "We use low resolution OMNI data for plasma state data, as we did in the OMNI notebook\n::: {#cell-1 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS",
      "THEMIS State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/state.html#solar-wind-state",
    "href": "notebooks/missions/themis/state.html#solar-wind-state",
    "title": "THEMIS State data pipeline",
    "section": "Solar wind state",
    "text": "Solar wind state\nAlso we have additional data file that indicate if THEMIS is in solar wind or not.\n::: {#cell-4 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef load_sw_data(raw_data: pandas.DataFrame):\n    return pl.from_dataframe(raw_data)\n:::\n::: {#cell-5 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef preprocess_sw_data(\n    raw_data: pl.LazyFrame,\n) -&gt; pl.LazyFrame:\n    \"\"\"\n    - Applying naming conventions for columns\n    - Parsing and typing data (like from string to datetime for time columns)\n    \"\"\"\n\n    return raw_data.with_columns(\n        # Note: For `polars`, please either specify both hour and minute, or neither.\n        pl.concat_str(pl.col(\"start\"), pl.lit(\" 00\")).str.to_datetime(\n            format=\"%Y %j %H %M\"\n        ),\n        pl.concat_str(pl.col(\"end\"), pl.lit(\" 00\")).str.to_datetime(\n            format=\"%Y %j %H %M\"\n        ),\n    )\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS",
      "THEMIS State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/state.html#pipelines",
    "href": "notebooks/missions/themis/state.html#pipelines",
    "title": "THEMIS State data pipeline",
    "section": "Pipelines",
    "text": "Pipelines\n::: {#cell-7 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef create_sw_pipeline(sat_id=\"THB\", source=\"STATE\"):\n    namespace = f\"{sat_id}.{source}\"\n    node_load_sw_data = node(\n        load_sw_data,\n        inputs=\"original_sw_data\",\n        outputs=\"raw_data_sw\",\n        name=\"load_solar_wind_data\",\n    )\n    node_preprocess_sw_state = node(\n        preprocess_sw_data,\n        inputs=\"raw_data_sw\",\n        outputs=\"inter_data_sw\",\n        name=\"preprocess_solar_wind_data\",\n    )\n    return pipeline(\n        [\n            node_load_sw_data,\n            node_preprocess_sw_state,\n        ],\n        namespace=namespace,\n    )\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS",
      "THEMIS State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/index.html",
    "href": "notebooks/missions/themis/index.html",
    "title": "IDs from ARTHEMIS",
    "section": "",
    "text": "See following notebooks for details:",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/index.html#background",
    "href": "notebooks/missions/themis/index.html#background",
    "title": "IDs from ARTHEMIS",
    "section": "Background",
    "text": "Background\nARTEMIS spacecrafts will be exposed in the solar wind at 1 AU during its orbits around the Moon. So it’s very interesting to look into its data.\n\nFor time inteval for THEMIS-B in solar wind, see Link\nFor time inteval for THEMIS-C in solar wind, see Link\n\n\nimport polars as pl\nfrom space_analysis.utils.speasy import Variables\nfrom discontinuitypy.datasets import IDsDataset\nfrom discontinuitypy.utils.basic import resample\nfrom beforerr.polars import pl_norm\n\nfrom datetime import timedelta\nfrom sunpy.time import TimeRange\n\nfrom space_analysis.plasma.formulary import df_thermal_spd2temp\n\nfrom tqdm import tqdm\n\n25-Feb-24 21:20:54: UserWarning: Traceback (most recent call last):\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 85, in &lt;module&gt;\n    from . import skintegrate\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/skintegrate.py\", line 20, in &lt;module&gt;\n    from sklearn.base import BaseEstimator\nModuleNotFoundError: No module named 'sklearn'\n\n\n25-Feb-24 21:20:54: UserWarning: pdpipe: Scikit-learn or skutil import failed. Scikit-learn-dependent pipeline stages will not be loaded.\n\n25-Feb-24 21:20:54: UserWarning: Traceback (most recent call last):\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 105, in &lt;module&gt;\n    from . import nltk_stages\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/nltk_stages.py\", line 19, in &lt;module&gt;\n    import nltk\nModuleNotFoundError: No module named 'nltk'\n\n\n25-Feb-24 21:20:54: UserWarning: pdpipe: nltk import failed. nltk-dependent  pipeline stages will not be loaded.\n\n\n\n\ntimerange = [\"2011-08-25\", \"2016-06-30\"]\ntimerange = [\"2011-08-25\", \"2011-09-01\"]\nmission = \"THB\"\nts = timedelta(seconds=1)\ntau = timedelta(seconds=60)\n\nprovider = 'archive/local'\nmag_dataset = \"THB_L2_FGM\"\nmag_parameters = [\"thb_fgl_gse\"]\nplasma_dataset = 'THB_L2_MOM'\nplasma_parameters = [\"thb_peim_densityQ\", \"thb_peim_velocity_gseQ\"]\n\nfmt = 'arrow'\nfname = f\"../../../data/05_reporting/events.{mission}.ts_{ts.total_seconds():.2f}s_tau_60s.{fmt}\"\n\n\ntimerange = [\"2011-08-25\", \"2016-06-30\"]\ntimerange = [\"2011-08-25\", \"2011-09-01\"]\n\nmission = \"Wind\"\nts = timedelta(seconds=1)\ntau = timedelta(seconds=60)\n\nprovider = 'archive/local'\nmag_dataset = \"WI_H4-RTN_MFI\"\nmag_parameters = [\"BRTN\"]\nplasma_dataset = \"WI_K0_SWE\"\nplasma_parameters= [\"Np\", \"V_GSM\", \"THERMAL_SPD\"]\n\nfmt = 'arrow'\nfname = f\"../../data/05_reporting/events.{mission}.ts_{ts.total_seconds():.2f}s_tau_60s.{fmt}\"\n\n\nmag_vars = Variables(\n    provider = provider,\n    dataset=mag_dataset,\n    parameters=mag_parameters,\n    timerange=timerange,\n).retrieve_data()\n\n\nmag_vars.time_resolutions\n\n\nshape: (8, 2)\n\n\n\nstatistic\nvalue\n\n\nstr\nstr\n\n\n\n\n\"count\"\n\"6053744\"\n\n\n\"null_count\"\n\"1\"\n\n\n\"mean\"\n\"0:00:00.092974…\n\n\n\"min\"\n\"0:00:00.091000…\n\n\n\"25%\"\n\"0:00:00.092000…\n\n\n\"50%\"\n\"0:00:00.092000…\n\n\n\"75%\"\n\"0:00:00.092000…\n\n\n\"max\"\n\"0:04:36.092000…\n\n\n\n\n\n\n\nplasma_vars = Variables(\n    provider = provider,\n    dataset=plasma_dataset,\n    parameters=plasma_parameters,\n    timerange=timerange,\n).retrieve_data()\n\n\ndef get_and_process_data(\n    mag_dataset, mag_parameters, plasma_dataset, plasma_parameters, timerange, tau, ts, provider\n):\n    # define variables\n    mag_vars = Variables(\n        provider = provider,\n        dataset=mag_dataset,\n        parameters=mag_parameters,\n        timerange=timerange,\n    ).retrieve_data()\n\n    plasma_vars = Variables(\n        provider = provider,\n        dataset=plasma_dataset,\n        parameters=plasma_parameters,\n        timerange=timerange,\n    ).retrieve_data()\n\n    # get column names\n    bcols = mag_vars.data[0].columns\n    density_col = plasma_vars.data[0].columns[0]\n    vec_cols = plasma_vars.data[1].columns\n    temperature_col = plasma_vars.data[2].columns[0]\n\n    # get data\n    mag_data = mag_vars.to_polars()\n    plasma_data = (\n        plasma_vars.to_polars()\n        .with_columns(plasma_speed=pl_norm(vec_cols))\n        .rename({density_col: \"plasma_density\"})\n    )\n    # process temperature data\n    if plasma_vars.data[2].unit == \"km/s\":\n        plasma_data = plasma_data.pipe(df_thermal_spd2temp, temperature_col)\n    else:\n        plasma_data = plasma_data.rename({temperature_col: \"plasma_temperature\"})\n\n    return IDsDataset(\n        mag_data=mag_data.pipe(resample, every=ts),\n        plasma_data=plasma_data,\n        tau=tau,\n        ts=ts,\n        bcols=bcols,\n        vec_cols=vec_cols,\n        density_col=\"plasma_density\",\n        speed_col=\"plasma_speed\",\n        temperature_col=\"plasma_temperature\",\n    ).find_events(return_best_fit=False).update_candidates_with_plasma_data()\n\n\nids : list[pl.DataFrame] = []\nfor _tr in tqdm(TimeRange(timerange).split(8)):\n    \n    _timerange = [_tr.start.value, _tr.end.value]\n    _id = get_and_process_data(\n        mag_dataset, mag_parameters, plasma_dataset, plasma_parameters, _timerange, tau, ts,\n        provider = provider\n    )\n    ids.append(_id.events)\n\n  0%|          | 0/8 [00:00&lt;?, ?it/s]15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:40: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n15-Feb-24 13:44:41: Non compliant ISTP file: No data variable found, this is suspicious\n  0%|          | 0/8 [00:00&lt;?, ?it/s]\n\n\nAttributeError: 'NoneType' object has no attribute 'columns'",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/index.html#solar-wind-pipeline",
    "href": "notebooks/missions/themis/index.html#solar-wind-pipeline",
    "title": "IDs from ARTHEMIS",
    "section": "Solar wind pipeline",
    "text": "Solar wind pipeline\n::: {#cell-11 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\nfrom discontinuitypy.utils.basic import filter_tranges_df\n\ndef filter_sw_events(events: pl.LazyFrame, sw_state: pl.LazyFrame) -&gt; pl.LazyFrame:\n    \n    start, end = sw_state.select(['start', 'end']).collect()\n    sw_events = filter_tranges_df(events.collect(), (start, end))\n    \n    return sw_events\n\ndef create_sw_events_pipeline(\n    sat_id,\n    tau: int = 60,\n    ts_mag: int = 1,\n    \n):\n  \n    ts_mag_str = f\"ts_{ts_mag}s\"\n    tau_str = f\"tau_{tau}s\"\n    \n    node_filter_sw_events = node(\n        filter_sw_events,\n        inputs=[\n            f\"events.{sat_id}_{ts_mag_str}_{tau_str}\",\n            f\"{sat_id}.STATE.inter_data_sw\",\n        ],\n        outputs=f\"events.{sat_id}_sw_{ts_mag_str}_{tau_str}\"\n        \n    )\n\n    nodes = [node_filter_sw_events]\n    return pipeline(nodes)\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS"
    ]
  },
  {
    "objectID": "notebooks/missions/themis/index.html#pipelines",
    "href": "notebooks/missions/themis/index.html#pipelines",
    "title": "IDs from ARTHEMIS",
    "section": "Pipelines",
    "text": "Pipelines\n::: {#cell-13 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef create_pipeline(\n    sat_id=\"THB\",\n    params: Optional[dict] = None,\n):\n    \n    if params is None:\n        params = PARAMS\n    tau = params[\"tau\"]\n    ts_state = params[sat_id][\"STATE\"].get(\"time_resolution\", 0)\n    ts_mag = params[sat_id][\"MAG\"].get(\"time_resolution\", 0)\n    ts_state_str = f\"ts_{ts_state}s\"\n\n\n    input_combined_data = {\n        f\"{sat_id}.STATE.primary_data_{ts_state_str}\": f\"OMNI.LowRes.primary_data_{ts_state_str}\"\n    }\n    \n    node_combined_data = pipeline(\n        create_combined_data_pipeline(sat_id),\n        inputs=input_combined_data,\n    )\n\n    return (\n        create_mag_data_pipeline(sat_id)\n        + create_state_data_pipeline(sat_id)\n        + node_combined_data\n        + create_sw_events_pipeline(sat_id, tau=tau, ts_mag=ts_mag)\n    )\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from ARTHEMIS"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/state.html",
    "href": "notebooks/missions/juno/state.html",
    "title": "JUNO State data pipeline",
    "section": "",
    "text": "JUNO state data is composed of two parts: the plasma data from MHD model and 1h-average magnetic field data from FGM, which providing background interplanetary magnetic field (IMF) information.\n::: {#cell-1 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\n:::\n::: {#cell-2 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ 4=’\n’ 5=‘d’ 6=‘e’ 7=‘f’ 8=‘a’ 9=‘u’ 10=‘l’ 11=‘t’ 12=’_’ 13=‘e’ 14=‘x’ 15=‘p’ 16=’ ’ 17=‘p’ 18=‘i’ 19=‘p’ 20=‘e’ 21=‘l’ 22=‘i’ 23=‘n’ 24=‘e’ 25=‘s’ 26=‘/’ 27=‘j’ 28=‘u’ 29=‘n’ 30=‘o’ 31=‘/’ 32=‘s’ 33=‘t’ 34=‘a’ 35=‘t’ 36=‘e’}\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/state.html#getting-background-magnetic-field",
    "href": "notebooks/missions/juno/state.html#getting-background-magnetic-field",
    "title": "JUNO State data pipeline",
    "section": "Getting background magnetic field",
    "text": "Getting background magnetic field\n::: {#cell-4 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef process_IMF_data(\n    raw_data: Dict[str, Callable[..., pl.LazyFrame]],\n    ts: str = 3600,  # time resolution\n) -&gt; pl.DataFrame | dict[str, pl.DataFrame]:\n    \"\"\"\n    Resampling data to provide background magnetic field\n    \"\"\"\n\n    every = timedelta(seconds=ts)\n    period = every\n    offset = every / 2\n\n    data = pl.concat(\n        resample(func(), every=every, period=period, offset=offset)\n        for func in raw_data.values()\n    )\n\n    name_mapping = {\n        \"BX SE\": \"B_background_x\",\n        \"BY SE\": \"B_background_y\",\n        \"BZ SE\": \"B_background_z\",\n    }\n\n    return data.unique(\"time\").sort(\"time\").rename(name_mapping)\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/state.html#loading-data",
    "href": "notebooks/missions/juno/state.html#loading-data",
    "title": "JUNO State data pipeline",
    "section": "Loading data",
    "text": "Loading data\nFor interpolated solar wind at JUNO’s location, see model output file.\n::: {#cell-6 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef load_data(\n    raw_data: pd.DataFrame,\n    start: str,\n    end: str,\n) -&gt; pl.LazyFrame:\n    return pl.from_pandas(raw_data).lazy()\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/state.html#preprocessing-data",
    "href": "notebooks/missions/juno/state.html#preprocessing-data",
    "title": "JUNO State data pipeline",
    "section": "Preprocessing data",
    "text": "Preprocessing data\nCoordinate System:  HGI\nVariables:\n  Date_Time: date and time in ISO format [UT]\n  hour: elapsed time since trajectory start [hr]\n  r: radial coordinate in HGI [AU]\n  phi: longitude coordinate in HGI [deg]\n  Rho: density [amu/cm^3]\n  Ux, Uy, Uz: bulk velocity components in HGI [km/s]\n  Bx, By, Bz: magnetic field components in HGI [nT]\n  Ti: ion temperature [K]\n::: {#cell-8 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef preprocess_data(\n    raw_data: pl.LazyFrame,\n):\n    \"\"\"\n    Preprocess the raw dataset (only minor transformations)\n\n    - Parsing and typing data (like from string to datetime for time columns)\n    - Changing storing format (like from `csv` to `parquet`)\n    \"\"\"\n    df = (\n        raw_data\n        .with_columns(\n            time=pl.col(\"Date_Time\").str.to_datetime(),\n        )\n        .sort(\"time\")\n        .drop([\"Date_Time\", \"hour\"])\n    )\n    return df\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/state.html#processing-data",
    "href": "notebooks/missions/juno/state.html#processing-data",
    "title": "JUNO State data pipeline",
    "section": "Processing data",
    "text": "Processing data\nCombining plasma data and background magnetic field\n::: {#cell-10 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\nbcols_hgi = [\"bx\", \"by\", \"bz\"]\nbcols_rtn = [\"b_r\", \"b_t\", \"b_n\"]\nvcols_hgi = [\"ux\", \"uy\", \"uz\"]\nvcols_rtn = [\"v_r\", \"v_t\", \"v_n\"]\n\n\ndef hgi2rtn(df: pl.LazyFrame | pl.DataFrame):\n    \"\"\"Transform coordinates from HGI to RTN\"\"\"\n\n    phi_rad = pl.col(\"phi_rad\")\n    ux = pl.col(\"ux\")\n    uy = pl.col(\"uy\")\n    uz = pl.col(\"uz\")\n    result = (\n        df.with_columns(\n            phi_rad=pl.col(\"phi\").radians(),\n        )\n        .with_columns(\n            b_r=pl.col(\"bx\") * phi_rad.cos() + pl.col(\"by\") * phi_rad.sin(),\n            b_t=-pl.col(\"bx\") * phi_rad.sin() + pl.col(\"by\") * phi_rad.cos(),\n            b_n=pl.col(\"bz\"),\n            v_r=ux * phi_rad.cos() + uy * phi_rad.sin(),\n            v_t=-ux * phi_rad.sin() + uy * phi_rad.cos(),\n            v_n=uz,\n            plasma_speed=(ux**2 + uy**2 + uz**2).sqrt(),\n        )\n        .drop([\"phi\", \"phi_rad\"] + bcols_hgi + vcols_hgi)\n    )\n    return result\n:::\n::: {#cell-11 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef process_data(\n    model_data: pl.LazyFrame,\n    imf_data: pl.LazyFrame,\n) -&gt; pl.DataFrame:\n    \"\"\"\n    Corresponding to primary data layer, where source data models are transformed into domain data models\n\n    - Transforming data to RTN (Radial-Tangential-Normal) coordinate system\n    - Applying naming conventions for columns\n    \"\"\"\n\n    columns_name_mapping = {\n        \"r\": \"radial_distance\",\n        \"v_r\": \"v_x\",\n        \"v_t\": \"v_y\",\n        \"v_n\": \"v_z\",\n        \"b_r\": \"model_b_r\",\n        \"b_n\": \"model_b_n\",\n        \"b_t\": \"model_b_t\",\n        \"Ti\": \"plasma_temperature\",\n        \"rho\": \"plasma_density\",\n    }\n\n    return model_data.pipe(hgi2rtn).rename(columns_name_mapping).join(imf_data, on=\"time\")\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/state.html#pipeline",
    "href": "notebooks/missions/juno/state.html#pipeline",
    "title": "JUNO State data pipeline",
    "section": "Pipeline",
    "text": "Pipeline\n::: {#cell-13 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef create_IMF_pipeline():\n    node_process_IMF_data = node(\n        process_IMF_data,\n        inputs=\"JNO.MAG.inter_data_1SEC\",\n        outputs=\"JNO.STATE.IMF_data\",\n    )\n\n    return pipeline([node_process_IMF_data])\n:::\n::: {#cell-14 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\nload_inputs = dict(\n    raw_data=\"model_data\",\n    start=\"params:start_date\", # necessary for the pipeline to work\n    end=\"params:end_date\",\n)\n\nprocess_inputs = dict(\n    model_data=\"inter_data_hourly\",\n    imf_data=\"IMF_data\",\n)\n\ndef create_pipeline(sat_id=\"JNO\", source=\"STATE\"):\n    return create_IMF_pipeline() + create_pipeline_template(\n        sat_id=sat_id,\n        source=source,\n        load_data_fn=load_data,\n        preprocess_data_fn=preprocess_data,\n        process_data_fn=process_data,\n        load_inputs=load_inputs,\n        process_inputs=process_inputs,\n    )\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno",
      "JUNO State data pipeline"
    ]
  },
  {
    "objectID": "notebooks/missions/omni/index.html",
    "href": "notebooks/missions/omni/index.html",
    "title": "OMNI data",
    "section": "",
    "text": "Reference:\nNotes:\n::: {#cell-2 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’ execution_count=1}\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "OMNI data"
    ]
  },
  {
    "objectID": "notebooks/missions/omni/index.html#setup",
    "href": "notebooks/missions/omni/index.html#setup",
    "title": "OMNI data",
    "section": "Setup",
    "text": "Setup\nNeed to run command in shell first as pipeline is project-specific command\nkedro pipeline create omni",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "OMNI data"
    ]
  },
  {
    "objectID": "notebooks/missions/omni/index.html#downloading-data",
    "href": "notebooks/missions/omni/index.html#downloading-data",
    "title": "OMNI data",
    "section": "Downloading data",
    "text": "Downloading data\n::: {#cell-7 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef download_data(\n    start,\n    end,\n    datatype,\n):\n    import pyspedas\n\n    trange = [start, end]\n    files = pyspedas.omni.data(trange=trange, datatype=datatype, downloadonly=True)\n    return files\n\n\ndef load_data(\n    start,\n    end,\n    datatype=\"hourly\",\n    vars: dict = OMNI_VARS,\n) -&gt; pl.LazyFrame:\n    files = download_data(start, end, datatype=datatype)\n    df: pl.LazyFrame = pl.concat(files | pmap(cdf2pl, var_names=list(vars)))\n    return df\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "OMNI data"
    ]
  },
  {
    "objectID": "notebooks/missions/omni/index.html#preprocessing-data",
    "href": "notebooks/missions/omni/index.html#preprocessing-data",
    "title": "OMNI data",
    "section": "Preprocessing data",
    "text": "Preprocessing data\n::: {#cell-9 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef preprocess_data(\n    raw_data: pl.LazyFrame,\n    vars: dict = OMNI_VARS,\n) -&gt; pl.LazyFrame:\n    \"\"\"\n    Preprocess the raw dataset (only minor transformations)\n\n    - Applying naming conventions for columns\n    - Extracting variables from `CDF` files, and convert them to DataFrame\n    \"\"\"\n\n    columns_name_mapping = {key: value[\"COLNAME\"] for key, value in vars.items()}\n\n    return raw_data.rename(columns_name_mapping)\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "OMNI data"
    ]
  },
  {
    "objectID": "notebooks/missions/omni/index.html#processing-data",
    "href": "notebooks/missions/omni/index.html#processing-data",
    "title": "OMNI data",
    "section": "Processing data",
    "text": "Processing data\n::: {#cell-11 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}\ndef flow2gse(df: pl.LazyFrame) -&gt; pl.LazyFrame:\n    \"\"\"\n    - Transforming solar wind data from `Quasi-GSE` coordinate to GSE coordinate system\n    \"\"\"\n    plasma_speed = pl.col(\"plasma_speed\")\n    sw_theta = pl.col(\"sw_vel_theta\")\n    sw_phi = pl.col(\"sw_vel_phi\")\n\n    return df.with_columns(\n        sw_vel_gse_x=-plasma_speed * sw_theta.cos() * sw_phi.cos(),\n        sw_vel_gse_y=+plasma_speed * sw_theta.cos() * sw_phi.sin(),\n        sw_vel_gse_z=+plasma_speed * sw_theta.sin(),\n    ).drop([\"sw_theta\", \"sw_phi\"])\n\ndef process_data(\n    raw_data: pl.LazyFrame,\n    ts=None,  # time resolution\n) -&gt; pl.LazyFrame:\n    \"\"\"\n    - Transforming data to GSE coordinate system\n    \"\"\"\n\n    return raw_data.pipe(flow2gse).rename(\n        {\n            \"sw_vel_gse_x\": \"v_x\",\n            \"sw_vel_gse_y\": \"v_y\",\n            \"sw_vel_gse_z\": \"v_z\",\n        }\n    )\n:::",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "OMNI data"
    ]
  },
  {
    "objectID": "notebooks/missions/omni/index.html#pipelines",
    "href": "notebooks/missions/omni/index.html#pipelines",
    "title": "OMNI data",
    "section": "Pipelines",
    "text": "Pipelines\n\n# # | export\n# def create_pipeline(sat_id=\"OMNI\", source=\"LowRes\"):\n\n#     return create_pipeline_template(\n#         sat_id=sat_id,\n#         source=source,\n#         load_data_fn=load_data,\n#         preprocess_data_fn=preprocess_data,\n#         process_data_fn=process_data,\n#     )",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "OMNI data"
    ]
  },
  {
    "objectID": "notebooks/11_ts_analysis.html",
    "href": "notebooks/11_ts_analysis.html",
    "title": "Time resolution effect Analysis",
    "section": "",
    "text": "import polars as pl\nimport polars.selectors as cs\n\n::: {#cell-2 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=2}\nfrom beforerr.r import py2rpy_polars\nimport rpy2.robjects as robjects\n\n%load_ext rpy2.ipython\n\nr = robjects.r\nr.source('utils.R')\n\nconv_pl = py2rpy_polars()\n\nR[write to console]: \nAttaching package: ‘dplyr’\n\n\nR[write to console]: The following objects are masked from ‘package:stats’:\n\n    filter, lag\n\n\nR[write to console]: The following objects are masked from ‘package:base’:\n\n    intersect, setdiff, setequal, union\n\n\nR[write to console]: \nAttaching package: ‘scales’\n\n\nR[write to console]: The following object is masked from ‘package:purrr’:\n\n    discard\n\n\n\n:::\n\nts = 1.00 # unit: seconds\ntau = 60 # unit: seconds\ndata_dir = \"../data\"\nformat = \"arrow\"\n\n\nparameters = ['j0_k', 'j0_k_norm', 'L_k', 'L_k_norm']\n\njuno_fit = pl.read_ipc(f\"{data_dir}/05_reporting/events.JNO.fit.ts_{ts:.2f}s_tau_{tau}s.arrow\").with_columns(\n    pl.col(parameters).abs(),\n).with_columns(cs.numeric().cast(pl.Float64)).drop_nulls().filter(\n    pl.col(\"d_star\") &lt; 100,  # exclude extreme values\n    pl.col('j0_k') &lt; 100\n).with_columns(pl.col('count').cast(pl.UInt32)).lazy()\n\nColumnNotFoundError: count\n\nError originated just after this operation:\nDF [\"time\", \"tstart\", \"tstop\", \"t.d_end\"]; PROJECT */92 COLUMNS; SELECTION: \"None\"\n\n\n\nparameters = ['j0', 'j0_norm', 'j0_k', 'j0_k_norm', 'L_mn', 'L_k', 'L_mn_norm', 'L_k_norm']\n\nwind_fit = pl.read_ipc(f\"{data_dir}/05_reporting/events.Wind.ts_{ts}s_tau_{tau}s.arrow\").with_columns(\n    pl.col(parameters).abs(),\n).with_columns(cs.numeric().cast(pl.Float64)).drop_nulls().filter(\n    pl.col(\"d_star\") &lt; 100,  # exclude extreme values\n    pl.col('j0') &lt; 100\n).with_columns(pl.col('count').cast(pl.UInt32)).lazy()\n\nFileNotFoundError: No such file or directory (os error 2): ../data/05_reporting/events.Wind.ts_1.0s_tau_60s.arrow\n\n\n\ndef load_events(name: str, ts: float, tau: float, method ='derivative') -&gt; pl.DataFrame:\n    if method == 'derivative':\n        format = 'parquet'\n        filepath = f\"{data_dir}/08_reporting/events/l1/{name}_ts_{ts}s_tau_{tau}s.{format}\"\n        df = pl.scan_parquet(filepath)\n    elif method == 'fit':\n        format = 'arrow'\n        filepath = f\"{data_dir}/05_reporting/events.{name}.ts_{ts:.2f}s_tau_{tau}s.{format}\"\n        df = pl.read_ipc(filepath).lazy()\n    return df.with_columns(\n        pl.col(parameters).abs(),\n        sat = pl.lit(name),\n        ts = pl.lit(f'{ts}s'),\n        method = pl.lit(method),\n        ts_method = pl.lit(f'{ts}s {method}'),\n        label = pl.lit(f'{name} {ts}s {method}')\n    ).with_columns(cs.numeric().cast(pl.Float64))\n\n\nwind_ts_009_all = load_events('Wind', 0.09, 60)\nwind_ts_01_all = load_events('Wind', 0.1, 60)\nwind_ts_02_all = load_events('Wind', 0.2, 60)\nwind_ts_05_all = load_events('Wind', 0.5, 60)\nwind_ts_1_all = load_events('Wind', 1, 60)\n\njuno_ts_1_all = load_events('JNO', 1, 60)\njuno_ts_1_fit = load_events('JNO', 1, 60, method='fit')\n\n\nwind_ts_01_fit = load_events('Wind', 0.09, 60, method='fit')\nwind_ts_02_fit = load_events('Wind', 0.2, 60, method='fit')\nwind_ts_05_fit = load_events('Wind', 0.5, 60, method='fit')\nwind_ts_1_fit = load_events('Wind', 1, 60, method='fit')\nwind_ts_2_fit = load_events('Wind', 2, 60, method='fit')\n\nwind_fit_dfs = [wind_ts_01_fit, wind_ts_02_fit, wind_ts_05_fit, wind_ts_1_fit, wind_ts_2_fit]\n\n\nwind_ts_01_fit\n\nnaive plan: (run LazyFrame.explain(optimized=True) to see the optimized plan)\n    \n     WITH_COLUMNS: [col(\"count\").strict_cast(Float64), col(\"B_std\").strict_cast(Float64), col(\"B_mean\").strict_cast(Float64), col(\"dB_vec\").strict_cast(Float64), col(\"index_diff\").strict_cast(Float64), col(\"index_std\").strict_cast(Float64), col(\"index_fluctuation\").strict_cast(Float64), col(\"B.after\").strict_cast(Float64), col(\"B.before\").strict_cast(Float64), col(\"b_mag\").strict_cast(Float64), col(\"b_n\").strict_cast(Float64), col(\"bn_over_b\").strict_cast(Float64), col(\"d_star\").strict_cast(Float64), col(\"db_mag\").strict_cast(Float64), col(\"db_over_b\").strict_cast(Float64), col(\"db_over_b_max\").strict_cast(Float64), col(\"fit.stat.chisqr\").strict_cast(Float64), col(\"fit.stat.rsquared\").strict_cast(Float64), col(\"fit.vars.amplitude\").strict_cast(Float64), col(\"fit.vars.c\").strict_cast(Float64), col(\"fit.vars.sigma\").strict_cast(Float64), col(\"rotation_angle\").strict_cast(Float64), col(\"dB_x\").strict_cast(Float64), col(\"dB_y\").strict_cast(Float64), col(\"dB_z\").strict_cast(Float64), col(\"dB_lmn_x\").strict_cast(Float64), col(\"dB_lmn_y\").strict_cast(Float64), col(\"dB_lmn_z\").strict_cast(Float64), col(\"k_x\").strict_cast(Float64), col(\"k_y\").strict_cast(Float64), col(\"k_z\").strict_cast(Float64), col(\"Vl_x\").strict_cast(Float64), col(\"Vl_y\").strict_cast(Float64), col(\"Vl_z\").strict_cast(Float64), col(\"Vn_x\").strict_cast(Float64), col(\"Vn_y\").strict_cast(Float64), col(\"Vn_z\").strict_cast(Float64), col(\"plasma_density\").strict_cast(Float64), col(\"VX (GSM)\").strict_cast(Float64), col(\"VY (GSM)\").strict_cast(Float64), col(\"VZ (GSM)\").strict_cast(Float64), col(\"SW Vth\").strict_cast(Float64), col(\"plasma_speed\").strict_cast(Float64), col(\"plasma_temperature\").strict_cast(Float64), col(\"n.before\").strict_cast(Float64), col(\"T.before\").strict_cast(Float64), col(\"v.ion.before\").strict_cast(Float64), col(\"n.after\").strict_cast(Float64), col(\"T.after\").strict_cast(Float64), col(\"v.ion.after\").strict_cast(Float64), col(\"v_l\").strict_cast(Float64), col(\"v_n\").strict_cast(Float64), col(\"v_k\").strict_cast(Float64), col(\"v_mn\").strict_cast(Float64), col(\"L_n\").strict_cast(Float64), col(\"L_mn\").strict_cast(Float64), col(\"L_k\").strict_cast(Float64), col(\"j0\").strict_cast(Float64), col(\"j0_k\").strict_cast(Float64), col(\"ion_inertial_length\").strict_cast(Float64), col(\"Alfven_speed\").strict_cast(Float64), col(\"j_Alfven\").strict_cast(Float64), col(\"L_n_norm\").strict_cast(Float64), col(\"L_mn_norm\").strict_cast(Float64), col(\"L_k_norm\").strict_cast(Float64), col(\"j0_norm\").strict_cast(Float64), col(\"j0_k_norm\").strict_cast(Float64), col(\"v.Alfven.before\").strict_cast(Float64), col(\"v.Alfven.after\").strict_cast(Float64), col(\"n.change\").strict_cast(Float64), col(\"v.ion.change\").strict_cast(Float64), col(\"T.change\").strict_cast(Float64), col(\"B.change\").strict_cast(Float64), col(\"v.Alfven.change\").strict_cast(Float64)]   WITH_COLUMNS:   [col(\"j0\").abs(), col(\"j0_norm\").abs(), col(\"j0_k\").abs(), col(\"j0_k_norm\").abs(), col(\"L_mn\").abs(), col(\"L_k\").abs(), col(\"L_mn_norm\").abs(), col(\"L_k_norm\").abs(), String(Wind).alias(\"sat\"), String(0.09s).alias(\"ts\"), String(fit).alias(\"method\"), String(0.09s fit).alias(\"ts_method\"), String(Wind 0.09s fit).alias(\"label\")]    DF [\"time\", \"tstart\", \"tstop\", \"d_tstart\"]; PROJECT */83 COLUMNS; SELECTION: \"None\"\n\n\n\ntime_filter = pl.col('time').dt.year()==2016\ndfs = [juno_ts_1_all, wind_ts_1_all, juno_ts_1_fit, wind_ts_009_all, wind_ts_01_all, wind_ts_02_all, wind_ts_05_all] + wind_fit_dfs\n\ndf = pl.concat([_.filter(time_filter) for _ in dfs], how='diagonal').collect()\n%R -i df -c conv_pl\n\n\n%%R\nfilename &lt;- \"ts_effect\"\nfilename &lt;- \"ts_effect_new\"\n\n\n%%R\n# sort color with 'JUNO 1s' first\nplot_ts_effect &lt;- function(df, labels=NULL, color =\"label\", L_mn_norm_lim = c(0,60), j_norm_lim = c(0,0.8), legend_title = NULL) {\n\n  # if labels is not null, select df with labels and reorder labels\n  if (!is.null(labels)){\n    df &lt;- df %&gt;%\n      filter(label %in% labels) %&gt;%\n      mutate(label = factor(label, levels = labels))\n  }\n\n  \n  add &lt;- \"mean\" # this seems to be computed before the limits are set\n  add &lt;- NULL\n  \n  common_custom &lt;- scale_color_okabeito(palette = \"black_first\")\n\n  x &lt;- \"L_mn\"\n  x_lim &lt;- c(0,7500)\n  p1 &lt;- ggdensity(df, x = x, color = color, add = add, alpha = 0) + xlim(x_lim) + common_custom\n\n  x &lt;- \"L_mn_norm\"\n  x_lab &lt;- expression(paste(\"Normalized Thickness (\", d[i], \")\"))\n  p2 &lt;- ggdensity(df, x = x, color = color, add = add, alpha = 0) + xlim(L_mn_norm_lim) + common_custom + labs(x=x_lab)\n\n  x &lt;- \"j0\"\n  x_lim &lt;- c(0,20)\n  p3 &lt;- ggdensity(df, x = x, color = color, add = add, alpha = 0) + xlim(x_lim) + common_custom\n\n  x &lt;- \"j0_norm\"\n  x_lab &lt;- expression(paste(\"Normalized Current Intensity (\", J[A], \")\"))\n  p4 &lt;- ggdensity(df, x = x, color = color, add = add, alpha = 0) + xlim(j_norm_lim) + common_custom + labs(x=x_lab)\n\n\n  output &lt;- list(p2, p4)\n  # change the legend title for each plot\n  if (!is.null(legend_title)){\n    for (i in 1:length(output)){\n      output[[i]] &lt;- ggpar(output[[i]], legend.title = legend_title)\n    }\n  }\n\n  purrr::reduce(output, `+`) + plot_layout(guides = 'collect', nrow=2) &\n    theme(legend.position='top')\n}\n\n\n\n%%R\nfilename &lt;- \"ts_method/all\"\np &lt;- plot_ts_effect(df)\nsave_plot(filename)\np\n\nR[write to console]: In addition: \nR[write to console]: Warning messages:\n\nR[write to console]: 1: Removed 12428 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 2: Removed 1 rows containing missing values (`geom_vline()`). \n\nR[write to console]: 3: Removed 719 rows containing non-finite values (`stat_density()`). \n\n\n\n\n\n\n\n\n\n\n\n%%R\n# filter df with sat = 'Wind'\np1 &lt;- df %&gt;%\n  filter(sat == 'Wind') %&gt;%\n    plot_ts_effect(color = \"ts_method\")\n\nfilename &lt;- \"ts_method/wind\"\nsave_plot(filename)\n\np2 &lt;- df %&gt;%\n  filter(sat == 'JNO') %&gt;%\n    plot_ts_effect(color = \"ts_method\")\n    \nfilename &lt;- \"ts_method/juno\"\nsave_plot(filename)\n\np1 | p2\n\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\n\n\nR[write to console]: In addition: \nR[write to console]: Warning messages:\n\nR[write to console]: 1: Removed 12233 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 2: Removed 658 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 3: Removed 195 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 4: Removed 61 rows containing non-finite values (`stat_density()`). \n\n\n\nIn addition: Warning messages:\n1: Removed 12233 rows containing non-finite values (`stat_density()`). \n2: Removed 658 rows containing non-finite values (`stat_density()`). \n3: Removed 12233 rows containing non-finite values (`stat_density()`). \n4: Removed 658 rows containing non-finite values (`stat_density()`). \n5: Removed 195 rows containing non-finite values (`stat_density()`). \n6: Removed 61 rows containing non-finite values (`stat_density()`). \n7: Removed 195 rows containing non-finite values (`stat_density()`). \n8: Removed 61 rows containing non-finite values (`stat_density()`). \n\n\n\n\n\n\n\n\n\n\n%%R\np &lt;- df %&gt;%\n  filter(method == 'fit', sat == 'Wind') %&gt;%\n    plot_ts_effect(color = 'ts', L_mn_norm_lim = c(0,300), j_norm_lim = c(0,0.6), legend_title = \"time resolution\")\n\np &lt;- p + plot_annotation(title = \"Wind - Fit\")\n\nfilename &lt;- \"ts_method/wind_fit\"\nsave_plot(filename)\np\n\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\n\n\nR[write to console]: In addition: \nR[write to console]: Warning messages:\n\nR[write to console]: 1: Removed 4927 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 2: Removed 3013 rows containing non-finite values (`stat_density()`). \n\n\n\nIn addition: Warning messages:\n1: Removed 4927 rows containing non-finite values (`stat_density()`). \n2: Removed 3013 rows containing non-finite values (`stat_density()`). \n3: Removed 4927 rows containing non-finite values (`stat_density()`). \n4: Removed 3013 rows containing non-finite values (`stat_density()`). \n\n\n\n\n\n\n\n\n\n\n%%R\np1 &lt;- df %&gt;%\n  filter(method == 'derivative') %&gt;%\n    plot_ts_effect\n \nfilename &lt;- \"ts_method/derivative\"\nsave_plot(filename)\np1\n\np2 &lt;- df %&gt;%\n  filter(method == 'fit') %&gt;%\n    plot_ts_effect(L_mn_norm_lim = c(0,300), j_norm_lim = c(0,0.6))\n\nfilename &lt;- \"ts_method/fit\"\nsave_plot(filename)\np2\n\np1 | p2\n\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\n\n\nR[write to console]: In addition: \nR[write to console]: Warning messages:\n\nR[write to console]: 1: Removed 334 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 2: Removed 502 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 3: Removed 335 rows containing non-finite values (`stat_density()`). \n\nR[write to console]: 4: Removed 313 rows containing non-finite values (`stat_density()`). \n\n\n\nIn addition: Warning messages:\n1: Removed 334 rows containing non-finite values (`stat_density()`). \n2: Removed 502 rows containing non-finite values (`stat_density()`). \n3: Removed 334 rows containing non-finite values (`stat_density()`). \n4: Removed 502 rows containing non-finite values (`stat_density()`). \n5: Removed 335 rows containing non-finite values (`stat_density()`). \n6: Removed 313 rows containing non-finite values (`stat_density()`). \n7: Removed 335 rows containing non-finite values (`stat_density()`). \n8: Removed 313 rows containing non-finite values (`stat_density()`).",
    "crumbs": [
      "Home",
      "Notebooks",
      "Time resolution effect Analysis"
    ]
  },
  {
    "objectID": "notebooks/04_properties.html#plotting-in-r",
    "href": "notebooks/04_properties.html#plotting-in-r",
    "title": "SWD Properties",
    "section": "Plotting in R",
    "text": "Plotting in R\n\n%R -i jno_df -c conv_pl\n%R -i other_events -c conv_pl\n%R -i jno_df_tau_300 -c conv_pl\n%R -i jno_df_8hz -c conv_pl\n%R -i jno_df_8hz_tau_20 -c conv_pl\n%R -i jno_df_8hz_tau_20_der -c conv_pl\n\n\n%%R\np1title &lt;- \"a) Juno\"\np2title &lt;- \"b) ARTEMIS, STEREO and Wind\"\nx_lab_r &lt;- \"Radial Distance (AU)\"\nx_lab_t &lt;- \"Time\"\n\ny_lab_t &lt;- \"Time Duration (s)\"\ny_lab_L &lt;- \"Log Thickness (km)\"\ny_lab_L_norm &lt;- expression(Log~Thickness~(d[i]))\n\nlayout &lt;- plot_layout(ncol = 2, byrow = FALSE, guides = \"collect\")\n\n\n%%R -w 350 -h 350 -u mm\nadd_mode &lt;- TRUE\nx_bins &lt;- 5\ny_bins &lt;- 10\nlog_y &lt;- FALSE\ny_lim_duration &lt;- c(0.1, 60)\n\ny_col &lt;- \"duration\"\nylab &lt;- y_lab_t\n\nx_col &lt;- \"radial_distance\"\n\np &lt;- plot_binned_data(jno_df, x_col = x_col, y_col = y_col, x_bins = x_bins, y_bins = y_bins, y_lim = y_lim_duration, log_y = log_y, add_mode=add_mode)\np1 &lt;- p + labs(x = NULL, y= ylab) + ggtitle(\"a) Juno\")\n\np &lt;- plot_binned_data(jno_df_8hz, x_col = x_col, y_col = y_col, x_bins = x_bins, y_bins = y_bins, y_lim = y_lim_duration, log_y = log_y, add_mode=add_mode)\np2 &lt;- p + labs(x = NULL, y= ylab) + ggtitle(\"b) Juno High Time Resolution\")\n\ny_lim_duration &lt;- c(0.1, 300)\np &lt;- plot_binned_data(jno_df_tau_300, x_col = x_col, y_col = y_col, x_bins = x_bins, y_bins = y_bins, y_lim = y_lim_duration, log_y = log_y, add_mode=add_mode)\np3 &lt;- p + labs(x = NULL, y= ylab) + ggtitle(\"c) Juno Long Tau\")\n\ny_lim_duration &lt;- c(0.1, 20)\np &lt;- plot_binned_data(jno_df_8hz_tau_20, x_col = x_col, y_col = y_col, x_bins = x_bins, y_bins = y_bins, y_lim = y_lim_duration, log_y = log_y, add_mode=add_mode)\np4 &lt;- p + labs(x = NULL, y= ylab) + ggtitle(\"d) Juno Low Tau and High TS\")\n\n# p &lt;- (p1 + p2) + plot_layout(ncol = 1, guides = \"collect\") & scale_fill_viridis_c(limits = c(0.01, 0.20), name=\"pdf\")\np &lt;- p1 + p2 + p3 + p4 + layout \nsave_plot(\"new/duration/duration_dist_ts_comparison\")\np\n\nSaving 13.8 x 13.8 in image\nSaving 13.8 x 13.8 in image\n\n\n\n\n\n\n\n\n\n\n%%R -w 350 -h 350 -u mm\nadd_mode &lt;- TRUE\nx_bins &lt;- 5\ny_bins &lt;- 10\nlog_y &lt;- FALSE\ny_lim_duration &lt;- c(0.1, 10)\n\ny_col &lt;- \"duration\"\nylab &lt;- y_lab_t\n\nx_col &lt;- \"radial_distance\"\n\np &lt;- plot_binned_data(jno_df_8hz_tau_20_der, x_col = x_col, y_col = y_col, x_bins = x_bins, y_bins = y_bins, y_lim = y_lim_duration, log_y = log_y, add_mode=add_mode)\np1 &lt;- p + labs(x = NULL, y= ylab) + ggtitle(\"a) Juno Derivative Method\")\np1\n\n\n\n\n\n\n\n\n\n%%R -w 350 -h 350 -u mm\n\np &lt;- plot_current_comparison(jno_df, other_events, p1title=\"a) Juno\")\nsave_plot(\"new/current/current_k_dist\")\np\n\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nSaving 13.8 x 13.8 in image\nSaving 13.8 x 13.8 in image\n\n\n\n\n\n\n\n\n\n\n%%R -w 350 -h 350 -u mm\np &lt;- plot_current_comparison(jno_df_8hz_tau_20, other_events, p1title=\"a) Juno: High Time Resolution, Low Tau\")\nsave_plot(\"new/current/current_k_dist-8hz-tau_20\")\n\np &lt;- plot_current_comparison(jno_df_8hz, other_events, p1title=\"a) Juno: High Time Resolution\")\nsave_plot(\"new/current/current_k_dist-8hz\")\n\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nSaving 13.8 x 13.8 in image\nSaving 13.8 x 13.8 in image\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nSaving 13.8 x 13.8 in image\nSaving 13.8 x 13.8 in image\n\n\n\n%%R -w 350 -h 350 -u mm\n\np &lt;- plot_thickness_comparison(jno_df, other_events, p1title=\"a) Juno\")\nsave_plot(\"new/thickness/thickness_k_dist\")\np\n\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nSaving 13.8 x 13.8 in image\nSaving 13.8 x 13.8 in image\n\n\n\n\n\n\n\n\n\n\n%%R -w 350 -h 350 -u mm\n\np1 &lt;- plot_q_and_qnorm_r_l(\n    jno_df_8hz_tau_20_der,\n    y_lim1=c(100, 6000), \n    y_lim2=c(0.1,20)\n)\n\np2 &lt;- plot_q_and_qnorm_r_j0(\n    jno_df_8hz_tau_20_der,\n    y_lim1 = c(0.1, 50),\n    y_lim2 = c(0.02, 10)\n)\n\n(p1 |  p2) + plot_annotation(\n  title = 'Juno: 8Hz, Tau 20s, Derivative Method',\n  theme = theme(plot.title = element_text(size = 18))\n)\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\n%%R -w 350 -h 350 -u mm\n\np &lt;- plot_thickness_comparison(jno_df_8hz_tau_20, other_events, p1title=\"a) Juno: High Time Resolution, Low Tau\")\nsave_plot(\"new/thickness/thickness_k_dist-8hz-tau_20\")\n\np &lt;- plot_thickness_comparison(jno_df_8hz, other_events, p1title=\"a) Juno: High Time Resolution\")\nsave_plot(\"new/thickness/thickness_k_dist-8hz\")\n\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nSaving 13.8 x 13.8 in image\nSaving 13.8 x 13.8 in image\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nSaving 13.8 x 13.8 in image\nSaving 13.8 x 13.8 in image\n\n\n\n%%R\nx_col &lt;- \"radial_distance\"\nxlab &lt;- \"Radial Distance (AU)\"\n\ny_col &lt;- \"L_k_fit\"\nylab &lt;- \"Log Thickness (km)\"\ny_lim &lt;- c(100, 40000)\n# y_lim &lt;- NULL\np &lt;- plot_binned_data(jno_df, x_col = x_col, y_col = y_col, x_bins = 8, y_bins = 32, y_lim = y_lim, log_y = TRUE)\np &lt;- p + labs(x = xlab, y= ylab)\n# save_plot(\"new/thickness/thickness_k_fit_r_dist\")\n\ny_col &lt;- \"L_k_fit_norm\"\ny_lim &lt;- c(0.2, 100)\n# y_lim &lt;- NULL\nylab &lt;- expression(Log~Thickness~(d[i]))\np &lt;- plot_binned_data(jno_df, x_col = x_col, y_col = y_col, x_bins = 8, y_bins = 32, y_lim = y_lim, log_y = TRUE)\np &lt;- p + labs(x = xlab, y= ylab)\nsave_plot(\"new/thickness/thickness_k_fit_N1_r_dist\")\np\n\nSaving 6.67 x 6.67 in image\nSaving 6.67 x 6.67 in image\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1:",
    "crumbs": [
      "Home",
      "Notebooks",
      "SWD Properties"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#check-the-discontinuity-in-juno-cruise-phase",
    "href": "notebooks/missions/juno/index.html#check-the-discontinuity-in-juno-cruise-phase",
    "title": "IDs from Juno",
    "section": "Check the discontinuity in Juno cruise phase",
    "text": "Check the discontinuity in Juno cruise phase\n\nFull time resolution data\n0.03 s - 0.125 s time resolution\n\nfrom space_analysis.missions.juno.fgm import download_data\nfrom discontinuitypy.utils.basic import resample\nfrom toolz import curry\nfrom pipe import select\nfrom fastcore.utils import mkdir\nimport os\n\n\ndef preprocess(\n    fp,\n    every = timedelta(seconds = 0.125),\n    dir_path = \"../../../data/02_intermediate/JNO_MAG_8hz\",\n    update = False\n):\n    fname = fp.split('/')[-1]\n    \n    output_path = f\"{dir_path}/{fname}\"\n    \n    if not os.path.exists(output_path) or update:\n        mkdir(dir_path, parents=True, exist_ok = True)\n        df = pl.scan_ipc(fp).sort('time').pipe(resample, every = every)\n        df.collect().write_ipc(output_path)\n    return output_path\n\n@curry\ndef process(fp, ids_dataset: IDsDataset, sparse_num = 10, **kwargs):\n    df = pl.scan_ipc(fp).sort('time').unique('time')\n\n    ids_dataset.data = df\n    \n    return ids_dataset.find_events(return_best_fit=False, sparse_num = sparse_num, **kwargs).update_candidates_with_plasma_data().events\n\n\nmag_paths = list(download_data(datatype=\"FULL\") | select(preprocess))\n\n\nmag_paths\n\n\nts = timedelta(seconds=0.125)\ntau = timedelta(seconds=20)\nmethod = \"derivative\"\n# method = \"fit\"\n\nfname = f'events.{mission}.{method}.ts_{ts.total_seconds():.2f}s_tau_{tau.seconds}s.{format}'\noutput_path = f'{data_dir}/05_reporting/{fname}'\nlogger.info(output_path)\n\n\nids_ds = IDsDataset(\n    plasma_data=plasma_data,\n    tau=tau,\n    ts=ts,\n    vec_cols=vec_cols,\n    density_col=\"plasma_density\",\n    speed_col=\"plasma_speed\",\n    temperature_col=\"plasma_temperature\",\n)\n\nReasonably splitting the data files may accelerate the processing.\n\nfps = split_list(mag_paths, n=100)\n\nfunc = process(ids_dataset = ids_ds, sparse_num = 10, method = method)\n\nids_ds.data = pl.scan_ipc(mag_paths)\nids_ds.events = pl.concat(fps | select(func)) \nids_ds.export(output_path)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/03_profiles.html",
    "href": "notebooks/03_profiles.html",
    "title": "",
    "section": "",
    "text": "::: {#cell-0 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=51}\n%load_ext autoreload\n%autoreload 2\n\nfrom discontinuitypy.datasets import IDsDataset\nfrom datetime import timedelta\nfrom utils import load_events\n:::\n\nmission = \"JNO\"\nts = timedelta(seconds=1)\ntau = timedelta(seconds=60)\n\n\ndata_dir = '../data'\ndir_path = f'{data_dir}/03_primary/JNO_MAG_ts_{ts.seconds}s'\njuno_state_path = f'{data_dir}/03_primary/JNO_STATE_ts_3600s.parquet'\nvec_cols = ['v_x', 'v_y', 'v_z']\n\nplasma_data = pl.scan_parquet(juno_state_path).sort('time')\n\n\nids_ds = IDsDataset(\n    plasma_data=plasma_data,\n    tau=tau,\n    ts=ts,\n    vec_cols=vec_cols,\n    density_col=\"plasma_density\",\n    speed_col=\"plasma_speed\",\n    temperature_col=\"plasma_temperature\",\n)\n\n\njno_df_8hz_tau_20 = load_events('JNO', 0.125, 20, 'derivative')\nids_ds.events = jno_df_8hz_tau_20.filter(pl.col('len')==160, pl.col('time')&lt;pl.datetime(2012,1,1), pl.col('index_d_diff')&gt;1)\n\n\nids_ds.events.columns\n\n['time',\n 'tstart',\n 'tstop',\n 't.d_end',\n 't.d_start',\n 't.d_time',\n 'index_diff',\n 'len',\n 'std',\n 'std_prev',\n 'std_next',\n 'index_std',\n 'index_fluctuation',\n 'd_star',\n 'B.after',\n 'B.before',\n 'b_mag',\n 'b_n',\n 'bn_over_b',\n 'db_mag',\n 'db_over_b',\n 'db_over_b_max',\n 'rotation_angle',\n 'dB_x',\n 'dB_y',\n 'dB_z',\n 'dB_lmn_x',\n 'dB_lmn_y',\n 'dB_lmn_z',\n 'k_x',\n 'k_y',\n 'k_z',\n 'Vl_x',\n 'Vl_y',\n 'Vl_z',\n 'Vn_x',\n 'Vn_y',\n 'Vn_z',\n 'duration',\n 'radial_distance',\n 'plasma_density',\n 'plasma_temperature',\n 'model_b_r',\n 'model_b_t',\n 'model_b_n',\n 'v_x',\n 'v_y',\n 'v_z',\n 'plasma_speed',\n 'B_background_x',\n 'B_background_y',\n 'B_background_z',\n 'v_x_before',\n 'v_y_before',\n 'v_z_before',\n 'n.before',\n 'v.ion.before',\n 'T.before',\n 'v_x_after',\n 'v_y_after',\n 'v_z_after',\n 'n.after',\n 'v.ion.after',\n 'T.after',\n 'v_l',\n 'v_n',\n 'v_k',\n 'v_mn',\n 'L_k',\n 'j0_k',\n 'ion_inertial_length',\n 'Alfven_speed',\n 'j_Alfven',\n 'L_k_norm',\n 'j0_k_norm',\n 'v.ion.before.l',\n 'v.ion.after.l',\n 'B.vec.before.l',\n 'B.vec.before.m',\n 'B.vec.before.n',\n 'B.vec.after.l',\n 'B.vec.after.m',\n 'B.vec.after.n',\n 'T.change',\n 'v.Alfven.before',\n 'v.Alfven.after',\n 'v.Alfven.before.l',\n 'v.Alfven.after.l',\n 'n.change',\n 'v.ion.change',\n 'v.ion.change.l',\n 'B.change',\n 'v.Alfven.change',\n 'v.Alfven.change.l',\n 'sat',\n 'ts',\n 'method',\n 'ts_method',\n 'label',\n 'index_d_diff']\n\n\n\nfrom space_analysis.missions.juno.fgm import download_data\n\nmag_paths = list(download_data(datatype=\"FULL\"))\n\nids_ds.data = pl.scan_ipc(mag_paths[:200]).set_sorted('time')\n\nids_ds.plot_candidates()\n\n2024-02-18 21:47:41.087 | INFO     | discontinuitypy.datasets:plot_candidates:215 - Candidates indices: [196 115 457 349]\n\n\n\n\n[(&lt;Figure size 1200x500 with 1 Axes&gt;, &lt;Axes: ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;, &lt;Axes: ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;, &lt;Axes: ylabel='$B$\\n[nT LMN]'&gt;),\n (&lt;Figure size 1200x500 with 1 Axes&gt;, &lt;Axes: ylabel='$B$\\n[nT LMN]'&gt;)]",
    "crumbs": [
      "Home",
      "Notebooks",
      "03 Profiles"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#standard-process",
    "href": "notebooks/missions/juno/index.html#standard-process",
    "title": "IDs from Juno",
    "section": "Standard Process",
    "text": "Standard Process\n\njuno_events = []\nfor mag_path in walk(dir_path):\n    mag_data = pl.scan_parquet(mag_path).drop('X', 'Y', 'Z').sort('time')\n\n    _juno_events = (\n        IDsDataset(\n            mag_data=mag_data,\n            plasma_data=plasma_data,\n            tau=tau,\n            ts=ts,\n            vec_cols=vec_cols,\n            density_col=\"plasma_density\",\n            speed_col=\"plasma_speed\",\n            temperature_col=\"plasma_temperature\",\n        )\n        .find_events(return_best_fit=False)\n        .update_candidates_with_plasma_data()\n        .events\n    )\n    \n    juno_events.append(_juno_events)\n    \njuno_ids_dataset = IDsDataset(\n    events=pl.concat(juno_events),\n    mag_data= pl.scan_parquet(list(walk(dir_path))).drop('X', 'Y', 'Z').sort('time')\n)\n\njuno_ids_dataset.export(output_path)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/missions/juno/index.html#superposed-epoch-analysis",
    "href": "notebooks/missions/juno/index.html#superposed-epoch-analysis",
    "title": "IDs from Juno",
    "section": "Superposed epoch analysis",
    "text": "Superposed epoch analysis\n\nfrom discontinuitypy.utils.basic import df2ts\nfrom discontinuitypy.core.pipeline import compress_data_by_interval\nfrom xarray_einstats import linalg\n\nfrom sea_norm import sean\nimport pandas as pd\nimport xarray as xr\nimport matplotlib.pyplot as plt\nfrom matplotlib.pyplot import Figure, Axes\n\nfrom discontinuitypy.integration import J_FACTOR\n\nfrom tqdm.auto import tqdm\n\ndef keep_good_fit(df: pl.DataFrame, rsquared = 0.95):\n    return df.filter(pl.col('fit.stat.rsquared') &gt; rsquared)\n\n\nfrom discontinuitypy.propeties.mva import minvar\nimport numpy as np\n\n\ndef get_dBdt_data(data: pl.LazyFrame):\n    \"\"\"\n    Calculate the time derivative of the magnetic field\n    \"\"\"\n    # TODO: compress data first by events, however, this will decrease the reliability of the derivative at the edges of the events\n    ts = df2ts(data)\n\n    vec_diff = ts.differentiate(\"time\", datetime_unit=\"s\")\n    vec_diff_mag: xr.DataArray = linalg.norm(vec_diff, dims=\"v_dim\")\n    return vec_diff_mag.to_dataframe(name=\"dBdt\")\n\n\ndef get_mva_data(\n    data: pl.LazyFrame,\n    starts: list,\n    ends: list,\n    columns=[\"B_l\", \"B_m\", \"B_n\"],\n    normalize=True,\n):\n    for start, end in tqdm(zip(starts, ends)):\n        event_data = data.filter(\n            pl.col(\"time\") &gt;= start, pl.col(\"time\") &lt;= end\n        ).collect()\n\n        event_numpy = event_data.drop(\"time\").to_numpy()  # Assuming this is efficient for your use case\n        time = event_data.get_column(\"time\").to_numpy()\n        \n        vrot, _, _ = minvar(event_numpy)\n        \n        if True:\n            vl = vrot[:, 0]\n            vl = vl * np.sign(vl[-1] - vl[0])\n            vl_ts = xr.DataArray(vl, dims=\"time\", coords={\"time\": time})\n            dvl_dt_df = vl_ts.differentiate(\"time\", datetime_unit=\"s\").to_dataframe(name=\"dBl_dt\")\n\n        if normalize:\n            vrot = normalize_mva_data(vrot)\n            vrot_df = pd.DataFrame(vrot, columns=columns, index=time)\n            \n        yield pd.concat([vrot_df, dvl_dt_df], axis=1)\n\n\ndef normalize_mva_data(\n    data: np.ndarray, shift=False  # shift the data in l direction to the origin\n):\n    \"\"\"\n    normalize the MVA data: Bl, Bm, and Bn were respectively normalized to B0 = 0.5ΔBl, Bm, and &lt;B&gt;\n    \"\"\"\n    vl, vm, vn = data.T\n\n    vl_norm_q = (vl[-1] - vl[0]) / 2\n    vm_norm_q = (vm[0] + vm[-1]) / 2\n    vn_norm_q = (vn[0] + vn[-1]) / 2\n\n    return np.array([vl / vl_norm_q, vm / vm_norm_q, vn / vn_norm_q]).T\n\n\ndef sea_ids(\n    ds: IDsDataset,\n    event_cols=[\"t.d_start\", \"t.d_time\", \"t.d_end\"],\n    sea_cols=[\n        \"B_l\",\n        \"j_m\",\n        \"j_m_norm\",\n        \"j_k\",\n        \"j_k_norm\",\n        \"B_m\",\n    ],\n    bins=[10, 10],\n    return_data=True,\n):\n    # converting to a list of numpy arrays\n\n    events = keep_good_fit(ds.events)\n\n    sea_events = [col.to_numpy() for col in events[event_cols]]\n\n    mag_data = ds.data\n    mag_data_c = compress_data_by_interval(\n        mag_data.collect(), sea_events[0], sea_events[2]\n    ).lazy()\n\n    # dBdt_data = get_dBdt_data(ds.data)\n    dBdt_data = get_dBdt_data(mag_data_c)\n    mva_data = pd.concat(get_mva_data(mag_data_c, sea_events[0], sea_events[2]))\n\n    b_data = dBdt_data.join(mva_data, on=\"time\")\n\n    p_data = (\n        events[[\"time\", \"v_k\", \"j_Alfven\"]].to_pandas().set_index(\"time\").sort_index()\n    )\n\n    data = pd.merge_asof(\n        b_data,\n        p_data,\n        left_index=True,\n        right_index=True,\n        direction=\"nearest\",\n    )\n\n    data = data.assign(\n        j_m=lambda df: df.dBl_dt / df.v_k * J_FACTOR,\n        j_m_norm =lambda df: df.j_m / df.j_Alfven,\n        j_k=lambda df: df.dBdt / df.v_k * J_FACTOR,\n        j_k_norm=lambda df: df.j_k / df.j_Alfven,\n    )\n\n    return sean(data, sea_events, bins, return_data=return_data, cols=sea_cols)\n\n\ndef plot_SEA(SEAarray: pd.DataFrame, meta) -&gt; tuple[Figure, list[Axes]]:\n    \n    cols = meta[\"sea_cols\"]\n    fig, axes = plt.subplots(nrows=len(cols), sharex=True, squeeze=True)\n\n    if len(cols) == 1:\n        axes = [axes]\n\n    # loop over columns that were analyzed\n    for c, ax in zip(cols, axes):\n        # for each column identify the column titles which\n        # have 'c' in the title and those that don't have\n        # 'cnt' in the title\n        # e.g. for AE columns\n        # AE_mean, AE_median, AE_lowq, AE_upq, AE_cnt\n        # fine columns AE_mean, AE_median, AE_lowq, AE_upq\n        # mask = SEAarray.columns.str.startswith(c) & ~SEAarray.columns.str.endswith(\"cnt\")\n        mask = [c + \"_mean\", c + \"_median\", c + \"_lowq\", c + \"_upq\"]\n\n        # plot the SEA data\n        SEAarray.loc[:, mask].plot(\n            ax=ax,\n            style=[\"r-\", \"b-\", \"b--\", \"b--\"],\n            xlabel=\"Normalized Time\",\n            ylabel=c.replace(\"_\", \" \"),\n            legend=False,\n        )\n\n    return fig, axes\n\ndef plot_ids_sea(SEAarray: pd.DataFrame, meta) -&gt; tuple[Figure, list[Axes]]:\n    import scienceplots\n    \n    SEAarray.index = SEAarray.index.map(lambda x: x / bin/2)\n\n    with plt.style.context(['science', 'nature', 'notebook']):\n\n        fig, axes = plot_SEA(SEAarray, meta)\n\n        axes[0].set_ylabel(r\"$B_x \\ / \\ B_0$\")\n        axes[1].set_ylabel(r\"$J_y$\")\n        axes[2].set_ylabel(r\"$J_y \\ / \\ J_A$\")\n        axes[3].set_ylabel(r\"$J_k$\")\n        axes[4].set_ylabel(r\"$J_k \\ / \\ J_A$\")\n        axes[5].set_ylabel(r\"$B_m \\ / \\ B_g$\")\n\n        fig.tight_layout()\n        fig.subplots_adjust(hspace=0)\n        \n        axes[0].legend(labels=[\"Mean\", \"Median\", \"LowQ\", \"UpQ\"])\n    return fig, axes\n    # fig.savefig(f\"../../../figures/sea/sea_juno_first_year_{freq}.png\", dpi = 300)\n\n\nFirst year\n\nmag_path = sorted(list(walk(dir_path)))[0]\ntau = timedelta(seconds=60)\nmag_data = pl.scan_parquet(mag_path).drop('X', 'Y', 'Z').sort('time')\n\nids_ds = (\n    IDsDataset(\n        mag_data=mag_data,\n        plasma_data=plasma_data,\n        tau=tau,\n        ts=ts,\n        vec_cols=vec_cols,\n        density_col=\"plasma_density\",\n        speed_col=\"plasma_speed\",\n        temperature_col=\"plasma_temperature\",\n    )\n    .find_events(return_best_fit=True)\n    .update_candidates_with_plasma_data()\n)\n\n\nmag_paths = list(download_data(datatype=\"FULL\") | select(preprocess))\n\n\n\n\nfreq = 'high'\n# freq = 'low'\nif freq == 'high': # use high dimensional data\n    ids_ds.data = pl.scan_ipc(mag_paths[0:365]).drop('X', 'Y', 'Z').sort('time')\n    bin = 16\nelse: # use low dimensional data\n    bin = 8\n\nSEAarray, meta, p1data, p2data = sea_ids(ids_ds, bins=[bin, bin])\n\n\nFigure 1\n\n\n\nids_ds.plot_candidates(num=20, plot_fit_data=True, predicates=(pl.col('fit.stat.rsquared') &gt; 0.95))\n\n\n\n\n\nLast year\n\n# mag_path = sorted(list(walk(dir_path)))[-1]\ntau = timedelta(seconds=300)\ntau = timedelta(seconds=60)\nmag_path = sorted(list(walk(dir_path)))[-1]\nmag_data = pl.scan_parquet(mag_path).drop('X', 'Y', 'Z').sort('time')\n\nids_ds = (\n    IDsDataset(\n        mag_data=mag_data,\n        plasma_data=plasma_data,\n        tau=tau,\n        ts=ts,\n        vec_cols=vec_cols,\n        density_col=\"plasma_density\",\n        speed_col=\"plasma_speed\",\n        temperature_col=\"plasma_temperature\",\n    )\n    .find_events(return_best_fit=True)\n    .update_candidates_with_plasma_data()\n)\n\n\nmag_paths = list(download_data(datatype=\"FULL\") | select(preprocess))\n\nfreq = 'high'\n# freq = 'low'\nif freq == 'high': # use high dimensional data\n    ids_ds.data = pl.scan_ipc(mag_paths[-365:]).drop('X', 'Y', 'Z').sort('time')\n    bin = 16\nelse: # use low dimensional data\n    bin = 8\n\nSEAarray, meta, p1data, p2data = sea_ids(ids_ds, bins=[bin, bin])\n\n\nfig, axes = plot_ids_sea(SEAarray, meta)\nfig.savefig(f\"../../../figures/sea/sea_juno_last_year_{freq}.png\", dpi = 300)\n\n\nSuperposed epoch analysis\n\ngroupby = 'index'\ncolumns = ['dBdt', 'j_k']\n\n# Plot each group\nfig, axes = plt.subplots(nrows=len(columns))\n\nif len(columns) == 1:\n    axes = [axes]\n\np1groups = p1data.groupby(groupby)\np2groups = p2data.groupby(groupby)\n\nfor ax, column in zip(axes, columns):\n    for name, group in p1groups:\n        ax.plot(group['t_norm'] -1 , group[column], color='grey', alpha=0.3)\n        \n    for name, group in p2groups:\n        ax.plot(group['t_norm'], group[column], color='grey', alpha=0.3)\n\n# plt.yscale('log')\nplt.show()\n\nids_ds.plot_candidates(num=20, plot_fit_data=True, predicates=(pl.col('fit.stat.rsquared') &gt; 0.95))",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from Juno"
    ]
  },
  {
    "objectID": "notebooks/missions/stereo/index.html",
    "href": "notebooks/missions/stereo/index.html",
    "title": "IDs from STEREO",
    "section": "",
    "text": "See following notebooks for details:\nSTEREO magnetic field is already in RTN coordinates, so no need to transform it.\nDownload data using pyspedas, but load it using pycdfpp (using pyspedas to load the data directly into xarray is very slow)\nNote STEREO-A plastic data file is “Non compliant ISTP file: No data variable found, this is suspicious”, -9.999999848243207e+30 instead of -1e+31 is used as fill value.\nimport speasy as spz\nfrom space_analysis.utils.speasy import Variables\nfrom space_analysis.io.cdf import cdf2pl\nfrom discontinuitypy.datasets import IDsDataset\nfrom beforerr.polars import pl_norm\nfrom discontinuitypy.utils.basic import resample\n\nfrom datetime import timedelta\nimport polars as pl\nimport polars.selectors as cs\n\nfrom sunpy.time import TimeRange\nimport pyspedas\n\nfrom tqdm import tqdm\n\n25-Feb-24 01:01:20: UserWarning: Traceback (most recent call last):\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 85, in &lt;module&gt;\n    from . import skintegrate\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/skintegrate.py\", line 20, in &lt;module&gt;\n    from sklearn.base import BaseEstimator\nModuleNotFoundError: No module named 'sklearn'\n\n\n25-Feb-24 01:01:20: UserWarning: pdpipe: Scikit-learn or skutil import failed. Scikit-learn-dependent pipeline stages will not be loaded.\n\n25-Feb-24 01:01:20: UserWarning: Traceback (most recent call last):\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 105, in &lt;module&gt;\n    from . import nltk_stages\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/nltk_stages.py\", line 19, in &lt;module&gt;\n    import nltk\nModuleNotFoundError: No module named 'nltk'\n\n\n25-Feb-24 01:01:20: UserWarning: pdpipe: nltk import failed. nltk-dependent  pipeline stages will not be loaded.\nimport speasy as spz\nentries = spz.core.cache.entries()\n# drop internal entries\nentries = list(filter(lambda e: '__internal__' not in e, entries))\nprint(entries[::-1])\n\n['cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-12T00:00:00+00:00', 'cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-11T12:00:00+00:00', 'cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-11T00:00:00+00:00', 'cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-10T12:00:00+00:00', 'cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-10T00:00:00+00:00', 'cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-09T12:00:00+00:00', 'cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-09T00:00:00+00:00', 'cda/WI_PLSP_3DP/MOM.P.MAGT3/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsX7LELp/wi_plsps_3dp_20190408120000_20190412115954.cdf', 'https://cdaweb.gsfc.nasa.gov/tmp/wss6lQ5G/wi_plsps_3dp_20190408120000_20190412115954.cdf', 'https://cdaweb.gsfc.nasa.gov/tmp/wsgD6oUy/wi_plsps_3dp_20190408120000_20190412115954.cdf', 'https://cdaweb.gsfc.nasa.gov/tmp/ws2WbWGk/wi_plsps_3dp_20190408120000_20190412115954.cdf', 'https://cdaweb.gsfc.nasa.gov/tmp/wsw6URGt/wi_plsps_3dp_20190408120000_20190412115954.cdf', 'https://cdaweb.gsfc.nasa.gov/tmp/wsrsvJ7P/wi_plsps_3dp_20190408120000_20190412115954.cdf', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-12T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-11T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-11T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-10T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-10T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-09T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-09T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptens_magQ/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsJysIZz/thb_l2s_mom_20190408120000_20190412115958.cdf', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-12T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-11T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-11T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-10T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-10T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-09T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-09T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_ptens_magQ/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/ws2UEYKB/thb_l2s_mom_20190408120000_20190412115958.cdf', 'cda/WI_PM_3DP/P_TEMP/2019-04-12T00:00:00+00:00', 'cda/WI_PM_3DP/P_TEMP/2019-04-11T12:00:00+00:00', 'cda/WI_PM_3DP/P_TEMP/2019-04-11T00:00:00+00:00', 'cda/WI_PM_3DP/P_TEMP/2019-04-10T12:00:00+00:00', 'cda/WI_PM_3DP/P_TEMP/2019-04-10T00:00:00+00:00', 'cda/WI_PM_3DP/P_TEMP/2019-04-09T12:00:00+00:00', 'cda/WI_PM_3DP/P_TEMP/2019-04-09T00:00:00+00:00', 'cda/WI_PM_3DP/P_TEMP/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wspZgXLc/wi_pms_3dp_20190408120000_20190412115958.cdf', 'cda/WI_PM_3DP/P_VELS/2019-04-12T00:00:00+00:00', 'cda/WI_PM_3DP/P_VELS/2019-04-11T12:00:00+00:00', 'cda/WI_PM_3DP/P_VELS/2019-04-11T00:00:00+00:00', 'cda/WI_PM_3DP/P_VELS/2019-04-10T12:00:00+00:00', 'cda/WI_PM_3DP/P_VELS/2019-04-10T00:00:00+00:00', 'cda/WI_PM_3DP/P_VELS/2019-04-09T12:00:00+00:00', 'cda/WI_PM_3DP/P_VELS/2019-04-09T00:00:00+00:00', 'cda/WI_PM_3DP/P_VELS/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsgZ9Qeq/wi_pms_3dp_20190408120000_20190412115958.cdf', 'cda/WI_PM_3DP/P_DENS/2019-04-12T00:00:00+00:00', 'cda/WI_PM_3DP/P_DENS/2019-04-11T12:00:00+00:00', 'cda/WI_PM_3DP/P_DENS/2019-04-11T00:00:00+00:00', 'cda/WI_PM_3DP/P_DENS/2019-04-10T12:00:00+00:00', 'cda/WI_PM_3DP/P_DENS/2019-04-10T00:00:00+00:00', 'cda/WI_PM_3DP/P_DENS/2019-04-09T12:00:00+00:00', 'cda/WI_PM_3DP/P_DENS/2019-04-09T00:00:00+00:00', 'cda/WI_PM_3DP/P_DENS/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wstZl9Kd/wi_pms_3dp_20190408120000_20190412115958.cdf', 'cda/WI_H2_MFI/BGSE/2019-04-12T00:00:00+00:00', 'cda/WI_H2_MFI/BGSE/2019-04-11T12:00:00+00:00', 'cda/WI_H2_MFI/BGSE/2019-04-11T00:00:00+00:00', 'cda/WI_H2_MFI/BGSE/2019-04-10T12:00:00+00:00', 'cda/WI_H2_MFI/BGSE/2019-04-10T00:00:00+00:00', 'cda/WI_H2_MFI/BGSE/2019-04-09T12:00:00+00:00', 'cda/WI_H2_MFI/BGSE/2019-04-09T00:00:00+00:00', 'cda/WI_H2_MFI/BGSE/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsxSYUNJ/wi_h2s_mfi_20190408120000_20190412115959.cdf', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-12T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-11T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-11T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-10T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-10T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-09T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-09T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_ptotQ/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsFDFj77/thb_l2s_mom_20190408120000_20190412115958.cdf', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-12T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-11T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-11T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-10T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsOxDZT7/thb_l2s_mom_20190410120000_20190412115958.cdf', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-09T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsHyWZk9/thb_l2s_mom_20190408120000_20190409115958.cdf', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-12T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-11T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-11T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-10T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsOkO4D6/thb_l2s_mom_20190410120000_20190412115958.cdf', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-09T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsjw9VQW/thb_l2s_mom_20190408120000_20190409115958.cdf', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-12T00:00:00+00:00', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-11T12:00:00+00:00', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-11T00:00:00+00:00', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-10T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsPOK59Q/thb_l2s_fgm_20190410154948_20190412051612.cdf', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-09T00:00:00+00:00', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-08T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wskTkvRu/thb_l2s_fgm_20190408120000_20190408192100.cdf', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-10T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_densityQ/2019-04-09T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsjUpKuw/thb_l2s_mom_20190409120003_20190410115956.cdf', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-10T00:00:00+00:00', 'cda/THB_L2_FGM/thb_fgl_gse/2019-04-09T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsfWpYWe/thb_l2s_fgm_20190409122948_20190409223612.cdf', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-10T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_velocity_gseQ/2019-04-09T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsF7wqKb/thb_l2s_mom_20190409120003_20190410115956.cdf', 'cda/SOLO_L2_MAG-RTN-NORMAL-1-MINUTE/B_RTN/2021-01-02T00:00:00+00:00', 'cda/SOLO_L2_MAG-RTN-NORMAL-1-MINUTE/B_RTN/2021-01-01T12:00:00+00:00', 'cda/SOLO_L2_MAG-RTN-NORMAL-1-MINUTE/B_RTN/2021-01-01T00:00:00+00:00', 'cda/SOLO_L2_MAG-RTN-NORMAL-1-MINUTE/B_RTN/2020-12-31T12:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-12T00:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-11T12:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-11T00:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-10T12:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-10T00:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-09T12:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-09T00:00:00+00:00', 'cda/WI_PLSP_3DP/ENERGY/2019-04-08T12:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-12T00:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-11T12:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-11T00:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-10T12:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-10T00:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-09T12:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-09T00:00:00+00:00', 'cda/WI_ELM2_3DP/MAGT3/2019-04-08T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-12T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-11T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-11T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-10T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-10T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-09T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-09T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peim_t3_magQ/2019-04-08T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-12T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-11T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-11T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-10T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-10T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-09T12:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-09T00:00:00+00:00', 'cda/THB_L2_MOM/thb_peem_t3_magQ/2019-04-08T12:00:00+00:00', 'cda/PSP_SWP_SPC_L3I/np_moment_gd/2019-04-07T12:00:00+00:00', 'cda/PSP_SWP_SPC_L3I/np_moment_gd/2019-04-07T00:00:00+00:00', 'cda/PSP_SWP_SPC_L3I/np_moment_gd/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wshv6OPm/psp_swps_spc_l3i_20190406120012_20190407235805.cdf', 'cda/PSP_SWP_SPI_SF00_L3_MOM/SUN_DIST/2019-04-07T12:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/SUN_DIST/2019-04-07T00:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/SUN_DIST/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wszcUkYV/psp_swps_spi_sf00_l3_mom_20190406120001_20190407235959.cdf', 'cda/PSP_SWP_SPI_SF00_L3_MOM/TEMP/2019-04-07T12:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/TEMP/2019-04-07T00:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/TEMP/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsWQttvt/psp_swps_spi_sf00_l3_mom_20190406120001_20190407235959.cdf', 'cda/PSP_SWP_SPI_SF00_L3_MOM/VEL_RTN_SUN/2019-04-07T12:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/VEL_RTN_SUN/2019-04-07T00:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/VEL_RTN_SUN/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsqD3Vl4/psp_swps_spi_sf00_l3_mom_20190406120001_20190407235959.cdf', 'cda/PSP_SWP_SPI_SF00_L3_MOM/DENS/2019-04-07T12:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/DENS/2019-04-07T00:00:00+00:00', 'cda/PSP_SWP_SPI_SF00_L3_MOM/DENS/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/ws1kPspF/psp_swps_spi_sf00_l3_mom_20190406120001_20190407235959.cdf', 'cda/PSP_FLD_L3_RFS_LFR_QTN/N_elec/2019-04-07T12:00:00+00:00', 'cda/PSP_FLD_L3_RFS_LFR_QTN/N_elec/2019-04-07T00:00:00+00:00', 'cda/PSP_FLD_L3_RFS_LFR_QTN/N_elec/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wscwwzey/psp_flds_l3_rfs_lfr_qtn_20190406120006_20190407235922.cdf', 'cda/PSP_SWP_SPC_L3I/wp_moment_gd/2019-04-07T12:00:00+00:00', 'cda/PSP_SWP_SPC_L3I/wp_moment_gd/2019-04-07T00:00:00+00:00', 'cda/PSP_SWP_SPC_L3I/wp_moment_gd/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsqkNkGL/psp_swps_spc_l3i_20190406120012_20190407235805.cdf', 'cda/PSP_SWP_SPC_L3I/vp_moment_RTN_gd/2019-04-07T12:00:00+00:00', 'cda/PSP_SWP_SPC_L3I/vp_moment_RTN_gd/2019-04-07T00:00:00+00:00', 'cda/PSP_SWP_SPC_L3I/vp_moment_RTN_gd/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsBcRYzd/psp_swps_spc_l3i_20190406120012_20190407235805.cdf', 'cda/PSP_FLD_L3_SQTN_RFS_V1V2/electron_density/2019-04-07T12:00:00+00:00', 'cda/PSP_FLD_L3_SQTN_RFS_V1V2/electron_density/2019-04-07T00:00:00+00:00', 'cda/PSP_FLD_L3_SQTN_RFS_V1V2/electron_density/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/ws5ziTed/psp_flds_l3_sqtn_rfs_v1v2_20190406120006_20190407235957.cdf', 'cda/PSP_FLD_L2_MAG_RTN/psp_fld_l2_mag_RTN/2019-04-07T12:00:00+00:00', 'cda/PSP_FLD_L2_MAG_RTN/psp_fld_l2_mag_RTN/2019-04-07T00:00:00+00:00', 'cda/PSP_FLD_L2_MAG_RTN/psp_fld_l2_mag_RTN/2019-04-06T12:00:00+00:00', 'https://cdaweb.gsfc.nasa.gov/tmp/wsZx9P7S/psp_flds_l2_mag_rtn_20190406120000_20190407235735.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/thb_l2_mom_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/thb_l2_fgm_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/sta_l2_pla_1dmax_1min_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/sta_l2_magplasma_1m_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/sta_l1_mag_rtn_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/wi_k0_swe_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/wi_h4-rtn_mfi_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/sst/0000/the_l2_sst_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/scm/0000/the_l2_scm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/mom/0000/the_l2_mom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/gmom/0000/the_l2_gmom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/fit/0000/the_l2_fit_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/fgm/0000/the_l2_fgm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/fft/0000/the_l2_fft_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/fbk/0000/the_l2_fbk_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/esd/0000/the_l2_esd_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/esa/0000/the_l2_esa_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/the/l2/efi/0000/the_l2_efi_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/sst/0000/thd_l2_sst_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/scm/0000/thd_l2_scm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/mom/0000/thd_l2_mom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/gmom/0000/thd_l2_gmom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/fit/0000/thd_l2_fit_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/fgm/0000/thd_l2_fgm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/fft/0000/thd_l2_fft_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/fbk/0000/thd_l2_fbk_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/esd/0000/thd_l2_esd_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/esa/0000/thd_l2_esa_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thd/l2/efi/0000/thd_l2_efi_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/sst/0000/thc_l2_sst_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/scm/0000/thc_l2_scm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/mom/0000/thc_l2_mom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/gmom/0000/thc_l2_gmom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/fit/0000/thc_l2_fit_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/fgm/0000/thc_l2_fgm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/fft/0000/thc_l2_fft_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/fbk/0000/thc_l2_fbk_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/esd/0000/thc_l2_esd_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/esa/0000/thc_l2_esa_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thc/l2/efi/0000/thc_l2_efi_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/sst/0000/thb_l2_sst_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/scm/0000/thb_l2_scm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/mom/0000/thb_l2_mom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/gmom/0000/thb_l2_gmom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/fit/0000/thb_l2_fit_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/fgm/0000/thb_l2_fgm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/fft/0000/thb_l2_fft_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/fbk/0000/thb_l2_fbk_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/esd/0000/thb_l2_esd_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/esa/0000/thb_l2_esa_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/thb/l2/efi/0000/thb_l2_efi_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/sst/0000/tha_l2_sst_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/scm/0000/tha_l2_scm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/mom/0000/tha_l2_mom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/gmom/0000/tha_l2_gmom_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/fit/0000/tha_l2_fit_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/fgm/0000/tha_l2_fgm_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/fft/0000/tha_l2_fft_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/fbk/0000/tha_l2_fbk_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/esd/0000/tha_l2_esd_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/esa/0000/tha_l2_esa_00000000_v01.cdf', 'http://cdpp.irap.omp.eu/themisdata/tha/l2/efi/0000/tha_l2_efi_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms4_fpi_fast_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms4_fpi_brst_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms4_fgm_srvy_l2_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms3_fpi_fast_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms3_fpi_brst_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms3_fgm_srvy_l2_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms2_fpi_fast_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms2_fpi_brst_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms2_fgm_srvy_l2_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms1_fpi_fast_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms1_fpi_brst_l2_des-moms_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/mms1_fgm_srvy_l2_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/erg_pwe_hfa_l3_1min_00000000_v01.cdf', 'https://cdaweb.gsfc.nasa.gov/pub/software/cdawlib/0MASTERS/erg_lepe_l3_pa_00000000_v01.cdf', 'cache/version']\nspz.update_inventories()\ntimerange = [\"2011-08-25\", \"2016-06-30\"]\n# timerange = [\"2011-08-25\", \"2011-09-01\"]\nmission = \"STA\"\nts = timedelta(seconds=1)\ntau = timedelta(seconds=60)\n\nprovider = 'archive/local'\nmag_dataset = \"STA_L1_MAG_RTN\"\nmag_parameters = [\"BFIELD\"]\n\n# plasma_dataset = \"STA_L2_MAGPLASMA_1M\"\n# plasma_parameters= [\"Np\", \"Cone_Angle\", \"Vt_Over_V_RTN\", \"Vp_RTN\", \"Tp\"]\n\nplasma_dataset = 'STA_L2_PLA_1DMAX_1MIN'\ndensity_col = 'proton_number_density'\nvec_cols = ['proton_Vr_RTN', 'proton_Vt_RTN', 'proton_Vn_RTN']\ntemperature_col = 'proton_temperature'\nplasma_parameters = [density_col] + vec_cols + [temperature_col]\n\nfmt = 'arrow'\nfname = f\"../../../data/05_reporting/events.{mission}.ts_{ts.total_seconds():.2f}s_tau_60s.{fmt}\"",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from STEREO"
    ]
  },
  {
    "objectID": "notebooks/missions/stereo/index.html#downloading-files",
    "href": "notebooks/missions/stereo/index.html#downloading-files",
    "title": "IDs from STEREO",
    "section": "Downloading files",
    "text": "Downloading files\n\ndef download(timerange):\n    \n    files = pyspedas.stereo.plastic(timerange, downloadonly=True)\n\n    for file in files:\n        parquet_file = file.replace('.cdf', f'.{fmt}')\n        cdf2pl(file, plasma_parameters).collect().write_ipc(parquet_file)\n        \n    mag_files = pyspedas.stereo.mag(timerange, downloadonly=True)\n    \n    return files\n    \n        \n# download(timerange)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from STEREO"
    ]
  },
  {
    "objectID": "notebooks/missions/stereo/index.html#loading-data",
    "href": "notebooks/missions/stereo/index.html#loading-data",
    "title": "IDs from STEREO",
    "section": "Loading data",
    "text": "Loading data\n\nmag_vars = Variables(\n    provider = provider,\n    dataset=mag_dataset,\n    parameters=mag_parameters,\n    timerange=timerange,\n).retrieve_data()\n\nKeyboardInterrupt: \n\n\n\ndef get_and_process_data(timerange):\n    mag_vars = Variables(\n        provider = provider,\n        dataset=mag_dataset,\n        parameters=mag_parameters,\n        timerange=timerange,\n    ).retrieve_data()\n\n    bcols = mag_vars.data[0].columns[:3]\n\n    mag_data = mag_vars.to_polars().drop('BTotal')\n    \n    files = pyspedas.stereo.plastic(timerange, downloadonly=True, no_update=True)\n    parquet_files = [file.replace('.cdf', f'.{fmt}') for file in files]\n\n    plasma_data = pl.scan_ipc(parquet_files).with_columns(\n        plasma_density = pl.when(pl.col(density_col) &lt;0 ).then(None).otherwise(pl.col(density_col)),\n        plasma_speed=pl_norm(vec_cols), ).rename({temperature_col:'plasma_temperature'}\n    )\n    \n    return IDsDataset(\n        mag_data=mag_data.pipe(resample, every=ts),\n        plasma_data=plasma_data,\n        tau=tau,\n        ts=ts,\n        bcols=bcols,\n        vec_cols=vec_cols,\n        density_col=\"plasma_density\",\n        speed_col=\"plasma_speed\",\n        temperature_col='plasma_temperature',\n    ).find_events(return_best_fit=False).update_candidates_with_plasma_data()\n\n\nids : list[pl.DataFrame] = []\nfor _tr in tqdm(TimeRange(timerange).split(8)):\n    \n    _timerange = [_tr.start.value, _tr.end.value]\n    _id = get_and_process_data(_timerange)\n    ids.append(_id.events)\n    \nid = pl.concat(ids, how='vertical_relaxed').select(cs.datetime(), cs.duration(), cs.numeric())\nid.write_ipc(fname)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Missions",
      "IDs from STEREO"
    ]
  },
  {
    "objectID": "notebooks/30_data.html",
    "href": "notebooks/30_data.html",
    "title": "",
    "section": "",
    "text": "%load_ext autoreload\n%autoreload 2\n\n::: {#cell-1 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=7}\nfrom utils.config import JunoConfig, WindConfig, IDsConfig\nfrom rich import print\n\n1\n\n:::\n\nWindConfig().split\n\n8\n\n\n\nJunoConfig(ts=0.125).get_and_process_data().export()\nJunoConfig(method='derivative').get_and_process_data().export()\nJunoConfig(ts=0.125, method='derivative').get_and_process_data().export()\n\n\nWindConfig().get_and_process_data()",
    "crumbs": [
      "Home",
      "Notebooks",
      "30 Data"
    ]
  },
  {
    "objectID": "notebooks/05_sea.html",
    "href": "notebooks/05_sea.html",
    "title": "Superposed epoch analysis",
    "section": "",
    "text": "Superposed epoch analysis\n\n%load_ext autoreload\n%autoreload 2\n\n\nimport polars as pl\n\nfrom datetime import timedelta\nfrom discontinuitypy.utils.basic import df2ts\nfrom discontinuitypy.core.pipeline import compress_dfs_by_intervals\nfrom xarray_einstats import linalg\nfrom sea_norm import sean\nimport pandas as pd\nimport xarray as xr\nimport matplotlib.pyplot as plt\nfrom matplotlib.pyplot import Figure, Axes\n\nfrom discontinuitypy.integration import J_FACTOR\n\nfrom utils import keep_good_fit\n\nfrom loguru import logger\n\nTqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)\nUserWarning: Traceback (most recent call last):\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 85, in &lt;module&gt;\n    from . import skintegrate\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/skintegrate.py\", line 20, in &lt;module&gt;\n    from sklearn.base import BaseEstimator\nModuleNotFoundError: No module named 'sklearn'\n\nUserWarning: pdpipe: Scikit-learn or skutil import failed. Scikit-learn-dependent pipeline stages will not be loaded.\nUserWarning: Traceback (most recent call last):\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 105, in &lt;module&gt;\n    from . import nltk_stages\n  File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/nltk_stages.py\", line 19, in &lt;module&gt;\n    import nltk\nModuleNotFoundError: No module named 'nltk'\n\nUserWarning: pdpipe: nltk import failed. nltk-dependent  pipeline stages will not be loaded.\n\n\n\nfrom discontinuitypy.propeties.mva import minvar\nimport numpy as np\n\ndef get_dBdt_data(data: pl.LazyFrame):\n    \"\"\"\n    Calculate the time derivative of the magnetic field\n    \"\"\"\n    # TODO: compress data first by events, however, this will decrease the reliability of the derivative at the edges of the events\n    ts = df2ts(data)\n\n    vec_diff = ts.differentiate(\"time\", datetime_unit=\"s\")\n    vec_diff_mag: xr.DataArray = linalg.norm(vec_diff, dims=\"v_dim\")\n    return vec_diff_mag.to_dataframe(name=\"dBdt\")\n\ndef _get_mva_data(\n    data: pl.LazyFrame,\n    start,\n    end,\n    columns=[\"B_l\", \"B_m\", \"B_n\"],\n    normalize=True,\n):\n    event_data = data.filter(pl.col(\"time\") &gt;= start, pl.col(\"time\") &lt;= end).collect()\n\n    event_numpy = event_data.drop(\n        \"time\"\n    ).to_numpy()  # Assuming this is efficient for your use case\n    time = event_data.get_column(\"time\").to_numpy()\n\n    vrot, _, _ = minvar(event_numpy)\n\n    if True:\n        vl = vrot[:, 0]\n        vl = vl * np.sign(vl[-1] - vl[0])\n        vl_ts = xr.DataArray(vl, dims=\"time\", coords={\"time\": time})\n        dvl_dt_df = vl_ts.differentiate(\"time\", datetime_unit=\"s\").to_dataframe(\n            name=\"dBl_dt\"\n        )\n\n    if normalize:\n        vrot = normalize_mva_data(vrot)\n        vrot_df = pd.DataFrame(vrot, columns=columns, index=time)\n\n    return pd.concat([vrot_df, dvl_dt_df], axis=1)[1:-1]\n\n\ndef get_mva_data(\n    data: pl.LazyFrame,\n    starts: list,\n    ends: list,\n    **kwargs,\n):\n    \"\"\"\n    Get the MVA data for the given intervals\n    \"\"\"\n    return pd.concat(\n        _get_mva_data(data, start, end, **kwargs) for start, end in zip(starts, ends)\n    )\n\n\ndef normalize_mva_data(\n    data: np.ndarray, shift=False  # shift the data in l direction to the origin\n):\n    \"\"\"\n    normalize the MVA data: Bl, Bm, and Bn were respectively normalized to B0 = 0.5ΔBl, Bm, and &lt;B&gt;\n    \"\"\"\n    vl, vm, vn = data.T\n\n    vl_norm_q = (vl[-1] - vl[0]) / 2\n    vm_norm_q = (vm[0] + vm[-1]) / 2\n    vn_norm_q = (vn[0] + vn[-1]) / 2\n\n    return np.array([vl / vl_norm_q, vm / vm_norm_q, vn / vn_norm_q]).T\n\n\ndef sea_ids(\n    dfs: list[pl.LazyFrame],\n    events: pl.DataFrame,\n    start_col=\"t.d_start\",\n    end_col=\"t.d_end\",\n    event_cols=[\"t.d_start\", \"t.d_time\", \"t.d_end\"],\n    sea_cols=[\n        \"B_l\",\n        \"j_m\",\n        \"j_m_norm\",\n        \"B_m\",\n    ],\n    offset = timedelta(seconds=1),\n    bins=[10, 10],\n    return_data=True,\n):\n\n    if not isinstance(dfs, list):\n        dfs = [dfs]\n\n    events = keep_good_fit(events)\n\n    sea_events = [col.to_numpy() for col in events[event_cols]]\n\n    starts = events.get_column(start_col) - offset\n    ends = events.get_column(end_col) + offset\n\n    logger.info(\"Compressing data by events\")\n    data_c = compress_dfs_by_intervals(dfs, starts, ends).lazy()\n    \n    mva_data = get_mva_data(data_c, starts=starts, ends=ends)\n    b_data = mva_data.sort_index()\n    # dBdt_data = get_dBdt_data(data_c)\n    # b_data = dBdt_data.join(mva_data, on=\"time\")\n\n    p_data = (\n        events[[\"time\", \"v_k\", \"j_Alfven\"]].to_pandas().set_index(\"time\").sort_index()\n    )\n\n    sea_data = pd.merge_asof(\n        b_data,\n        p_data,\n        left_index=True,\n        right_index=True,\n        direction=\"nearest\",\n    )\n\n    sea_data = sea_data.assign(\n        j_m=lambda df: df.dBl_dt / df.v_k * J_FACTOR,\n        j_m_norm=lambda df: df.j_m / df.j_Alfven,\n        # j_k=lambda df: df.dBdt / df.v_k * J_FACTOR,\n        # j_k_norm=lambda df: df.j_k / df.j_Alfven,\n    )\n\n    return sean(sea_data, sea_events, bins, return_data=return_data, cols=sea_cols)\n\n\ndef plot_SEA(SEAarray: pd.DataFrame, meta) -&gt; tuple[Figure, list[Axes]]:\n    \n    cols = meta[\"sea_cols\"]\n    fig, axes = plt.subplots(nrows=len(cols), sharex=True, squeeze=True)\n\n    if len(cols) == 1:\n        axes = [axes]\n\n    # loop over columns that were analyzed\n    for c, ax in zip(cols, axes):\n        # for each column identify the column titles which\n        # have 'c' in the title and those that don't have\n        # 'cnt' in the title\n        # e.g. for AE columns\n        # AE_mean, AE_median, AE_lowq, AE_upq, AE_cnt\n        # fine columns AE_mean, AE_median, AE_lowq, AE_upq\n        # mask = SEAarray.columns.str.startswith(c) & ~SEAarray.columns.str.endswith(\"cnt\")\n        mask = [c + \"_mean\", c + \"_median\", c + \"_lowq\", c + \"_upq\"]\n        style = [\"r-\", \"b-\", \"b--\", \"b--\"]\n        \n        # plot the SEA data\n        SEAarray.loc[:, mask].plot(\n            ax=ax,\n            style=style,\n            xlabel=\"Normalized Time\",\n            ylabel=c.replace(\"_\", \" \"),\n            legend=False,\n        )\n\n    return fig, axes\n\ndef plot_ids_sea(SEAarray: pd.DataFrame, meta) -&gt; tuple[Figure, list[Axes]]:\n    import scienceplots\n    \n    SEAarray.index = SEAarray.index.map(lambda x: x / bin/2)\n\n    with plt.style.context(['science', 'nature', 'notebook']):\n\n        fig, axes = plot_SEA(SEAarray, meta)\n\n        axes[0].set_ylabel(r\"$B_x \\ / \\ B_0$\")\n        axes[1].set_ylabel(r\"$J_y$\")\n        axes[2].set_ylabel(r\"$J_y \\ / \\ J_A$\")\n        axes[3].set_ylabel(r\"$J_k$\")\n        axes[4].set_ylabel(r\"$J_k \\ / \\ J_A$\")\n        axes[5].set_ylabel(r\"$B_m \\ / \\ B_g$\")\n\n        fig.tight_layout()\n        fig.subplots_adjust(hspace=0)\n        \n        axes[0].legend(labels=[\"Mean\", \"Median\", \"LowQ\", \"UpQ\"])\n    return fig, axes\n    # fig.savefig(f\"../../../figures/sea/sea_juno_first_year_{freq}.png\", dpi = 300)\n\n::: {#cell-6 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=6}\nfrom utils.config import JunoConfig\n:::\n\n# config = JunoConfig(timerange=['2011-01-01','2012-01-01'], ts=1/8, split=16)\nconfig = JunoConfig(timerange=['2011-01-01','2011-09-01'], ts=1/8, split=2)\nts_f = config.ts.total_seconds()\n\n\nids_ds = config.get_and_process_data()\n\n25-Feb-24 14:17:18: UserWarning: Ray execution environment not yet initialized. Initializing...\nTo remove this warning, run the following python code before doing dataframe operations:\n\n    import ray\n    ray.init()\n\n\n2024-02-25 14:17:20,458 INFO worker.py:1724 -- Started a local Ray instance.\n25-Feb-24 14:17:21: UserWarning: Distributing &lt;class 'pandas.core.frame.DataFrame'&gt; object. This may take some time.\n\n(_deploy_ray_func pid=19653) UserWarning: Traceback (most recent call last):\n(_deploy_ray_func pid=19653)   File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 85, in &lt;module&gt;\n(_deploy_ray_func pid=19653)     from . import skintegrate\n(_deploy_ray_func pid=19653)   File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/skintegrate.py\", line 20, in &lt;module&gt;\n(_deploy_ray_func pid=19653)     from sklearn.base import BaseEstimator\n(_deploy_ray_func pid=19653) ModuleNotFoundError: No module named 'sklearn'\n(_deploy_ray_func pid=19653) \n(_deploy_ray_func pid=19653) UserWarning: pdpipe: Scikit-learn or skutil import failed. Scikit-learn-dependent pipeline stages will not be loaded.\n(_deploy_ray_func pid=19653) UserWarning: Traceback (most recent call last):\n(_deploy_ray_func pid=19653)   File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/__init__.py\", line 105, in &lt;module&gt;\n(_deploy_ray_func pid=19653)     from . import nltk_stages\n(_deploy_ray_func pid=19653)   File \"/Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pdpipe/nltk_stages.py\", line 19, in &lt;module&gt;\n(_deploy_ray_func pid=19653)     import nltk\n(_deploy_ray_func pid=19653) ModuleNotFoundError: No module named 'nltk'\n(_deploy_ray_func pid=19653) \n(_deploy_ray_func pid=19653) UserWarning: pdpipe: nltk import failed. nltk-dependent  pipeline stages will not be loaded.\n25-Feb-24 14:17:24: UserWarning: Distributing &lt;class 'pandas.core.frame.DataFrame'&gt; object. This may take some time.\n\n(raylet) [2024-02-25 21:13:29,447 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 24623976448; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:13:39,538 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 23549198336; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:13:49,623 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 21401522176; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:13:59,709 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 19260973056; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:14:09,795 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 18186940416; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:14:19,881 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16048087040; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:14:29,965 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 14971949056; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:14:40,058 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 14975713280; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:14:50,146 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 14975672320; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:15:00,237 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 14975832064; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:15:10,330 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13922258944; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:15:20,332 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13919682560; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:15:30,422 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13919059968; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:15:40,516 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13918883840; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:15:50,611 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13918425088; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:16:00,703 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13917073408; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:16:10,792 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13916012544; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:16:20,886 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13916037120; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:16:30,979 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13915873280; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:16:41,070 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13915873280; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:16:51,167 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13915881472; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:17:01,168 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13914701824; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:17:11,268 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13914558464; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:17:21,366 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13914558464; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:17:31,450 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13911355392; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:17:41,541 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13911310336; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:17:51,632 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13909708800; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:18:01,722 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13907607552; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:18:11,810 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13906460672; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:18:21,907 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13906661376; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:18:31,996 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13906132992; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:18:42,096 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13905117184; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:18:52,184 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13905100800; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:19:02,279 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13903986688; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:19:12,364 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13904023552; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:19:22,457 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13902958592; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:19:32,459 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13908783104; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:19:42,553 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13902872576; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:19:52,646 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13902884864; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:20:02,732 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13902872576; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:20:12,816 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13902774272; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:20:22,905 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13902761984; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:20:32,999 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13902626816; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:20:43,091 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13923864576; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:20:53,179 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13923241984; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:21:03,266 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13922914304; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:21:13,350 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13921800192; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:21:23,446 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13921751040; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:21:33,538 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13921624064; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:21:43,631 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13921533952; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:21:53,724 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13921193984; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:22:03,823 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13920976896; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:22:13,911 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13922795520; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:22:23,995 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12848414720; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:22:34,089 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12847837184; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:22:44,179 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12847505408; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:22:54,263 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12847505408; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:23:04,353 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12846133248; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:23:14,451 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12843900928; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:23:24,546 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12841795584; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:23:34,633 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12841484288; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:23:44,636 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12840787968; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:23:54,720 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12840685568; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:24:04,812 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12840427520; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:24:14,815 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12839194624; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:24:24,910 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13720223744; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:24:34,911 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12372692992; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:24:45,003 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12317143040; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:24:55,101 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12316086272; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:25:05,197 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12315762688; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:25:15,296 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 12315832320; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:25:25,397 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13219405824; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:25:35,494 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13948411904; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:25:45,588 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13952352256; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:25:55,686 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 13962485760; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:26:05,689 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16276803584; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:26:15,784 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16276148224; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:26:25,881 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16275963904; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:26:35,885 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16274960384; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:26:45,974 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16273985536; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:26:56,075 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16271142912; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:27:06,076 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16271126528; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:27:16,174 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16271130624; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:27:26,184 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16271085568; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:27:36,189 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16850317312; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:27:46,285 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16849317888; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:27:56,380 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16844808192; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:28:06,471 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16844066816; capacity: 494384795648. Object creation will fail if spilling is required.\n(raylet) [2024-02-25 21:28:16,557 E 19647 3004297] (raylet) file_system_monitor.cc:111: /tmp/ray/session_2024-02-25_14-17-18_480038_19584 is over 95% full, available space: 16846917632; capacity: 494384795648. Object creation will fail if spilling is required.\n\n\n\n\n\n\n\n\n\n\n\n\nbin = 32\n\nevents = ids_ds.events.with_columns(r_bin=pl.col(\"radial_distance\").round())\n\ndfs = config.mag_dfs\n\nSEAarrays = {}\n\nfor [r], r_events in events.group_by([\"r_bin\"]):\n    SEAarray, meta, p1data, p2data = sea_ids(dfs, events=r_events, bins=[bin, bin])\n    SEAarrays[r] = SEAarray\n    \ndef func():\n    for r, SEAarray in SEAarrays.items():\n        yield pl.from_dataframe(SEAarray).with_columns(r_bin=r)\n\nsea_df = pl.concat(func()).sort(\"r_bin\")\nsea_df.write_csv(\"../data/05_reporting/sea_juno_ts_{ts_f}.csv\")\n\n2024-02-25 01:00:43.955 | INFO     | __main__:sea_ids:28 - Compressing data by events\n100%|██████████| 2150/2150 [00:01&lt;00:00, 1959.71it/s]\n2024-02-25 01:01:14.763 | INFO     | __main__:sea_ids:28 - Compressing data by events\n100%|██████████| 2460/2460 [00:01&lt;00:00, 2114.96it/s]\n2024-02-25 01:01:47.126 | INFO     | __main__:sea_ids:28 - Compressing data by events\n100%|██████████| 20562/20562 [00:10&lt;00:00, 2037.43it/s]\n2024-02-25 01:03:24.733 | INFO     | __main__:sea_ids:28 - Compressing data by events\n100%|██████████| 9430/9430 [00:04&lt;00:00, 2118.91it/s]\n2024-02-25 01:04:19.989 | INFO     | __main__:sea_ids:28 - Compressing data by events\n100%|██████████| 1776/1776 [00:00&lt;00:00, 2127.65it/s]\n\n\nThere is no data for event 11627\n\n\n\nfor r, SEAarray in SEAarrays.items():\n    fig, axes = plot_ids_sea(SEAarray, meta)\n    fig.show()\n    fig.savefig(f\"../figures/sea/sea_juno_ts_{ts_f}_{r}.png\", dpi = 300)\n    \n\nIndexError: index 4 is out of bounds for axis 0 with size 4\n\n\n\n\n\n\n\n\n\n\nFitting\n\nimport mygrad as mg\nfrom lmfit import Model\n\n\ndef logistic(x, A, mu, sigma):\n    alpha = (x - mu) / sigma\n    return A * (1 - 1 / (1 + np.e**alpha))\n\n\ndef dfdx(x, A=1, mu=0, sigma=1):\n    x = mg.tensor(np.array(x))\n    f = logistic(x, A, mu, sigma)\n    f.backward()\n    return x.grad\n\ncomp_model = Model(dfdx, prefix=\"m1_\") + Model(dfdx, prefix=\"m2_\")\nparams = comp_model.make_params(\n    m1_mu = dict(value=0, vary=False),\n    m2_mu = dict(value=0, vary=False),\n    m1_A = dict(value=0.5, min=0),\n    m2_A = dict(value=0.2, min=0),\n    m1_sigma = dict(value=1, min=0),\n    m2_sigma = dict(value=2, min=0),\n)\n\nmodel = Model(dfdx)\nparams1 = model.make_params(\n    A = dict(value=0.5, min=0),\n    mu = dict(value=0, vary=False),\n    sigma = dict(value=1, min=0),\n)\n\n\nfrom lmfit.model import ModelResult\n\ndef plot_result(x, y, result: ModelResult, result1=None, ax: Axes = None):\n    # print(result.fit_report())\n    x_plot = np.linspace(x.min(), x.max(), 1000)\n    comps = result.eval_components(x=x_plot)\n    \n    if ax is None:\n        fig, ax = plt.subplots()\n\n    ax.plot(x, y, \"o\")\n    ax.plot(x_plot, result.eval(x=x_plot), label=\"best fit\")\n    ax.plot(x_plot, comps[\"m1_\"], \"--\", label=\"comp#1 fit\")\n    ax.plot(x_plot, comps[\"m2_\"], \"--\", label=\"comp#2 fit\")\n    if result1:\n        ax.plot(x, result1.best_fit, label=\"best fit with one component\")\n    return ax\n\n\nx = SEAarray.index.values[8:-8]/bin\nfit_cols = [\"j_m_median\", \"j_m_norm_median\"]\nfit_result: list[ModelResult] = []\nfit_result1: list[ModelResult] = []\n\nSEAarrays = dict(sorted(SEAarrays.items()))\n\nfig, axes = plt.subplots(len(SEAarrays), len(fit_cols), sharex=True, figsize=(12, 12))\n\nfor i, (r, SEAarray) in enumerate(SEAarrays.items()):\n    for j, col in enumerate(fit_cols):\n        y = SEAarray[col].values[8:-8]\n\n        result = comp_model.fit(y, params, x=x)\n        result_dict: dict = result.params.valuesdict()\n        result_dict.update({\"r\": r, \"col\": col})\n        fit_result.append(result_dict)\n\n        result1 = model.fit(y, params1, x=x)\n        result_dict1: dict = result1.params.valuesdict()\n        result_dict1.update({\"r\": r, \"col\": col})\n        fit_result1.append(result_dict1)\n        \n        ax :Axes = axes[i, j]\n        plot_result(x, y, result, result1, ax=ax)\n        \n        if i == 0:\n            ax.set_title(f\"{col}\")\n        if j == 0:\n            ax.set_ylabel(f\"r = {r:.0f}\")\n        \n        if i == len(SEAarrays) - 1:\n            ax.set_xlabel(\"Normalized Time\")\n        \naxes.flatten()[-1].legend()\n\nfit_result_df = pd.DataFrame(fit_result).sort_values('r')\nfit_result1_df = pd.DataFrame(fit_result1).sort_values('r')\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\n\nys = ['m1_A', 'm1_sigma', 'm2_A', 'm2_sigma']\nfig, axes = plt.subplots(nrows=len(ys), sharex=True)\naxes : list[Axes]\nfor param, ax in zip(ys, axes):\n    group_df = fit_result_df.groupby('col')\n    for name, group in group_df:\n        group.plot(x='r',y=param, ax=ax, label=name)\n    ax.set_ylabel(param)\n\nplt.legend()\n\n# fit_result_df['m2_sigma'].plot()\n\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n\ndef dvl_dt(\n    data: pl.LazyFrame,\n    start,\n    end,\n):\n    event_data = data.filter(pl.col(\"time\") &gt;= start, pl.col(\"time\") &lt;= end).collect()\n\n    event_numpy = event_data.drop(\"time\").to_numpy()\n    time = event_data.get_column(\"time\").to_numpy()\n\n    vrot, _, _ = minvar(event_numpy)\n\n    vl = vrot[:, 0]\n    vl = vl * np.sign(vl[-1] - vl[0])\n    vl_ts = xr.DataArray(vl, dims=\"time\", coords={\"time\": time})\n\n    return vl_ts.differentiate(\"time\", datetime_unit=\"s\")\n\ndef ids_j_bin_l(\n    events: pl.DataFrame,\n    dfs: list[pl.LazyFrame],\n    start_col=\"t.d_start\",\n    end_col=\"t.d_end\",\n    offset=timedelta(seconds=1),\n):\n\n    if not isinstance(dfs, list):\n        dfs = [dfs]\n\n    events = keep_good_fit(events)\n\n    starts = events.get_column(start_col) - offset\n    ends = events.get_column(end_col) + offset\n\n    logger.info(\"Compressing data by events\")\n    data_c = compress_dfs_by_intervals(dfs, starts, ends).lazy()\n\n    logger.info(\"Calculating dvl_dt\")\n    return (\n        dvl_dt(data_c, start, end) for start, end in zip(starts, ends)\n    )\n\n\ndvl_dts = list(ids_j_bin_l(events, config.mag_dfs))\n\n2024-02-25 15:05:05.917 | INFO     | __main__:ids_j_bin_l:35 - Compressing data by events\n2024-02-25 15:05:05.982 | INFO     | __main__:ids_j_bin_l:38 - Calculating dvl_dt\n\n\n\ndef func():\n    epochs = events.get_column(\"t.d_time\").to_numpy()\n    v_ks = events.get_column(\"v_k\")\n    ion_inertial_lengths = events.get_column(\"ion_inertial_length\")\n    rs = events.get_column(\"radial_distance\")\n    \n    for i, dvl_dt in enumerate(dvl_dts):\n        shift_time = (dvl_dt.time - epochs[i]).values.astype(float)\n        l_norm = shift_time / 1.0e9 * v_ks[i] / ion_inertial_lengths[i]\n        # yield l_norm.values.astype(float)\n        yield rs[i], l_norm, dvl_dt.values\n\n\nrs, ls, dvl_dts = zip(*func())\nls_all = np.concatenate(ls)\ndvl_dts_all = np.concatenate(dvl_dts)\nplt.scatter(ls_all, dvl_dts_all)\n\n\n\n\n\n\n\n\n\ny = dvl_dts_all\nx = ls_all\nresult = comp_model.fit(y, params, x=x)\nresult1 = model.fit(y, params1, x=x)\n\nplot_result(x, y, result, result1)\n\n\n\n\n\n\n\n\n\nevents = ids_ds.events.head(10).pipe(ids_j_bin_l, dfs=config.mag_dfs[0]).with_columns(r_bin=pl.col(\"radial_distance\").round())\n\n2024-02-25 14:23:30.016 | INFO     | __main__:ids_j_bin_l:44 - Compressing data by events\n2024-02-25 14:23:30.068 | INFO     | __main__:ids_j_bin_l:47 - Calculating dvl_dt\n\n\n\nevents.select(\n    pl.col(\"times\").list\n)\n\n\nshape: (6, 1)\n\n\n\ntimes\n\n\nlist[i64]\n\n\n\n\n[1314285913062500000, 1314285913187500000, … 1314285944187500000]\n\n\n[1314286368812500000, 1314286368937500000, … 1314286403312500000]\n\n\n[1314286385562500000, 1314286385687500000, … 1314286424312500000]\n\n\n[1314287645562500000, 1314287645687500000, … 1314287690437500000]\n\n\n[1314292230062500000, 1314292230187500000, … 1314292253812500000]\n\n\n[1314292230062500000, 1314292230187500000, … 1314292253812500000]\n\n\n\n\n\n\n\nSuperposed epoch analysis\n\ngroupby = 'index'\ncolumns = ['dBdt', 'j_k']\n\n# Plot each group\nfig, axes = plt.subplots(nrows=len(columns))\n\nif len(columns) == 1:\n    axes = [axes]\n\np1groups = p1data.groupby(groupby)\np2groups = p2data.groupby(groupby)\n\nfor ax, column in zip(axes, columns):\n    for name, group in p1groups:\n        ax.plot(group['t_norm'] -1 , group[column], color='grey', alpha=0.3)\n        \n    for name, group in p2groups:\n        ax.plot(group['t_norm'], group[column], color='grey', alpha=0.3)\n\n# plt.yscale('log')\nplt.show()\n\nids_ds.plot_candidates(num=20, plot_fit_data=True, predicates=(pl.col('fit.stat.rsquared') &gt; 0.95))\n\n\n\n\n\n\nFigure 1: \nFigure 2:",
    "crumbs": [
      "Home",
      "Notebooks",
      "Superposed epoch analysis"
    ]
  },
  {
    "objectID": "notebooks/06_corr.html",
    "href": "notebooks/06_corr.html",
    "title": "",
    "section": "",
    "text": "::: {#cell-0 .cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’ execution_count=3}\n%load_ext autoreload\n%autoreload 2\n\nfrom utils.config import JunoConfig, j_config, w_config\nfrom utils import keep_good_fit\nfrom rich import print\nimport polars as pl\nimport hvplot.polars\n\nThe autoreload extension is already loaded. To reload it, use:\n  %reload_ext autoreload\n\n:::\n\nj_config.path\nw_config.path\n\nPath('../data/05_reporting/events.Wind.fit.ts_0.09s_tau_60s.arrow')\n\n\n\nJunoConfig(method='derivative', ts=0.125).path\n\nPath('../data/05_reporting/events.JNO.derivative.ts_0.12s_tau_60s.arrow')\n\n\n\nj_events = j_config.events.with_row_index().with_columns(r_bin=pl.col(\"radial_distance\").round()).pipe(keep_good_fit)\nw_events = w_config.events.with_row_index().pipe(keep_good_fit)\n\n\ndef plot(events, x, y, by = None, **kwargs):\n    return events.hvplot.scatter(\n        x=x,\n        y=y,\n        by=by,\n        subplots=True,\n        shared_axes=False,\n        logx=True,\n        logy=True,\n        hover_cols=[\"v_k\", \"duration\", \"fit.vars.sigma\", \"index\"],\n        **kwargs\n    )\n\nplot(j_events, \"L_k\", \"ion_inertial_length\", by=\"r_bin\").cols(2)\n\n\n\n\n\n  \n\n\n\n\n\nplot(w_events, \"L_k\", \"ion_inertial_length\")\n\n\n\n\n\n  \n\n\n\n\n\np1 = j_events.hvplot.density(y=\"L_k_norm\", by=\"r_bin\", subplots=True, xlim=(-1, 40))\np2 = j_events.hvplot.density(y=\"L_k\", by=\"r_bin\", subplots=True, xlim=(-1, 15000))\n# (p1 + p2).cols(2)\n\n\nw_events.hvplot.density(y=\"L_k_norm\")\n\n\n\n\n\n  \n\n\n\n\n\nplot(\"j0_k\", \"j_Alfven\").cols(2)\n\nWARNING:param.PointPlot04382: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\n25-Feb-24 19:38:28: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\nWARNING:param.PointPlot04390: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\n25-Feb-24 19:38:28: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\nWARNING:param.PointPlot04397: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\n25-Feb-24 19:38:28: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\nWARNING:param.PointPlot04404: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\n25-Feb-24 19:38:28: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\nWARNING:param.PointPlot04411: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\n25-Feb-24 19:38:28: Logarithmic axis range encountered value less than or equal to zero, please supply explicit lower bound to override default of 0.010.\n\n\n\n\n\n\n  \n\n\n\n\n\nconfig.plot_candidate(index=78063, add_plasma_params=True, plot_fit_data=True)\n\n(&lt;Figure size 1200x500 with 1 Axes&gt;,\n &lt;Axes: title={'center': '#Plasma parameters# $V_i: 403.16 \\\\mathrm{km/s}$, $n_i: 0.36 \\\\mathrm{cm}^{-3}$, $T_i: 28689.00 \\\\mathrm{eV}$\\n#Fit# $\\\\max dB/dt$: 1.43, $R^2$: 0.97, $\\\\chi^2$: 0.01\\n#Fit# $c$: -0.30, $Amp$: 0.30, $\\\\Sigma$: 0.05'}, ylabel='$B$\\n[nT LMN]'&gt;)",
    "crumbs": [
      "Home",
      "Notebooks",
      "06 Corr"
    ]
  },
  {
    "objectID": "notebooks/06_corr_julia.html",
    "href": "notebooks/06_corr_julia.html",
    "title": "",
    "section": "",
    "text": "using AlgebraOfGraphics\nusing AlgebraOfGraphics: density\nusing CairoMakie\nusing DataFrames\nusing DataFramesMeta\nusing Arrow\nusing PartialFunctions\nusing LaTeXStrings\nusing RCall\nusing Statistics\n\nset_aog_theme!()\n\n\nround(Int, 1.00)\n\n1\n\n\n\nfunction load(path::String)\n    df = path |&gt; Arrow.Table |&gt; DataFrame |&gt; dropmissing\n    \n    # if 'radial_distance' is in the dataframe, round it\n    if \"radial_distance\" in names(df)\n        df = @chain df begin\n            @transform :r = string.(round.(Int, :radial_distance))\n        end\n    end\n\n    df = @chain df begin\n        @transform(\n            :j0_k = abs.(:j0_k),\n            :j0_k_norm = abs.(:j0_k_norm),\n        )\n    end\n\n    # Iterate through each column in the DataFrame\n    filter(row -&gt; all(x -&gt; !(x isa Number && isnan(x)), row), df)\nend\n\nload (generic function with 1 method)\n\n\n\nbegin\n    dir = \"../data/05_reporting\"\n\n    j_events_low_fit = load(\"$dir/events.JNO.fit.ts_1.00s_tau_60s.arrow\")\n    j_events_high_fit = load(\"$dir/events.JNO.fit.ts_0.12s_tau_60s.arrow\")\n    j_events_low_der = load(\"$dir/events.JNO.derivative.ts_1.00s_tau_60s.arrow\")\n    j_events_high_der = load(\"$dir/events.JNO.derivative.ts_0.12s_tau_60s.arrow\")\n    w_events = load(\"$dir/events.Wind.fit.ts_0.09s_tau_60s.arrow\")\n\n    # add a label column to the dataframes\n    j_events_low_fit[!, :label] .= \"1 Hz (fit)\"\n    j_events_high_fit[!, :label] .= \"8 Hz (fit)\"\n    j_events_low_der[!, :label] .= \"1 Hz (derivative)\"\n    j_events_high_der[!, :label] .= \"8 Hz (derivative)\"\n\n    # filter high time resolution events\n    j_events_high_fit = @chain j_events_high_fit begin\n        filter(:len =&gt; &gt;(240), _)\n    end\n\n    j_events_der = vcat(j_events_low_der, j_events_high_der)\n\n    # combine the dataframes\n    j_events = vcat(j_events_low_fit, j_events_high_fit)\n\n    j_events = @chain j_events begin\n        filter(:\"fit.stat.rsquared\" =&gt; &gt;(0.95), _)\n    end\n\n    names(j_events)\nend\n\n94-element Vector{String}:\n \"time\"\n \"tstart\"\n \"tstop\"\n \"t.d_end\"\n \"t.d_start\"\n \"t.d_time\"\n \"index_diff\"\n \"len\"\n \"std\"\n \"std_prev\"\n ⋮\n \"v.Alfven.before.l\"\n \"v.Alfven.after.l\"\n \"n.change\"\n \"v.ion.change.l\"\n \"B.change\"\n \"v.Alfven.change\"\n \"v.Alfven.change.l\"\n \"r\"\n \"label\"\n\n\n\nlog_axis = (yscale=log10, xscale=log10)\n\nbegin\n\n    l_lab = L\"Thickness ($km$)\"\n    l_norm_lab = L\"Normalized Thickness ($d_i$)\"\n    j_norm_lab = L\"Normalized Current Density ($J_A$)\"\n\n    di_map = :ion_inertial_length =&gt; L\"Ion Inertial Length ($km$)\"\n    di_log_map = :ion_inertial_length =&gt; log10 =&gt; L\"Log Ion Inertial Length ($km$)\"\n    l_map = :L_k =&gt; l_lab\n    l_log_map = :L_k =&gt; log10 =&gt; L\"Log %$l_lab\"\n    l_norm_map = :L_k_norm =&gt; l_norm_lab\n    l_norm_log_map = :L_k_norm =&gt; log10 =&gt; L\"Log %$l_norm_lab\"\n    \n    jA_map = :j_Alfven =&gt; L\"Alfvénic Current Density ($nA/m^2$)\"\n    jA_log_map = :j_Alfven =&gt; log10 =&gt; L\"Log Alfvénic Current Density ($nA/m^2$)\"\n    j_map = :j0_k =&gt; L\"Current Density ($nA/m^2$)\"\n    j_log_map = :j0_k =&gt; log10 =&gt; L\"Log Current Density ($nA/m^2$)\"\n    j_norm_map = :j0_k_norm =&gt; L\"Normalized Current Density ($J_A$)\"\n\n    j_norm_log_map = :j0_k_norm =&gt; log10 =&gt; L\"Log %$j_norm_lab\"\n\n    j_limit = (10^-1, 10^1)\n    j_norm_limit = (10^-2, 2)\nend\n\n(0.010000000000000002, 2)\n\n\n\nbegin\n    fig = Figure(size=(1000, 800))\n\n    datalayer = mapping() * visual(Scatter, markersize=1, color=:white, alpha=0.1)\n\n    begin\n        layer = histogram(bins=range(1, 5, length=64), normalization=:pdf)\n        plt = layer * mapping(di_log_map, l_log_map)\n        plt1 = data(j_events) * mapping(layout=:r) * plt\n        plt2 = data(w_events) * plt\n    \n        l_log_limit = ((1.5, 3.5), (1.5, 4.5))\n        axis = (;limits=l_log_limit)\n        draw!(fig[1:2,1:3], plt1, axis=axis)\n        draw!(fig[1:2,4:5], plt2, axis=axis) \n    end\n\n    # Current Density Panels\n    begin\n        layer = histogram(bins=range(-2, 3, length=64), normalization=:pdf)\n        plt = layer * mapping(jA_log_map, j_log_map)\n        plt3 = data(j_events) * mapping(layout=:r) * plt\n        plt4 = data(w_events) * plt\n    \n        j_log_limit = ((-1, 3), (-2, 2))\n        axis = (;limits=j_log_limit)\n        draw!(fig[3:4,1:3], plt3, axis=axis)\n        draw!(fig[3:4,4:5], plt4, axis=axis)\n    end\n\n    # Make ablines across different r panels\n    # begin\n        # ablines_data = (; intercepts=[-3,-1,1], slopes=[1,1,1]) \n        # lines = data(ablines_data) * mapping(:intercepts, :slopes) * visual(ABLines, linestyle=:dash)\n        # draw!(fig[3:4,1:3], lines)\n    # end\n\n    Label(fig[0,1:3], \"Juno in Different Radial Distances\", fontsize=20)\n    Label(fig[0,4:5], \"Wind 11 Hz\", fontsize=20)\n\n    fig\nend\n\n\n\n\n\nbegin\n    fig = Figure(size=(1000, 800))\n\n    pdflayer = density() * visual(Contour)\n    # small scatter points\n    datalayer = mapping() * visual(Scatter, markersize=3)\n\n    # layer = pdflayer + datalayer\n    layer = datalayer\n    plt = layer * mapping(di_map, l_map)\n    plt1 = data(j_events) * mapping(layout=:r) * plt\n    plt2 = data(w_events) * plt\n\n    l_limit = ((10^1, 10^5), (10^1, 10^5))\n    axis = merge(log_axis, (;limits=l_limit))\n    draw!(fig[1:2,1:3], plt1, axis=axis)\n    draw!(fig[1:2,4:5], plt2, axis=axis)\n\n    plt = layer * mapping(jA_map, j_map)\n    plt3 = data(j_events) * mapping(layout=:r) * plt\n    plt4 = data(w_events) * plt\n\n    j_limit = ((10^-1, 10^3), (10^-2, 10^2))\n    axis = merge(log_axis, (;limits=j_limit))\n    draw!(fig[3:4,1:3], plt3, axis=axis)\n    draw!(fig[3:4,4:5], plt4, axis=axis)\n\n\n    Label(fig[0,1:3], \"Juno in Different Radial Distances\", fontsize=20)\n    Label(fig[0,4:5], \"Wind 11 Hz\", fontsize=20)\n\n    fig\nend\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\nbegin\n    fig = Figure(size=(1000, 800))\n    datalimits_f = x -&gt; quantile(x, [0.05, 0.95])\n\n    begin\n        layer = histogram(bins=24, datalimits=datalimits_f, normalization=:pdf)\n        plt = layer * mapping(l_norm_log_map, j_norm_log_map)\n        plt1 = data(j_events) * mapping(layout=:r) * plt\n        plt2 = data(w_events) * plt\n\n        axis = (;)\n        draw!(fig[1:2, 1:3], plt1, axis=axis)\n        draw!(fig[1:2, 4:5], plt2, axis=axis)\n    end\n\n    Label(fig[0, 1:3], \"Juno in Different Radial Distances\", fontsize=20)\n    Label(fig[0, 4:5], \"Wind 11 Hz\", fontsize=20)\n\n    fig\nend\n\nfig\n\n\n\n\n\nfunction plot_l_j_r(df)\n    fig = Figure(size=(1000, 1000))\n\n    plt = data(df) * mapping(col=:r, color=:label)\n\n    plt1 = plt * mapping(l_map) * density(datalimits=((0, 5000),))\n    plt2 = plt * mapping(l_norm_map) * density(datalimits=((0, 50),))\n    plt3 = plt * mapping(j_map) * density(datalimits=(j_limit,))\n    plt4 = plt * mapping(j_norm_map) * density(datalimits=(j_norm_limit,))\n\n    axis = (; yscale = identity)\n    # NOTE: log axis for density is not working now\n    # axis = (; yscale=log10, limits=(nothing, nothing, 10^-3, 1))\n    # l_axis = (; yscale = log10, limits=(nothing, (10^-5, 10^-3)))\n    # l_norm_axis = (; yscale = log10, limits=(nothing, (10^-3, 1)))\n\n    grid1 = draw!(fig[1, 1:5], plt1, axis=axis)\n    grid2 = draw!(fig[2, 1:5], plt2, axis=axis)\n    grid3 = draw!(fig[3, 1:5], plt3, axis=axis)\n    grid4 = draw!(fig[4, 1:5], plt4, axis=axis)\n    legend!(fig[0, 1:end], grid1, titleposition=:left, orientation=:horizontal)\n\n    fig\nend\n\nfig = plot_l_j_r(j_events_der)\nfig\n\n\n\n\n\n\nFigure 2\n\n\n\n\n\n@rput j_events_der\n@rput j_events\n\nR\"\"\"\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(patchwork)\nsource('utils.R')\n\"\"\"\n\nR\"\"\"\n\ndensity_plot &lt;- function(df, x, facet.by = \"r\", strip.position = \"top\"){\n  p &lt;- ggdensity(\n    df, \n    x = x, color = \"label\",\n    facet.by = facet.by,\n    add = \"median\", rug = TRUE\n  ) %&gt;%\n  facet(facet.by, ncol = 1, strip.position = strip.position)\n}\n\nplot &lt;- function(\n  df,\n  j0_k_ulim = 10\n) {\n\n  p1 &lt;- density_plot(\n    filter(df, L_k &lt; 8000), \"L_k\"\n  )\n  \n  p2 &lt;- density_plot(\n    filter(df, L_k_norm &lt; 50), \"L_k_norm\"\n  )\n  \n  p3 &lt;- density_plot(\n    filter(df, j0_k &lt; j0_k_ulim), \"j0_k\"\n  )\n  \n  p4 &lt;- density_plot(\n    filter(df, j0_k_norm &lt; 2), \"j0_k_norm\", strip.position = \"right\"\n  )\n  \n  p1 &lt;- ggpar(p1, \n      yscale=\"log10\", ylim = c(10^-5, 10^-3)\n    ) + labs(x = lab_l)\n  \n  p2 &lt;- ggpar(p2, \n      yscale=\"log10\", ylim = c(10^-3, 1), ylab=FALSE\n    ) + labs(x = lab_l_norm)\n  \n  p3 &lt;- ggpar(p3,\n      yscale=\"log10\", ylim = c(10^-2, 10), ylab=FALSE\n    ) + labs(x = lab_j)\n  \n  p4 &lt;- ggpar(p4,\n      yscale=\"log10\", ylim = c(10^-2, 10), ylab=FALSE\n    ) + labs(x = lab_j_norm)\n  \n  tag_pool &lt;- unique(df$r)\n  \n  p1 &lt;- tag_facet(p1, open = \"(a.\", tag_pool = tag_pool)\n  p2 &lt;- tag_facet(p2, open = \"(b.\", tag_pool = tag_pool)\n  p3 &lt;- tag_facet(p3, open = \"(c.\", tag_pool = tag_pool)\n  p4 &lt;- tag_facet(p4, open = \"(d.\", tag_pool = tag_pool) + theme(\n    strip.background = element_blank(),\n    strip.text.x = element_blank()\n  )\n\n  p &lt;- p1 + p2 + p3 + p4\n  p &lt;- p + plot_layout(nrow = 1, guides = \"collect\") & theme(legend.position='top')  \n}\n\"\"\"\n\nRObject{ClosSxp}\nfunction (df, j0_k_ulim = 10) \n{\n    p1 &lt;- density_plot(filter(df, L_k &lt; 8000), \"L_k\")\n    p2 &lt;- density_plot(filter(df, L_k_norm &lt; 50), \"L_k_norm\")\n    p3 &lt;- density_plot(filter(df, j0_k &lt; j0_k_ulim), \"j0_k\")\n    p4 &lt;- density_plot(filter(df, j0_k_norm &lt; 2), \"j0_k_norm\", \n        strip.position = \"right\")\n    p1 &lt;- ggpar(p1, yscale = \"log10\", ylim = c(10^-5, 10^-3)) + \n        labs(x = lab_l)\n    p2 &lt;- ggpar(p2, yscale = \"log10\", ylim = c(10^-3, 1), ylab = FALSE) + \n        labs(x = lab_l_norm)\n    p3 &lt;- ggpar(p3, yscale = \"log10\", ylim = c(10^-2, 10), ylab = FALSE) + \n        labs(x = lab_j)\n    p4 &lt;- ggpar(p4, yscale = \"log10\", ylim = c(10^-2, 10), ylab = FALSE) + \n        labs(x = lab_j_norm)\n    tag_pool &lt;- unique(df$r)\n    p1 &lt;- tag_facet(p1, open = \"(a.\", tag_pool = tag_pool)\n    p2 &lt;- tag_facet(p2, open = \"(b.\", tag_pool = tag_pool)\n    p3 &lt;- tag_facet(p3, open = \"(c.\", tag_pool = tag_pool)\n    p4 &lt;- tag_facet(p4, open = \"(d.\", tag_pool = tag_pool) + \n        theme(strip.background = element_blank(), strip.text.x = element_blank())\n    p &lt;- p1 + p2 + p3 + p4\n    p &lt;- p + plot_layout(nrow = 1, guides = \"collect\") & theme(legend.position = \"top\")\n}\n\n\n\nR\"\"\"\nplot(j_events_der)\nsave_plot(\"l_j_r_der\", width = 15, height = 10)\n\nplot(j_events, j0_k_ulim=10)\nsave_plot(\"l_j_r_fit\", width = 15, height = 10)\n\"\"\"\n\n┌ Warning: RCall.jl: Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n└ @ RCall /Users/zijin/.julia/packages/RCall/dDAVd/src/io.jl:172\n┌ Warning: RCall.jl: Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n└ @ RCall /Users/zijin/.julia/packages/RCall/dDAVd/src/io.jl:172\n┌ Warning: RCall.jl: Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n└ @ RCall /Users/zijin/.julia/packages/RCall/dDAVd/src/io.jl:172\n┌ Warning: RCall.jl: Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n│ Warning: Transformation introduced infinite values in continuous y-axis\n└ @ RCall /Users/zijin/.julia/packages/RCall/dDAVd/src/io.jl:172\n\n\nRObject{StrSxp}\n../figures/l_j_r_fit.pdf\n\n\nl_j_r_fit\nl_j_r_der\n\nfunction plot_l_r_one(df)\n    fig = Figure(size=(1000, 500))\n\n    plt = data(df) * mapping(col=:label, color=:r)\n    \n    grid1 = draw!( fig[1, 1:2], plt * mapping(:L_k_norm) * density(datalimits=((0, 50),)) )\n    grid2 = draw!( fig[2, 1:2], plt * mapping(:L_k) * density(datalimits=((0, 5000),)) )\n    legend!(fig[0, 1:end], grid1, titleposition=:left, orientation=:horizontal)\n\n    fig\nend\n\nplot_l_r_one(j_events)\n\n\n\n\n\n\nFigure 3\n\n\n\n\n\nfunction plot_l_r_one(df)\n    fig = Figure(size=(1000, 500))\n\n    plt = data(df) * mapping(col=:label, color=:r)\n    \n    grid1 = draw!( fig[1, 1:2], plt * mapping(:L_k_norm) * density(datalimits=((0, 50),)) )\n    grid2 = draw!( fig[2, 1:2], plt * mapping(:L_k) * density(datalimits=((0, 5000),)) )\n    legend!(fig[0, 1:end], grid1, titleposition=:left, orientation=:horizontal)\n\n    fig\nend\n\nplot_l_r_one(j_events_der)\n\n\n\n\n\n\nFigure 4\n\n\n\n\n\nplt = data(j_events) * mapping(:radial_distance, :Alfven_speed, color=:label) * (visual(Scatter) + smooth())\nplt |&gt; draw\n\n\n\n\n\nplt = data(j_events) * mapping(:radial_distance, jA_map, color=:label) * (visual(Scatter) + smooth())\nplt |&gt; draw\n\n\n\n\n\nusing Statistics\n\n\n# groupby r and describe the data for each group \n# j_events |&gt; @groupby(_.r) |&gt; @map({r=key(_), j0_k=describe(_.j0_k), L_k=describe(_.L_k)})\n@chain j_events begin\n    groupby(:r)\n    combine(:plasma_density =&gt;  mean, :ion_inertial_length =&gt; mean, :b_mag =&gt; mean) \nend\n\n5×4 DataFrame\n\n\n\nRow\nr\nplasma_density_mean\nion_inertial_length_mean\nb_mag_mean\n\n\n\nString\nFloat64\nFloat64\nFloat64\n\n\n\n\n1\n1.0\n3.10512\n152.217\n3.75957\n\n\n2\n2.0\n1.42267\n242.722\n2.10041\n\n\n3\n3.0\n0.674452\n317.706\n1.45649\n\n\n4\n4.0\n0.417696\n434.665\n1.3097\n\n\n5\n5.0\n0.343857\n569.222\n1.27077\n\n\n\n\n\n\n\nplt = data(j_events) * mapping(:radial_distance, :plasma_density, color=:label) * (visual(Scatter) + smooth())\nplt |&gt; draw\n\n\n\n\n\nplt = data(j_events) * mapping(:radial_distance, di_map, color=:label) * (visual(Scatter) + smooth())\nplt |&gt; draw",
    "crumbs": [
      "Home",
      "Notebooks",
      "06 Corr Julia"
    ]
  },
  {
    "objectID": "notebooks/04_calc.html",
    "href": "notebooks/04_calc.html",
    "title": "",
    "section": "",
    "text": "from plasmapy.formulary import gyrofrequency, plasma_frequency, Alfven_speed\nfrom plasmapy.formulary.lengths import inertial_length\nfrom astropy import units as u\n\nB = 1 * u.nT\nn = 0.3 * u.cm**-3\n\nprint(gyrofrequency(B, particle='p+'))\nprint(plasma_frequency(n, particle='p+'))\nprint(inertial_length(n, particle='p+'))\n\nAlfven_speed(B, n, ion='p+')\n\n0.09578833155943636 rad / s\n721.1037659776023 rad / s\n415741.0793626498 m\n\n\n\\(39812.305 \\; \\mathrm{\\frac{m}{s}}\\)",
    "crumbs": [
      "Home",
      "Notebooks",
      "04 Calc"
    ]
  },
  {
    "objectID": "notebooks/10_examples.html",
    "href": "notebooks/10_examples.html",
    "title": "Discontinuities examples",
    "section": "",
    "text": "Strong current density in 5AU\n\nj_config = JunoConfig(ts=0.125, method='derivative').load()\nj_config.events = j_config.events.filter(\n    pl.col(\"radial_distance\") &gt; 5,\n    pl.col(\"j0_k\") &gt; 4\n)\n\noffset  = timedelta(seconds=5)\nfigs = j_config.plot_candidates(num=15, add_plasma_params=True, offset=offset)\n\n2024-02-28 10:53:21.761 | INFO     | discontinuitypy.datasets:plot_candidates:241 - Candidates indices: [438 318 262 341   9 159 111  54 400 132 544 422 515 508  86]",
    "crumbs": [
      "Home",
      "Notebooks",
      "Discontinuities examples"
    ]
  }
]